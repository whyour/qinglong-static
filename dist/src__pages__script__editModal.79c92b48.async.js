"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5586],{48782:function(J,C,e){e.r(C);var K=e(46686),t=e.n(K),_=e(63313),S=e.n(_),L=e(79242),b=e(68348),U=e(37967),m=e(10644),r=e(7515),M=e(79974),i=e(90138),c=e(30555),T=e(3286),l=e(89734),u=e(38772),E=e(31981),n=e(11527),h=L.Z.Option,B={".py":"python",".js":"javascript",".sh":"shell",".ts":"typescript"},D={python:".py",javascript:".js",shell:".sh",typescript:".ts"},v=function(d){var y=d.treeData,p=d.currentNode,P=d.content,k=d.handleCancel,x=d.visible,I=d.socketMessage,A=(0,_.useState)(""),$=t()(A,2),W=$[0],f=$[1],F=(0,_.useState)("javascript"),j=t()(F,2),G=j[0],O=j[1],Z=(0,_.useState)(),N=t()(Z,2),g=N[0],q=N[1],ue=(0,_.useState)(""),w=t()(ue,2),ee=w[0],ne=w[1],de=(0,_.useState)(!1),_e=t()(de,2),me=_e[0],te=_e[1],ce=(0,_.useState)(!1),ae=t()(ce,2),Ee=ae[0],le=ae[1],ge=(0,_.useState)(""),oe=t()(ge,2),Q=oe[0],H=oe[1],he=(0,u.F)(),ve=he.theme,z=(0,_.useRef)(null),fe=(0,_.useState)(!1),re=t()(fe,2),se=re[0],X=re[1],Me=function(){k()},De=function(a,s){if(!(s.key===ee||!a)&&s.type!=="directory"){var V=B[a.slice(-3)]||"";q(s),O(V),pe(s),ne(s.key)}},pe=function(a){r.W.get("".concat(M.Z.apiPrefix,"scripts/").concat(a.title,"?path=").concat(a.parent||"")).then(function(s){var V=s.code,Y=s.data;V===200&&f(Y)})},Pe=function(){H("");var a=z.current.getValue().replace(/\r\n/g,`
`);r.W.put("".concat(M.Z.apiPrefix,"scripts/run"),{data:{filename:g.title,path:g.parent||"",content:a}}).then(function(s){var V=s.code,Y=s.data;V===200&&X(!0)})},ie=function(){if(!(!g||!g.title)){var a=z.current.getValue().replace(/\r\n/g,`
`);r.W.put("".concat(M.Z.apiPrefix,"scripts/stop"),{data:{filename:g.title,path:g.parent||"",content:a}}).then(function(s){var V=s.code,Y=s.data;V===200&&X(!1)})}};return(0,_.useEffect)(function(){if(!!I){var o=I.type,a=I.message,s=I.references;o==="manuallyRunScript"&&((0,E.x$)(a)&&setTimeout(function(){X(!1)},300),Q&&(a=`
`.concat(a)),H("".concat(Q).concat(a)))}},[I]),(0,_.useEffect)(function(){if(H(""),p){q(p),f(P),ne(p.key);var o=B[p.title.slice(-3)]||"";O(o)}},[P,p]),(0,n.jsxs)(b.Z,{className:"edit-modal",closable:!1,title:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(U.Z,{treeExpandAction:"click",style:{marginRight:8,width:150},value:ee,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:y,placeholder:"\u8BF7\u9009\u62E9\u811A\u672C\u6587\u4EF6",fieldNames:{value:"key",label:"title"},showSearch:!0,onSelect:De}),(0,n.jsxs)(L.Z,{value:G,style:{width:110,marginRight:8},onChange:function(a){O(a)},children:[(0,n.jsx)(h,{value:"javascript",children:"javascript"}),(0,n.jsx)(h,{value:"typescript",children:"typescript"}),(0,n.jsx)(h,{value:"shell",children:"shell"}),(0,n.jsx)(h,{value:"python",children:"python"})]}),(0,n.jsx)(m.Z,{type:"primary",style:{marginRight:8},onClick:se?ie:Pe,children:se?"\u505C\u6B62":"\u8FD0\u884C"}),(0,n.jsx)(m.Z,{type:"primary",style:{marginRight:8},onClick:function(){H("")},children:"\u6E05\u7A7A\u65E5\u5FD7"}),(0,n.jsx)(m.Z,{type:"primary",style:{marginRight:8},onClick:function(){le(!0)},children:"\u8BBE\u7F6E"}),(0,n.jsx)(m.Z,{type:"primary",style:{marginRight:8},onClick:function(){te(!0)},children:"\u4FDD\u5B58"}),(0,n.jsx)(m.Z,{type:"primary",style:{marginRight:8},onClick:function(){ie(),k()},children:"\u9000\u51FA"})]}),width:"100%",headerStyle:{padding:"11px 24px"},onClose:Me,open:x,children:[(0,n.jsxs)(i.Z,{split:"vertical",minSize:200,defaultSize:"50%",style:{height:"calc(100vh - 55px)"},children:[(0,n.jsx)(c.ZP,{language:G,value:W,theme:ve,options:{fontSize:12,minimap:{enabled:!1},lineNumbersMinChars:3,glyphMargin:!1},onMount:function(a){z.current=a}}),(0,n.jsx)("pre",{style:{height:"100%",padding:"0 15px",whiteSpace:"break-spaces"},children:Q})]}),(0,n.jsx)(T.default,{visible:me,handleCancel:function(){te(!1)},file:{content:z.current&&z.current.getValue().replace(/\r\n/g,`
`),filename:g==null?void 0:g.title}}),(0,n.jsx)(l.default,{visible:Ee,handleCancel:function(){le(!1)}})]})};C.default=v},3286:function(J,C,e){e.r(C);var K=e(35290),t=e.n(K),_=e(30279),S=e.n(_),L=e(411),b=e.n(L),U=e(46686),m=e.n(U),r=e(63313),M=e.n(r),i=e(93192),c=e(78877),T=e(50819),l=e(38224),u=e(7515),E=e(79974),n=e(11527),h=function(D){var v=D.file,R=D.handleCancel,d=D.visible,y=i.Z.useForm(),p=m()(y,1),P=p[0],k=(0,r.useState)(!1),x=m()(k,2),I=x[0],A=x[1],$=function(){var W=b()(t()().mark(function f(F){var j;return t()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:A(!0),j=S()(S()(S()({},v),F),{},{originFilename:v.filename}),u.W.post("".concat(E.Z.apiPrefix,"scripts"),{data:j}).then(function(Z){var N=Z.code,g=Z.data;N===200&&(c.ZP.success("\u4FDD\u5B58\u6587\u4EF6\u6210\u529F"),R(g)),A(!1)});case 3:case"end":return O.stop()}},f)}));return function(F){return W.apply(this,arguments)}}();return(0,r.useEffect)(function(){P.resetFields(),A(!1)},[v,d]),(0,n.jsx)(T.Z,{title:"\u4FDD\u5B58\u6587\u4EF6",open:d,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){P.validateFields().then(function(f){$(f)}).catch(function(f){console.log("Validate Failed:",f)})},onCancel:function(){return R()},confirmLoading:I,children:(0,n.jsxs)(i.Z,{form:P,layout:"vertical",name:"script_modal",initialValues:v,children:[(0,n.jsx)(i.Z.Item,{name:"filename",label:"\u6587\u4EF6\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D"}],children:(0,n.jsx)(l.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D"})}),(0,n.jsx)(i.Z.Item,{name:"path",label:"\u4FDD\u5B58\u76EE\u5F55",children:(0,n.jsx)(l.Z,{placeholder:"\u8BF7\u8F93\u5165\u4FDD\u5B58\u76EE\u5F55\uFF0C\u9ED8\u8BA4scripts\u76EE\u5F55"})})]})})};C.default=h},89734:function(J,C,e){e.r(C);var K=e(35290),t=e.n(K),_=e(30279),S=e.n(_),L=e(411),b=e.n(L),U=e(46686),m=e.n(U),r=e(63313),M=e.n(r),i=e(93192),c=e(78877),T=e(50819),l=e(38224),u=e(7515),E=e(79974),n=e(11527),h=function(D){var v=D.file,R=D.handleCancel,d=D.visible,y=i.Z.useForm(),p=m()(y,1),P=p[0],k=(0,r.useState)(!1),x=m()(k,2),I=x[0],A=x[1],$=function(){var W=b()(t()().mark(function f(F){var j;return t()().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:A(!0),j=S()(S()({},v),F),u.W.post("".concat(E.Z.apiPrefix,"scripts"),{data:j}).then(function(Z){var N=Z.code,g=Z.data;N===200&&(c.ZP.success("\u4FDD\u5B58\u6587\u4EF6\u6210\u529F"),R(g)),A(!1)});case 3:case"end":return O.stop()}},f)}));return function(F){return W.apply(this,arguments)}}();return(0,r.useEffect)(function(){P.resetFields(),A(!1)},[v,d]),(0,n.jsx)(T.Z,{title:"\u8FD0\u884C\u8BBE\u7F6E",open:d,forceRender:!0,centered:!0,onCancel:function(){return R()},children:(0,n.jsx)(i.Z,{form:P,layout:"vertical",name:"setting_modal",initialValues:v,children:(0,n.jsx)(i.Z.Item,{name:"filename",label:"\u5F85\u5F00\u53D1",rules:[{required:!0,message:"\u5F85\u5F00\u53D1"}],children:(0,n.jsx)(l.Z,{placeholder:"\u5F85\u5F00\u53D1"})})})})};C.default=h},38772:function(J,C,e){e.d(C,{F:function(){return U},e:function(){return b}});var K=e(46686),t=e.n(K),_=e(63313),S=e.n(_),L=e(31981),b=function(){var r=(0,_.useState)("100%"),M=t()(r,2),i=M[0],c=M[1],T=(0,_.useState)(0),l=t()(T,2),u=l[0],E=l[1],n=(0,_.useState)(-72),h=t()(n,2),B=h[0],D=h[1],v=(0,_.useState)(!1),R=t()(v,2),d=R[0],y=R[1],p=(0,_.useMemo)(function(){return(0,L.ZP)()},[]),P=p.platform;return(0,_.useEffect)(function(){P==="mobile"&&document.body.offsetWidth<768?(c("auto"),E(0),D(0),y(!0)):(c("100%"),E(0),D(-72),y(!1))},[]),{headerStyle:{padding:"4px 16px 4px 15px",position:"sticky",top:0,left:0,zIndex:20,marginTop:B,width:i,marginLeft:u},isPhone:d}},U=function(){var r=(0,_.useState)(),M=t()(r,2),i=M[0],c=M[1],T=function(){var u=window.matchMedia("(prefers-color-scheme: dark)"),E=localStorage.getItem("qinglong_dark_theme"),n=u.matches&&E!=="light"||E==="dark";c(n?"vs-dark":"vs")};return(0,_.useEffect)(function(){var l=window.matchMedia("(prefers-color-scheme: dark)"),u=localStorage.getItem("qinglong_dark_theme"),E=l.matches&&u!=="light"||u==="dark";c(E?"vs-dark":"vs");var n=function(B){(u==="auto"||!u)&&(B.matches?c("vs-dark"):c("vs"))};typeof l.addEventListener=="function"?l.addEventListener("change",n):typeof l.addListener=="function"&&l.addListener(n)},[]),{theme:i,reloadTheme:T}}}}]);

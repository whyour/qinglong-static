"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5149],{28011:function(ue,R,e){var F=e(82878),B=(0,F.Z)({scriptUrl:["//at.alicdn.com/t/c/font_3354854_z0d9rbri1ci.js"]});R.Z=B},84625:function(ue,R,e){e.r(R);var F=e(44463),B=e.n(F),X=e(35290),M=e.n(X),q=e(30279),s=e.n(q),ee=e(411),ne=e.n(ee),C=e(46686),z=e.n(C),I=e(63313),me=e.n(I),u=e(87400),D=e(16052),_e=e(92207),G=e(70685),ae=e(27672),T=e(39807),S=e(36032),te=e(16938),Y=e(28786),H=e(3567),oe=e(28011),n=e(11527),le=["key","name"],re=["key","name"],i=[{name:"\u547D\u4EE4",value:"command"},{name:"\u540D\u79F0",value:"name"},{name:"\u5B9A\u65F6\u89C4\u5219",value:"schedule"},{name:"\u72B6\u6001",value:"status"}],ie=[{name:"\u5305\u542B",value:"Reg"},{name:"\u4E0D\u5305\u542B",value:"NotReg"},{name:"\u5C5E\u4E8E",value:"In"},{name:"\u4E0D\u5C5E\u4E8E",value:"Nin"}],se=[{name:"\u987A\u5E8F",value:"ASC"},{name:"\u5012\u5E8F",value:"DESC"}],J=[{name:"\u8FD0\u884C\u4E2D",value:0},{name:"\u7A7A\u95F2\u4E2D",value:1},{name:"\u5DF2\u7981\u7528",value:2}],w;(function(V){V.and="\u4E14",V.or="\u6216"})(w||(w={}));var de=function(E){var m=E.view,A=E.handleCancel,x=E.visible,f=u.Z.useForm(),N=z()(f,1),P=N[0],y=(0,I.useState)(!1),g=z()(y,2),j=g[0],b=g[1],W=(0,I.useState)("and"),L=z()(W,2),p=L[0],k=L[1],U=function(){var r=ne()(M()().mark(function d(v){var o,t,_,l;return M()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b(!0),v.filterRelation=p,o=m?"put":"post",a.prev=3,a.next=6,S.W[o]("".concat(te.Z.apiPrefix,"crons/views"),{data:m?s()(s()({},v),{},{id:m.id}):v});case 6:t=a.sent,_=t.code,l=t.data,_===200&&A(l),b(!1),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(3),b(!1);case 16:case"end":return a.stop()}},d,null,[[3,13]])}));return function(v){return r.apply(this,arguments)}}();(0,I.useEffect)(function(){m||P.resetFields(),P.setFieldsValue(m||{filters:[{property:"command",operation:"Reg"}]})},[m,x]);var K=(0,n.jsx)(D.Z,{style:{width:80},children:ie.map(function(r){return(0,n.jsx)(D.Z.Option,{value:r.value,children:r.name},r.name)})}),h=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,n.jsx)(D.Z,{style:v,children:d.map(function(o){return(0,n.jsx)(D.Z.Option,{value:o.value,children:o.name},o.name)})})},$=(0,n.jsx)(D.Z,{children:se.map(function(r){return(0,n.jsx)(D.Z.Option,{value:r.value,children:r.name},r.name)})}),Z=(0,n.jsx)(D.Z,{mode:"multiple",allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",children:J.map(function(r){return(0,n.jsx)(D.Z.Option,{value:r.value,children:r.name},r.name)})});return(0,n.jsx)(_e.Z,{title:m?"\u7F16\u8F91\u89C6\u56FE":"\u65B0\u5EFA\u89C6\u56FE",open:x,forceRender:!0,width:580,centered:!0,maskClosable:!1,onOk:function(){P.validateFields().then(function(d){U(d)}).catch(function(d){console.log("Validate Failed:",d)})},onCancel:function(){return A()},confirmLoading:j,children:(0,n.jsxs)(u.Z,{form:P,layout:"vertical",name:"env_modal",children:[(0,n.jsx)(u.Z.Item,{name:"name",label:"\u89C6\u56FE\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"}],children:(0,n.jsx)(G.Z,{placeholder:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"})}),(0,n.jsx)(u.Z.List,{name:"filters",children:function(d,v){var o=v.add,t=v.remove;return(0,n.jsxs)("div",{style:{position:"relative"},className:"view-filters-container ".concat(d.length>1?"active":""),children:[d.length>1&&(0,n.jsx)("div",{style:{position:"absolute",width:50,borderRadius:10,border:"1px solid rgb(190, 220, 255)",borderRight:"none",height:56*(d.length-1),top:46,left:15},children:(0,n.jsx)(ae.Z,{type:"primary",size:"small",style:{position:"absolute",top:"50%",translate:"-50% -50%",padding:"0 0 0 3px",cursor:"pointer"},onClick:function(){k(p==="and"?"or":"and")},children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:w[p]}),(0,n.jsx)(oe.Z,{type:"ql-icon-d-caret"})]})})}),(0,n.jsxs)("div",{children:[d.map(function(_,l){var c=_.key,a=_.name,O=B()(_,le);return(0,n.jsx)(u.Z.Item,{label:l===0?"\u7B5B\u9009\u6761\u4EF6":"",style:{marginBottom:0},required:!0,className:"filter-item",children:(0,n.jsxs)(T.Z,{className:"view-create-modal-filters",align:"baseline",style:d.length>1?{width:"calc(100% - 40px)"}:{},children:[(0,n.jsx)(u.Z.Item,s()(s()({},O),{},{name:[a,"property"],rules:[{required:!0}],children:h(i,{width:90})})),(0,n.jsx)(u.Z.Item,s()(s()({},O),{},{name:[a,"operation"],rules:[{required:!0}],children:K})),(0,n.jsx)(u.Z.Item,s()(s()({},O),{},{name:[a,"value"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9"}],children:["In","Nin"].includes(P.getFieldValue(["filters",l,"operation"]))?Z:(0,n.jsx)(G.Z,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"})})),l!==0&&(0,n.jsx)(Y.Z,{onClick:function(){return t(a)}})]})},c)}),(0,n.jsx)(u.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return o({property:"command",operation:"Reg"})},children:[(0,n.jsx)(H.Z,{}),"\u65B0\u589E\u7B5B\u9009\u6761\u4EF6"]})})]})]})}}),(0,n.jsx)(u.Z.List,{name:"sorts",children:function(d,v){var o=v.add,t=v.remove;return(0,n.jsxs)(n.Fragment,{children:[d.map(function(_,l){var c=_.key,a=_.name,O=B()(_,re);return(0,n.jsx)(u.Z.Item,{label:l===0?"\u6392\u5E8F\u65B9\u5F0F":"",style:{marginBottom:0},children:(0,n.jsxs)(T.Z,{className:"view-create-modal-sorts",align:"baseline",children:[(0,n.jsx)(u.Z.Item,s()(s()({},O),{},{name:[a,"property"],rules:[{required:!0}],children:h(i,{width:240})})),(0,n.jsx)(u.Z.Item,s()(s()({},O),{},{name:[a,"type"],rules:[{required:!0}],children:$})),(0,n.jsx)(Y.Z,{onClick:function(){return t(a)}})]})},c)}),(0,n.jsx)(u.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return o({property:"command",type:"ASC"})},children:[(0,n.jsx)(H.Z,{}),"\u65B0\u589E\u6392\u5E8F\u65B9\u5F0F"]})})]})}})]})})};R.default=de},55149:function(ue,R,e){e.r(R);var F=e(94434),B=e.n(F),X=e(30279),M=e.n(X),q=e(46686),s=e.n(q),ee=e(44463),ne=e.n(ee),C=e(63313),z=e.n(C),I=e(87922),me=e(79712),u=e(39807),D=e(92207),_e=e(68757),G=e(27672),ae=e(97763),T=e(36032),S=e(16938),te=e(97947),Y=e(5962),H=e(88615),oe=e(338),n=e(76979),le=e(66255),re=e(84625),i=e(11527),ie=["index","moveRow","className","style"],se=I.Z.Text,J="DragableBodyRow",w=function(E){var m=E.index,A=E.moveRow,x=E.className,f=E.style,N=ne()(E,ie),P=(0,C.useRef)(),y=(0,H.L)({accept:J,collect:function(h){var $=h.getItem()||{},Z=$.index;return Z===m?{}:{isOver:h.isOver(),dropClassName:Z<m?" drop-over-downward":" drop-over-upward"}},drop:function(h){A(h.index,m)}}),g=s()(y,2),j=g[0],b=j.isOver,W=j.dropClassName,L=g[1],p=(0,oe.c)({type:J,item:{index:m},collect:function(h){return{isDragging:h.isDragging()}}}),k=s()(p,2),U=k[1];return L(U(P)),(0,i.jsx)("tr",M()({ref:P,className:"".concat(x).concat(b?W:""),style:M()({cursor:"move"},f)},N))},de=function(E){var m=E.cronViews,A=E.handleCancel,x=E.visible,f=E.cronViewChange,N=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",align:"center"},{title:"\u663E\u793A",key:"isDisabled",dataIndex:"isDisabled",align:"center",width:100,render:function(t,_,l){return(0,i.jsx)(me.Z,{checked:!_.isDisabled,onChange:function(a){return r(a,_,l)}})}},{title:"\u64CD\u4F5C",key:"action",width:140,align:"center",render:function(t,_,l){return(0,i.jsxs)(u.Z,{size:"middle",children:[(0,i.jsx)("a",{onClick:function(){return $(_,l)},children:(0,i.jsx)(te.Z,{})}),(0,i.jsx)("a",{onClick:function(){return Z(_,l)},children:(0,i.jsx)(Y.Z,{})})]})}}],P=(0,C.useState)([]),y=s()(P,2),g=y[0],j=y[1],b=(0,C.useState)(!1),W=s()(b,2),L=W[0],p=W[1],k=(0,C.useState)(null),U=s()(k,2),K=U[0],h=U[1],$=function(t,_){h(t),p(!0)},Z=function(t,_){D.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,i.jsxs)(i.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u89C6\u56FE"," ",(0,i.jsx)(se,{style:{wordBreak:"break-all"},type:"warning",children:t.name})," ","\u5417"]}),onOk:function(){T.W.delete("".concat(S.Z.apiPrefix,"crons/views"),{data:[t.id]}).then(function(c){var a=c.code,O=c.data;a===200&&(_e.ZP.success("\u5220\u9664\u6210\u529F"),f())})},onCancel:function(){console.log("Cancel")}})},r=function(t,_,l){console.log(t),T.W.put("".concat(S.Z.apiPrefix,"crons/views/").concat(t?"enable":"disable"),{data:[_.id]}).then(function(c){var a=c.code,O=c.data;if(a===200){var Q=B()(g);Q.splice(l,1,M()(M()({},g[l]),{},{isDisabled:!t})),j(Q),f()}})},d={body:{row:w}},v=(0,C.useCallback)(function(o,t){if(o!==t){var _=g[o];T.W.put("".concat(S.Z.apiPrefix,"crons/views/move"),{data:{fromIndex:o,toIndex:t,id:_.id}}).then(function(l){var c=l.code,a=l.data;if(c===200){var O=B()(g);O.splice(o,1),O.splice(t,0,M()(M()({},_),a)),j(O),f()}})}},[g]);return(0,C.useEffect)(function(){j(m)},[m]),(0,i.jsxs)(D.Z,{title:"\u89C6\u56FE\u7BA1\u7406",open:x,centered:!0,width:620,onCancel:function(){return A()},className:"view-manage-modal",forceRender:!0,footer:!1,maskClosable:!1,children:[(0,i.jsx)(u.Z,{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:(0,i.jsx)(G.Z,{type:"primary",onClick:function(){h(null),p(!0)},children:"\u65B0\u5EFA\u89C6\u56FE"},"2")}),(0,i.jsx)(n.W,{backend:le.PD,children:(0,i.jsx)(ae.Z,{bordered:!0,columns:N,pagination:!1,dataSource:g,rowKey:"id",size:"middle",style:{marginBottom:20},components:d,onRow:function(t,_){return{index:_,moveRow:v}}})}),(0,i.jsx)(re.default,{view:K,visible:L,handleCancel:function(t){p(!1),f(t)}})]})};R.default=de}}]);

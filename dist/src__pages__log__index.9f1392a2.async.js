(self.webpackChunk=self.webpackChunk||[]).push([[9818],{13740:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(14797),a=n(63313),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},o=n(46420),i=function(e,t){return a.createElement(o.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:t,icon:c}))};i.displayName="DeleteOutlined";var l=a.forwardRef(i)},51805:function(e,t,n){"use strict";var r=n(57213),a=n.n(r),c=n(63313);t.Z=function(e,t,n){var r=n.treeNodeFilterProp;return(0,c.useMemo)((function(){var n=[];if(!t)return{treeData:e,keys:n};var c=t.toUpperCase();function o(e,t){var n=t[r];return String(n).toUpperCase().includes(c)}return{treeData:function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.map((function(t){var c=t.children,i=r||o(0,t),l=e(c||[],i);return i||l.length?(l.length&&n.push(t.key),a()(a()({},t),{},{children:l})):null})).filter((function(e){return e}))}(e),keys:n}}),[e,t,r])}},69365:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var r=n(93525),a=n.n(r),c=n(54306),o=n.n(c),i=n(88265),l=n(63313),u=n(92260),s=n(84163),f=n(9835),h=n(75310),d=n(15367),p=n(24378),g=n(22159),v=n(43209),x=n(84540),Z=n(15207),y=n(23435),m=n(82755),P=n(57229),k={"left-tree-container":"left-tree-container___zHanw","left-tree-scroller":"left-tree-scroller___PInUN","log-container":"log-container___ba9Tr"},w=n(31988),S=n(36035),j=n(14851),C=n(13740),N=n(40141),E=n(66292),_=n.n(E),b=n(4363),I=n.n(b),z=n(51805),D=n(11527),H=u.Z.Text,M=function(){var e=(0,j.useOutletContext)(),t=e.headerStyle,n=e.isPhone,r=e.theme,c=(0,l.useState)(i.ZP.get("请选择日志文件")),u=o()(c,2),E=u[0],b=u[1],M=(0,l.useState)(""),F=o()(M,2),O=F[0],W=F[1],A=(0,l.useState)([]),L=o()(A,2),R=L[0],T=L[1],U=(0,l.useState)(!1),B=o()(U,2),K=B[0],q=B[1],G=(0,l.useState)(),J=o()(G,2),Q=J[0],V=J[1],X=(0,l.useRef)(),Y=(0,l.useState)([]),$=o()(Y,2),ee=$[0],te=$[1],ne=(0,l.useState)(),re=o()(ne,2),ae=re[0],ce=re[1],oe=(0,l.useState)(""),ie=o()(oe,2),le=ie[0],ue=ie[1],se=function(e,t){ce(t),W(e),t.key!==O&&e&&("directory"!==t.type?(b(i.ZP.get("加载中...")),function(e){P.W.get("".concat(Z.Z.apiPrefix,"logs/").concat(e.title,"?path=").concat(e.parent||"")).then((function(e){var t=e.code,n=e.data;200===t&&b(n)}))}(t)):b(i.ZP.get("请选择日志文件")))},fe=(0,l.useCallback)((function(e,t){se(e[0],t.node)}),[]),he=(0,l.useCallback)((function(e){var t=e.target.value;de(t)}),[R]),de=(0,l.useCallback)(_()((function(e){ue(e)}),300),[R]),pe=(0,z.Z)(R,le,{treeNodeFilterProp:"title"}),ge=pe.treeData,ve=pe.keys;(0,l.useEffect)((function(){te(I()([].concat(a()(ee),a()(ve))))}),[ve]);var xe=function(){W(""),ce(null),b(i.ZP.get("请选择脚本文件"))};return(0,l.useEffect)((function(){q(!0),P.W.get("".concat(Z.Z.apiPrefix,"logs")).then((function(e){var t=e.code,n=e.data;200===t&&T(n)})).finally((function(){return q(!1)}))}),[]),(0,l.useEffect)((function(){X.current&&V(X.current.clientHeight)}),[X.current,R]),(0,D.jsx)(y.ZP,{className:"ql-container-wrapper log-wrapper",title:O,loading:K,extra:n?[(0,D.jsx)(h.Z,{treeExpandAction:"click",className:"log-select",value:O,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:R,placeholder:i.ZP.get("请选择日志"),fieldNames:{value:"key"},treeNodeFilterProp:"title",showSearch:!0,allowClear:!0,onSelect:se})]:[(0,D.jsx)(d.Z,{title:i.ZP.get("删除"),children:(0,D.jsx)(p.Z,{type:"primary",disabled:!O,onClick:function(){s.Z.confirm({title:"确认删除",content:(0,D.jsxs)(D.Fragment,{children:[i.ZP.get("确认删除"),(0,D.jsx)(H,{style:{wordBreak:"break-all"},type:"warning",children:O}),i.ZP.get("文件"),"directory"===ae.type?i.ZP.get("夹下所以日志"):"",i.ZP.get("，删除后不可恢复")]}),onOk:function(){P.W.delete("".concat(Z.Z.apiPrefix,"logs"),{data:{filename:ae.title,path:ae.parent||"",type:ae.type}}).then((function(e){if(200===e.code){f.ZP.success("删除成功");var t=a()(R);if(ae.parent)t=(0,N.I1)(t,(function(e){return e.key===ae.key}));else{var n=t.findIndex((function(e){return e.key===ae.key}));-1!==n&&t.splice(n,1)}T(t),xe()}}))},onCancel:function(){console.log("Cancel")}})},icon:(0,D.jsx)(C.Z,{})})})],header:{style:t},children:(0,D.jsxs)("div",{className:"".concat(k["log-container"]," log-container"),children:[!n&&(0,D.jsxs)(S.Z,{split:"vertical",size:200,maxSize:-100,children:[(0,D.jsx)("div",{className:k["left-tree-container"],children:R.length>0?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(g.Z.Search,{className:k["left-tree-search"],onChange:he,placeholder:i.ZP.get("请输入日志名"),allowClear:!0}),(0,D.jsx)("div",{className:k["left-tree-scroller"],ref:X,children:(0,D.jsx)(v.Z,{expandAction:"click",className:k["left-tree"],treeData:ge,showIcon:!0,height:Q,selectedKeys:[O],showLine:{showLeafIcon:!0},onSelect:fe,expandedKeys:ee,onExpand:function(e){te(e)}})})]}):(0,D.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,D.jsx)(x.Z,{description:i.ZP.get("暂无日志"),image:x.Z.PRESENTED_IMAGE_SIMPLE})})}),(0,D.jsx)(m.ZP,{language:"shell",theme:r,value:E,options:{readOnly:!0,fontSize:12,lineNumbersMinChars:3,fontFamily:"Source Code Pro",folding:!1,glyphMargin:!1,wordWrap:"on"}})]}),n&&(0,D.jsx)(w.ZP,{value:E,readOnly:!0,theme:r.includes("dark")?"dark":"light",onChange:function(e,t){b(e)}})]})})}},45170:function(e,t,n){var r=n(13807);e.exports=function(e,t){return!!(null==e?0:e.length)&&r(e,t,0)>-1}},94936:function(e){e.exports=function(e,t,n){for(var r=-1,a=null==e?0:e.length;++r<a;)if(n(t,e[r]))return!0;return!1}},92504:function(e){e.exports=function(e,t,n,r){for(var a=e.length,c=n+(r?1:-1);r?c--:++c<a;)if(t(e[c],c,e))return c;return-1}},13807:function(e,t,n){var r=n(92504),a=n(99940),c=n(3729);e.exports=function(e,t,n){return t==t?c(e,t,n):r(e,a,n)}},99940:function(e){e.exports=function(e){return e!=e}},95453:function(e,t,n){var r=n(78188),a=n(45170),c=n(94936),o=n(29880),i=n(17319),l=n(79967);e.exports=function(e,t,n){var u=-1,s=a,f=e.length,h=!0,d=[],p=d;if(n)h=!1,s=c;else if(f>=200){var g=t?null:i(e);if(g)return l(g);h=!1,s=o,p=new r}else p=t?[]:d;e:for(;++u<f;){var v=e[u],x=t?t(v):v;if(v=n||0!==v?v:0,h&&x==x){for(var Z=p.length;Z--;)if(p[Z]===x)continue e;t&&p.push(x),d.push(v)}else s(p,x,n)||(p!==d&&p.push(x),d.push(v))}return d}},17319:function(e,t,n){var r=n(81956),a=n(43226),c=n(79967),o=r&&1/c(new r([,-0]))[1]==1/0?function(e){return new r(e)}:a;e.exports=o},3729:function(e){e.exports=function(e,t,n){for(var r=n-1,a=e.length;++r<a;)if(e[r]===t)return r;return-1}},43226:function(e){e.exports=function(){}},4363:function(e,t,n){var r=n(95453);e.exports=function(e){return e&&e.length?r(e):[]}}}]);
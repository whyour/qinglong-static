"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2340],{47240:function(e,t,n){n.r(t);var a=n(25359),o=n.n(a),r=n(57213),c=n.n(r),i=n(49811),l=n.n(i),s=n(54306),u=n.n(s),d=n(88265),f=n(63313),p=n(67393),h=n(9835),g=n(84163),Z=n(22159),m=n(28756),x=n(95176),y=n(5558),v=n(11527);t.default=function(e){var t=e.app,n=e.handleCancel,a=e.visible,r=p.Z.useForm(),i=u()(r,1)[0],s=(0,f.useState)(!1),P=u()(s,2),j=P[0],b=P[1],k=function(){var e=l()(o()().mark((function e(a){var r,i,l,s,u;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),r=t?"put":"post",i=c()({},a),t&&(i.id=t.id),e.prev=4,e.next=7,x.W[r]("".concat(y.Z.apiPrefix,"apps"),i);case 7:l=e.sent,s=l.code,u=l.data,200===s&&(h.ZP.success(t?d.ZP.get("更新应用成功"):d.ZP.get("创建应用成功")),n(u)),b(!1),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),b(!1);case 17:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}();return(0,f.useEffect)((function(){i.resetFields()}),[t,a]),(0,v.jsx)(g.Z,{title:t?d.ZP.get("编辑应用"):d.ZP.get("创建应用"),open:a,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){i.validateFields().then((function(e){k(e)})).catch((function(e){console.log("Validate Failed:",e)}))},onCancel:function(){return n()},confirmLoading:j,children:(0,v.jsxs)(p.Z,{form:i,layout:"vertical",name:"form_app_modal",initialValues:t,children:[(0,v.jsx)(p.Z.Item,{name:"name",label:d.ZP.get("名称"),rules:[{validator:function(e,t){return["system"].includes(t)?Promise.reject(new Error(d.ZP.get("名称不能为保留关键字"))):Promise.resolve()}}],children:(0,v.jsx)(Z.Z,{placeholder:d.ZP.get("请输入应用名称")})}),(0,v.jsx)(p.Z.Item,{name:"scopes",label:d.ZP.get("权限"),rules:[{required:!0}],children:(0,v.jsx)(m.Z,{mode:"multiple",placeholder:d.ZP.get("请选择模块权限"),allowClear:!0,style:{width:"100%"},children:y.Z.scopes.map((function(e){return(0,v.jsx)(m.Z.Option,{value:e.value,children:e.name},e.value)}))})})]})})}},77207:function(e,t,n){n.r(t),n.d(t,{default:function(){return V}});var a=n(25359),o=n.n(a),r=n(49811),c=n.n(r),i=n(57213),l=n.n(i),s=n(93525),u=n.n(s),d=n(54306),f=n.n(d),p=n(88265),h=n(63313),g=n(92260),Z=n(51704),m=n(2947),x=n(15367),y=n(84163),v=n(9835),P=n(24378),j=n(86986),b=n(94674),k=n(5558),C=n(78969),w=n(95176),S=n(47240),I=n(32132),O=n(14797),E={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},F=n(46420),T=function(e,t){return h.createElement(F.Z,(0,O.Z)((0,O.Z)({},e),{},{ref:t,icon:E}))};T.displayName="ReloadOutlined";var _=h.forwardRef(T),W=n(13740),q=n(17322),B=n(23980),z=n(15257),M=n(14761),R=n(9532),A=n(98074),N=(n(56508),n(87878)),L=n(11527),D=g.Z.Text,K="demo"===window.__ENV__DeployEnv,V=function(){var e,t,n,a=(0,A.useOutletContext)(),r=a.headerStyle,i=a.isPhone,s=a.user,d=a.theme,g=a.reloadUser,O=a.reloadTheme,E=a.socketMessage,F=a.systemInfo,T=[{title:p.ZP.get("名称"),dataIndex:"name",key:"name"},{title:"Client ID",dataIndex:"client_id",key:"client_id",render:function(e,t){return(0,L.jsx)(D,{copyable:!0,children:t.client_id})}},{title:"Client Secret",dataIndex:"client_secret",key:"client_secret",render:function(e,t){return(0,L.jsx)(D,{copyable:{text:t.client_secret},children:"*******"})}},{title:p.ZP.get("权限"),dataIndex:"scopes",key:"scopes",width:"40%",render:function(e,t){return t.scopes.map((function(e){return(0,L.jsx)(Z.Z,{children:k.Z.scopesMap[e]},e)}))}},{title:p.ZP.get("操作"),key:"action",render:function(e,t,n){var a=!i;return(0,L.jsxs)(m.Z,{size:"middle",style:{paddingLeft:8},children:[(0,L.jsx)(x.Z,{title:a?p.ZP.get("编辑"):"",children:(0,L.jsx)("a",{onClick:function(){return Ce(t,n)},children:(0,L.jsx)(I.Z,{})})}),(0,L.jsx)(x.Z,{title:a?p.ZP.get("重置secret"):"",children:(0,L.jsx)("a",{onClick:function(){return Se(t,n)},children:(0,L.jsx)(_,{})})}),(0,L.jsx)(x.Z,{title:a?p.ZP.get("删除"):"",children:(0,L.jsx)("a",{onClick:function(){return we(t,n)},children:(0,L.jsx)(W.Z,{})})})]})}}],V=(0,h.useState)(!0),G=f()(V,2),$=G[0],U=G[1],H=(0,h.useState)([]),Y=f()(H,2),J=Y[0],Q=Y[1],X=(0,h.useState)(!1),ee=f()(X,2),te=ee[0],ne=ee[1],ae=(0,h.useState)(),oe=f()(ae,2),re=oe[0],ce=oe[1],ie=(0,h.useState)("security"),le=f()(ie,2),se=le[0],ue=le[1],de=(0,h.useState)([]),fe=f()(de,2),pe=fe[0],he=fe[1],ge=(0,h.useState)(""),Ze=f()(ge,2),me=Ze[0],xe=Ze[1],ye=(0,h.useState)(),ve=f()(ye,2),Pe=ve[0],je=ve[1],be=(0,h.useRef)(),ke=function(){U(!0),w.W.get("".concat(k.Z.apiPrefix,"apps")).then((function(e){var t=e.code,n=e.data;200===t&&Q(n)})).finally((function(){return U(!1)}))},Ce=function(e,t){ce(e),ne(!0)},we=function(e,t){y.Z.confirm({title:p.ZP.get("确认删除"),content:(0,L.jsxs)(L.Fragment,{children:[p.ZP.get("确认删除应用")," ",(0,L.jsx)(D,{style:{wordBreak:"break-all"},type:"warning",children:e.name})," ",p.ZP.get("吗")]}),onOk:function(){w.W.delete("".concat(k.Z.apiPrefix,"apps"),{data:[e.id]}).then((function(e){var n=e.code;e.data;if(200===n){v.ZP.success(p.ZP.get("删除成功"));var a=u()(J);a.splice(t,1),Q(a)}}))},onCancel:function(){console.log("Cancel")}})},Se=function(e,t){y.Z.confirm({title:p.ZP.get("确认重置"),content:(0,L.jsxs)(L.Fragment,{children:[p.ZP.get("确认重置应用")," ",(0,L.jsx)(D,{style:{wordBreak:"break-all"},type:"warning",children:e.name})," ",p.ZP.get("的Secret吗"),(0,L.jsx)("br",{}),(0,L.jsx)(D,{type:"secondary",children:p.ZP.get("重置Secret会让当前应用所有token失效")})]}),onOk:function(){w.W.put("".concat(k.Z.apiPrefix,"apps/").concat(e.id,"/reset-secret")).then((function(e){var t=e.code,n=e.data;200===t&&(v.ZP.success(p.ZP.get("重置成功")),Ie(n))}))},onCancel:function(){console.log("Cancel")}})},Ie=function(e){var t=J.findIndex((function(t){return t.id===e.id})),n=u()(J);-1===t?n.push(e):n.splice(t,1,l()({},e)),Q(n)},Oe=function(){w.W.get("".concat(k.Z.apiPrefix,"user/notification")).then((function(e){var t=e.code,n=e.data;200===t&&je(n)})).catch((function(e){console.log(e)}))};return(0,h.useEffect)((function(){K&&ke()}),[]),(0,L.jsxs)(C.ZP,{className:"ql-container-wrapper ql-container-wrapper-has-tab ql-setting-container",title:p.ZP.get("系统设置"),header:{style:r},extra:"app"===se?[(0,L.jsx)(P.Z,{type:"primary",onClick:function(){return ce(null),void ne(!0)},children:p.ZP.get("创建应用")},"2")]:[],children:[(0,L.jsx)(j.Z,{defaultActiveKey:"security",size:"small",tabPosition:"top",onChange:function(e){ue(e),"app"===e?ke():"login"===e?w.W.get("".concat(k.Z.apiPrefix,"user/login-log")).then((function(e){var t=e.code,n=e.data;200===t&&he(n)})).catch((function(e){console.log(e)})):"notification"===e?Oe():"syslog"===e&&w.W.get("".concat(k.Z.apiPrefix,"system/log"),{responseType:"blob"}).then(function(){var e=c()(o()().mark((function e(t){return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=xe,e.next=3,t.text();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},items:[].concat(u()(K?[]:[{key:"security",label:p.ZP.get("安全设置"),children:(0,L.jsx)(q.default,{user:s,userChange:g})}]),[{key:"app",label:p.ZP.get("应用设置"),children:(0,L.jsx)(b.Z,{columns:T,pagination:!1,dataSource:J,rowKey:"id",size:"middle",scroll:{x:768},loading:$})},{key:"notification",label:p.ZP.get("通知设置"),children:(0,L.jsx)(z.default,{data:Pe})},{key:"login",label:p.ZP.get("登录日志"),children:(0,L.jsx)(B.default,{data:pe})},{key:"other",label:p.ZP.get("其他设置"),children:(0,L.jsx)(M.default,{reloadTheme:O,socketMessage:E,systemInfo:F})},{key:"syslog",label:p.ZP.get("系统日志"),children:(0,L.jsx)(N.ZP,{ref:be,maxHeight:"calc(100vh - ".concat((null===(e=be.current)||void 0===e||null===(t=e.editor)||void 0===t||null===(n=t.getBoundingClientRect())||void 0===n?void 0:n.top)+16,"px)"),value:me,onCreateEditor:function(e){setTimeout((function(){e.scrollDOM.scrollTo({top:e.scrollDOM.scrollHeight,behavior:"smooth"})}),300)},readOnly:!0,theme:d.includes("dark")?"dark":"light"})},{key:"about",label:p.ZP.get("关于"),children:(0,L.jsx)(R.default,{systemInfo:F})}])}),(0,L.jsx)(S.default,{visible:te,handleCancel:function(e){ne(!1),e&&Ie(e)},app:re})]})}},23980:function(e,t,n){n.r(t);var a=n(88265),o=(n(63313),n(92260)),r=n(51704),c=n(94674),i=n(11527),l=(o.Z.Text,o.Z.Link,function(e){return e[e["成功"]=0]="成功",e[e["失败"]=1]="失败",e}(l||{})),s=function(e){return e[e.success=0]="success",e[e.error=1]="error",e}(s||{}),u=[{title:a.ZP.get("序号"),width:50,render:function(e,t,n){return n+1}},{title:a.ZP.get("登录时间"),dataIndex:"timestamp",key:"timestamp",width:120,render:function(e,t){return new Date(t.timestamp).toLocaleString()}},{title:a.ZP.get("登录地址"),dataIndex:"address",width:120,key:"address"},{title:a.ZP.get("登录IP"),dataIndex:"ip",width:100,key:"ip"},{title:a.ZP.get("登录设备"),dataIndex:"platform",key:"platform",width:80},{title:a.ZP.get("登录状态"),dataIndex:"status",key:"status",width:80,render:function(e,t){return(0,i.jsx)(r.Z,{color:s[t.status],style:{marginRight:0},children:a.ZP.get(l[t.status])})}}];t.default=function(e){var t=e.data;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(c.Z,{columns:u,pagination:!1,dataSource:t,rowKey:"id",size:"middle",scroll:{x:1e3},sticky:!0})})}},15257:function(e,t,n){n.r(t);var a=n(57213),o=n.n(a),r=n(54306),c=n.n(r),i=n(88265),l=n(63313),s=n(28756),u=n(67393),d=n(9835),f=n(22159),p=n(24378),h=n(95176),g=n(5558),Z=n(11527),m=s.Z.Option;t.default=function(e){var t=e.data,n=(0,l.useState)(!1),a=c()(n,2),r=a[0],x=a[1],y=(0,l.useState)("closed"),v=c()(y,2),P=v[0],j=v[1],b=(0,l.useState)([]),k=c()(b,2),C=k[0],w=k[1],S=u.Z.useForm(),I=c()(S,1)[0],O=function(e){j(e);var t=g.Z.notificationModeMap[e];w(t||[])};return(0,l.useEffect)((function(){t&&t.type&&(O(t.type),I.setFieldsValue(o()({},t)))}),[t]),(0,Z.jsx)("div",{children:(0,Z.jsxs)(u.Z,{onFinish:function(e){x(!0),"closed"==e.type&&(e.type=""),h.W.put("".concat(g.Z.apiPrefix,"user/notification"),e).then((function(t){var n=t.code;t.data;200===n&&d.ZP.success(e.type?i.ZP.get("通知发送成功"):i.ZP.get("通知关闭成功"))})).catch((function(e){console.log(e)})).finally((function(){return x(!1)}))},form:I,layout:"vertical",children:[(0,Z.jsx)(u.Z.Item,{label:i.ZP.get("通知方式"),name:"type",rules:[{required:!0}],style:{maxWidth:400},initialValue:P,children:(0,Z.jsx)(s.Z,{onChange:O,disabled:r,children:g.Z.notificationModes.map((function(e){return(0,Z.jsx)(m,{value:e.value,children:e.label},e.value)}))})}),C.map((function(e){return(0,Z.jsx)(u.Z.Item,{label:e.label,name:e.label,extra:e.tip,rules:[{required:e.required}],style:{maxWidth:400},children:e.items?(0,Z.jsx)(s.Z,{placeholder:e.placeholder||"请选择".concat(e.label),disabled:r,children:e.items.map((function(e){return(0,Z.jsx)(m,{value:e.value,children:e.label||e.value},e.value)}))}):(0,Z.jsx)(f.Z.TextArea,{disabled:r,autoSize:!0,placeholder:e.placeholder||"请输入".concat(e.label)})},e.label)})),(0,Z.jsx)(p.Z,{type:"primary",htmlType:"submit",disabled:r,children:r?i.ZP.get("测试中..."):i.ZP.get("保存")})]})})}},14761:function(e,t,n){n.r(t);var a=n(57213),o=n.n(a),r=n(54306),c=n.n(r),i=n(88265),l=n(63313),s=n(67393),u=n(9835),d=n(84163),f=n(84468),p=n(22159),h=n(55484),g=n(24378),Z=n(57679),m=n(71571),x=n(5558),y=n(95176),v=n(60819),P=n(11227),j=(n(56508),n(59953)),b=n(41422),k=n(54700),C=n(11527),w=[{label:i.ZP.get("亮色"),value:"light"},{label:i.ZP.get("暗色"),value:"dark"},{label:i.ZP.get("跟随系统"),value:"auto"}];t.default=function(e){var t=e.systemInfo,n=e.socketMessage,a=e.reloadTheme,r=localStorage.getItem("qinglong_dark_theme")||"auto",S=(0,l.useState)(),I=c()(S,2),O=I[0],E=I[1],F=s.Z.useForm(),T=c()(F,1)[0],_=((0,l.useRef)(),(0,l.useState)(!1)),W=c()(_,2),q=W[0],B=W[1],z=(0,k.default)(i.ZP.get("上传")),M=(0,k.default)(i.ZP.get("下载")),R=m||{},A=R.enable,N=R.disable,L=(R.exportGeneratedCSS,R.setFetchMethod),D=R.auto,K=function(){y.W.put("".concat(x.Z.apiPrefix,"system/config"),O).then((function(e){var t=e.code;e.data;200===t&&u.ZP.success(i.ZP.get("更新成功"))})).catch((function(e){console.log(e)}))};return(0,l.useEffect)((function(){y.W.get("".concat(x.Z.apiPrefix,"system/config")).then((function(e){var t=e.code,n=e.data;200===t&&n.info&&E(n.info)})).catch((function(e){console.log(e)}))}),[]),(0,C.jsxs)(s.Z,{layout:"vertical",form:T,children:[(0,C.jsx)(s.Z.Item,{label:i.ZP.get("主题"),name:"theme",initialValue:r,children:(0,C.jsx)(f.ZP.Group,{options:w,onChange:function(e){var t=e.target.value;localStorage.setItem("qinglong_dark_theme",e.target.value),L(fetch),"dark"===t?A({}):"light"===t?N():D({}),a()},value:r,optionType:"button",buttonStyle:"solid"})}),(0,C.jsx)(s.Z.Item,{label:i.ZP.get("日志删除频率"),name:"frequency",tooltip:i.ZP.get("每x天自动删除x天以前的日志"),children:(0,C.jsxs)(p.Z.Group,{compact:!0,children:[(0,C.jsx)(h.Z,{addonBefore:i.ZP.get("每"),addonAfter:i.ZP.get("天"),style:{width:180},min:0,value:null==O?void 0:O.logRemoveFrequency,onChange:function(e){E(o()(o()({},O),{},{logRemoveFrequency:e}))}}),(0,C.jsx)(g.Z,{type:"primary",onClick:K,children:i.ZP.get("确认")})]})}),(0,C.jsx)(s.Z.Item,{label:i.ZP.get("定时任务并发数"),name:"frequency",children:(0,C.jsxs)(p.Z.Group,{compact:!0,children:[(0,C.jsx)(h.Z,{style:{width:150},min:1,value:null==O?void 0:O.cronConcurrency,onChange:function(e){E(o()(o()({},O),{},{cronConcurrency:e}))}}),(0,C.jsx)(g.Z,{type:"primary",onClick:K,children:i.ZP.get("确认")})]})}),(0,C.jsxs)(s.Z.Item,{label:i.ZP.get("数据备份还原"),name:"frequency",children:[(0,C.jsx)(g.Z,{type:"primary",onClick:function(){B(!0),y.W.put("".concat(x.Z.apiPrefix,"system/data/export"),{},{responseType:"blob",timeout:864e5,onDownloadProgress:function(e){e.progress&&M(parseFloat((100*e.progress).toFixed(1)))}}).then((function(e){(0,P.saveAs)(e,"data.tgz")})).catch((function(e){console.log(e)})).finally((function(){return B(!1)}))},loading:q,children:q?i.ZP.get("生成数据中..."):i.ZP.get("备份")}),(0,C.jsx)(Z.Z,{method:"put",showUploadList:!1,maxCount:1,action:"/api/system/data/import",onChange:function(e){var t,n,a;null!==(t=e.event)&&void 0!==t&&t.percent&&(z(parseFloat(null===(n=e.event)||void 0===n?void 0:n.percent.toFixed(1))),100===(null===(a=e.event)||void 0===a?void 0:a.percent)&&d.Z.confirm({width:600,maskClosable:!1,title:i.ZP.get("确认重启"),centered:!0,content:i.ZP.get("备份数据上传成功，确认覆盖数据"),okText:i.ZP.get("重启"),onOk:function(){y.W.put("".concat(x.Z.apiPrefix,"system/reload"),{type:"data"}).then((function(){u.ZP.success({content:(0,C.jsxs)("span",{children:[i.ZP.get("系统将在"),(0,C.jsx)(b.Z,{className:"inline-countdown",format:"ss",value:Date.now()+3e4}),i.ZP.get("秒后自动刷新")]}),duration:30}),setTimeout((function(){window.location.reload()}),3e4)})).catch((function(e){console.log(e)}))}}))},name:"data",headers:{Authorization:"Bearer ".concat(localStorage.getItem(x.Z.authKey))},children:(0,C.jsx)(g.Z,{icon:(0,C.jsx)(j.Z,{}),style:{marginLeft:8},children:i.ZP.get("还原数据")})})]}),(0,C.jsx)(s.Z.Item,{label:i.ZP.get("检查更新"),name:"update",children:(0,C.jsx)(v.default,{systemInfo:t,socketMessage:n})})]})}},54700:function(e,t,n){n.r(t),n.d(t,{default:function(){return i}});var a=n(13800),o=n(84163),r=n(63313),c=n(11527);function i(e){var t=(0,r.useRef)(),n=function(e){var t=e.percent;return(0,c.jsx)(a.Z,{style:{display:"flex",justifyContent:"center"},type:"circle",percent:t})};return function(a){t.current?t.current.update({title:"".concat(e).concat(a>=100?"成功":"中..."),content:(0,c.jsx)(n,{percent:a})}):t.current=o.Z.info({width:600,maskClosable:!1,title:"".concat(e).concat(a>=100?"成功":"中..."),centered:!0,content:(0,c.jsx)(n,{percent:a})})}}},17322:function(e,t,n){n.r(t);var a=n(54306),o=n.n(a),r=n(88265),c=n(63313),i=n(92260),l=n(9835),s=n(22159),u=n(24378),d=n(67393),f=n(83535),p=n(57679),h=n(95176),g=n(5558),Z=n(98074),m=n(48039),x=n.n(m),y=n(91796),v=n(3513),P=n(59953),j=n(24244),b=(n(3057),n(11527)),k=i.Z.Title,C=i.Z.Link;t.default=function(e){var t=e.user,n=e.userChange,a=(0,c.useState)(!1),i=o()(a,2),m=i[0],w=i[1],S=(0,c.useState)(),I=o()(S,2),O=I[0],E=I[1],F=(0,c.useState)(!1),T=o()(F,2),_=T[0],W=T[1],q=(0,c.useState)(),B=o()(q,2),z=B[0],M=B[1],R=(0,c.useState)(),A=o()(R,2),N=A[0],L=A[1],D=(0,c.useState)(),K=o()(D,2),V=K[0],G=K[1],$=function(){h.W.put("".concat(g.Z.apiPrefix,"user/two-factor/deactive")).then((function(e){var t=e.code,a=e.data;200===t&&a&&(E(!1),n())})).catch((function(e){console.log(e)}))},U=function(){h.W.get("".concat(g.Z.apiPrefix,"user/two-factor/init")).then((function(e){var t=e.code,n=e.data;200===t&&M(n)})).catch((function(e){console.log(e)}))};return(0,c.useEffect)((function(){E(t&&t.twoFactorActivated),G(t.avatar&&"/api/static/".concat(t.avatar))}),[t]),_?(0,b.jsx)(b.Fragment,{children:z?(0,b.jsxs)("div",{children:[(0,b.jsx)(k,{level:5,children:r.ZP.get("第一步")}),r.ZP.get("下载两步验证手机应用，比如 Google Authenticator 、"),(0,b.jsx)(C,{href:"https://www.microsoft.com/en-us/security/mobile-authenticator-app",target:"_blank",children:"Microsoft Authenticator"}),"、",(0,b.jsx)(C,{href:"https://authy.com/download/",target:"_blank",children:"Authy"}),"、",(0,b.jsx)(C,{href:"https://support.1password.com/one-time-passwords/",target:"_blank",children:"1Password"}),"、",(0,b.jsx)(C,{href:"https://support.logmeininc.com/lastpass/help/lastpass-authenticator-lp030014",target:"_blank",children:"LastPass Authenticator"}),(0,b.jsx)(k,{style:{marginTop:5},level:5,children:r.ZP.get("第二步")}),r.ZP.get("使用手机应用扫描二维码，或者输入秘钥")," ",null==z?void 0:z.secret,(0,b.jsx)("div",{style:{marginTop:10},children:(0,b.jsx)(x(),{style:{border:"1px solid #21262d",borderRadius:6},includeMargin:!0,size:187,value:null==z?void 0:z.url})}),(0,b.jsx)(k,{style:{marginTop:5},level:5,children:r.ZP.get("第三步")}),r.ZP.get("输入手机应用上的6位数字"),(0,b.jsx)(s.Z,{style:{margin:"10px 0 10px 0",display:"block",maxWidth:200},value:N,onChange:function(e){return L(e.target.value)},placeholder:"123456"}),(0,b.jsx)(u.Z,{type:"primary",loading:m,onClick:function(){w(!0),h.W.put("".concat(g.Z.apiPrefix,"user/two-factor/active"),{code:N}).then((function(e){var t=e.code,a=e.data;200===t&&(a?(l.ZP.success(r.ZP.get("激活成功")),W(!1),E(!0),n()):l.ZP.success(r.ZP.get("验证失败")))})).catch((function(e){console.log(e)})).finally((function(){return w(!1)}))},children:r.ZP.get("完成设置")})]}):(0,b.jsx)(y.Z,{})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{style:{fontSize:18,borderBottom:"1px solid #f0f0f0",marginBottom:8,paddingBottom:4},children:r.ZP.get("修改用户名密码")}),(0,b.jsxs)(d.Z,{onFinish:function(e){h.W.put("".concat(g.Z.apiPrefix,"user"),{username:e.username,password:e.password}).then((function(e){var t=e.code;e.data;200===t&&(localStorage.removeItem(g.Z.authKey),Z.history.push("/login"))})).catch((function(e){console.log(e)}))},layout:"vertical",children:[(0,b.jsx)(d.Z.Item,{label:r.ZP.get("用户名"),name:"username",rules:[{required:!0}],hasFeedback:!0,style:{maxWidth:300},children:(0,b.jsx)(s.Z,{placeholder:r.ZP.get("用户名")})}),(0,b.jsx)(d.Z.Item,{label:r.ZP.get("密码"),name:"password",rules:[{required:!0},{pattern:/^(?!admin$).*$/,message:r.ZP.get("密码不能为admin")}],hasFeedback:!0,style:{maxWidth:300},children:(0,b.jsx)(s.Z,{type:"password",placeholder:r.ZP.get("密码")})}),(0,b.jsx)(u.Z,{type:"primary",htmlType:"submit",children:r.ZP.get("保存")})]}),(0,b.jsx)("div",{style:{fontSize:18,borderBottom:"1px solid #f0f0f0",marginBottom:8,paddingBottom:4,marginTop:16},children:r.ZP.get("两步验证")}),(0,b.jsx)(u.Z,{type:"primary",danger:O,onClick:function(){O?$():(U(),W(!0))},children:O?r.ZP.get("禁用"):r.ZP.get("启用")}),(0,b.jsx)("div",{style:{fontSize:18,borderBottom:"1px solid #f0f0f0",marginBottom:8,paddingBottom:4,marginTop:16},children:r.ZP.get("头像")}),(0,b.jsx)(f.C,{size:128,shape:"square",icon:(0,b.jsx)(v.Z,{}),src:V}),(0,b.jsx)(j.Z,{rotationSlider:!0,children:(0,b.jsx)(p.Z,{method:"put",showUploadList:!1,maxCount:1,action:"/api/user/avatar",onChange:function(e){e.file&&e.file.response&&(G("/api/static/".concat(e.file.response.data)),n())},name:"avatar",headers:{Authorization:"Bearer ".concat(localStorage.getItem(g.Z.authKey))},children:(0,b.jsx)(u.Z,{icon:(0,b.jsx)(P.Z,{}),style:{marginLeft:8},children:r.ZP.get("更换头像")})})})]})}},56508:function(){},51704:function(e,t,n){n.d(t,{Z:function(){return P}});var a=n(87807),o=n(60795),r=n(17079),c=n(5132),i=n(84875),l=n.n(i),s=n(92976),u=n(63313),d=n(82259),f=n(31124),p=n(1570),h=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},g=function(e){var t,n=e.prefixCls,r=e.className,c=e.checked,i=e.onChange,s=e.onClick,f=h(e,["prefixCls","className","checked","onChange","onClick"]),p=(0,u.useContext(d.E_).getPrefixCls)("tag",n),g=l()(p,(t={},(0,a.Z)(t,"".concat(p,"-checkable"),!0),(0,a.Z)(t,"".concat(p,"-checkable-checked"),c),t),r);return u.createElement("span",(0,o.Z)({},f,{className:g,onClick:function(e){null==i||i(!c),null==s||s(e)}}))},Z=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(e);o<a.length;o++)t.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(e,a[o])&&(n[a[o]]=e[a[o]])}return n},m=new RegExp("^(".concat(f.Y.join("|"),")(-inverse)?$")),x=new RegExp("^(".concat(f.E.join("|"),")$")),y=function(e,t){var n,i=e.prefixCls,f=e.className,h=e.style,g=e.children,y=e.icon,v=e.color,P=e.onClose,j=e.closeIcon,b=e.closable,k=void 0!==b&&b,C=Z(e,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),w=u.useContext(d.E_),S=w.getPrefixCls,I=w.direction,O=u.useState(!0),E=(0,r.Z)(O,2),F=E[0],T=E[1];u.useEffect((function(){"visible"in C&&T(C.visible)}),[C.visible]);var _=function(){return!!v&&(m.test(v)||x.test(v))},W=(0,o.Z)({backgroundColor:v&&!_()?v:void 0},h),q=_(),B=S("tag",i),z=l()(B,(n={},(0,a.Z)(n,"".concat(B,"-").concat(v),q),(0,a.Z)(n,"".concat(B,"-has-color"),v&&!q),(0,a.Z)(n,"".concat(B,"-hidden"),!F),(0,a.Z)(n,"".concat(B,"-rtl"),"rtl"===I),n),f),M=function(e){e.stopPropagation(),null==P||P(e),e.defaultPrevented||"visible"in C||T(!1)},R="onClick"in C||g&&"a"===g.type,A=(0,s.Z)(C,["visible"]),N=y||null,L=N?u.createElement(u.Fragment,null,N,u.createElement("span",null,g)):g,D=u.createElement("span",(0,o.Z)({},A,{ref:t,className:z,style:W}),L,k?j?u.createElement("span",{className:"".concat(B,"-close-icon"),onClick:M},j):u.createElement(c.Z,{className:"".concat(B,"-close-icon"),onClick:M}):null);return R?u.createElement(p.Z,null,D):D},v=u.forwardRef(y);v.CheckableTag=g;var P=v}}]);
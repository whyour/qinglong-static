(self.webpackChunk=self.webpackChunk||[]).push([[2340,8490,833],{42742:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var r=n(88265),i=n(63313),o=n(92260),a=n(22481),s=n(41171),l=n(69947),c=n(84875),u=n.n(c),d=n(51026),h=n(82259),p=n(25515),f=n(11847),g=function(e){return e.children},m=n(88028);function Z(e){return null!=e}var v=function(e){var t,n=e.itemPrefixCls,r=e.component,o=e.span,s=e.className,l=e.style,c=e.labelStyle,d=e.contentStyle,h=e.bordered,p=e.label,f=e.content,g=e.colon,m=r;return h?i.createElement(m,{className:u()((t={},(0,a.Z)(t,"".concat(n,"-item-label"),Z(p)),(0,a.Z)(t,"".concat(n,"-item-content"),Z(f)),t),s),style:l,colSpan:o},Z(p)&&i.createElement("span",{style:c},p),Z(f)&&i.createElement("span",{style:d},f)):i.createElement(m,{className:u()("".concat(n,"-item"),s),style:l,colSpan:o},i.createElement("div",{className:"".concat(n,"-item-container")},(p||0===p)&&i.createElement("span",{className:u()("".concat(n,"-item-label"),(0,a.Z)({},"".concat(n,"-item-no-colon"),!g)),style:c},p),(f||0===f)&&i.createElement("span",{className:u()("".concat(n,"-item-content")),style:d},f)))};function y(e,t,n){var r=t.colon,o=t.prefixCls,a=t.bordered,s=n.component,l=n.type,c=n.showLabel,u=n.showContent,d=n.labelStyle,h=n.contentStyle;return e.map((function(e,t){var n=e.props,p=n.label,f=n.children,g=n.prefixCls,Z=void 0===g?o:g,y=n.className,x=n.style,P=n.labelStyle,b=n.contentStyle,w=n.span,k=void 0===w?1:w,j=e.key;return"string"==typeof s?i.createElement(v,{key:"".concat(l,"-").concat(j||t),className:y,style:x,labelStyle:(0,m.Z)((0,m.Z)({},d),P),contentStyle:(0,m.Z)((0,m.Z)({},h),b),span:k,colon:r,component:s,itemPrefixCls:Z,bordered:a,label:c?p:null,content:u?f:null}):[i.createElement(v,{key:"label-".concat(j||t),className:y,style:(0,m.Z)((0,m.Z)((0,m.Z)({},d),x),P),span:1,colon:r,component:s[0],itemPrefixCls:Z,bordered:a,label:p}),i.createElement(v,{key:"content-".concat(j||t),className:y,style:(0,m.Z)((0,m.Z)((0,m.Z)({},h),x),b),span:2*k-1,component:s[1],itemPrefixCls:Z,bordered:a,content:f})]}))}var x=function(e){var t=i.useContext(P),n=e.prefixCls,r=e.vertical,o=e.row,a=e.index,s=e.bordered;return r?i.createElement(i.Fragment,null,i.createElement("tr",{key:"label-".concat(a),className:"".concat(n,"-row")},y(o,e,(0,m.Z)({component:"th",type:"label",showLabel:!0},t))),i.createElement("tr",{key:"content-".concat(a),className:"".concat(n,"-row")},y(o,e,(0,m.Z)({component:"td",type:"content",showContent:!0},t)))):i.createElement("tr",{key:a,className:"".concat(n,"-row")},y(o,e,(0,m.Z)({component:s?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0},t)))},P=i.createContext({}),b={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};function w(e,t,n){var r=e;return(void 0===t||t>n)&&(r=(0,p.Tm)(e,{span:n})),r}function k(e){var t,n=e.prefixCls,r=e.title,o=e.extra,c=e.column,p=void 0===c?b:c,g=e.colon,m=void 0===g||g,Z=e.bordered,v=e.layout,y=e.children,k=e.className,j=e.style,S=e.size,C=e.labelStyle,_=e.contentStyle,M=i.useContext(h.E_),$=M.getPrefixCls,q=M.direction,I=$("descriptions",n),T=i.useState({}),E=(0,s.Z)(T,2),B=E[0],D=E[1],W=function(e,t){if("number"==typeof e)return e;if("object"===(0,l.Z)(e))for(var n=0;n<f.c4.length;n++){var r=f.c4[n];if(t[r]&&void 0!==e[r])return e[r]||b[r]}return 3}(p,B);i.useEffect((function(){var e=f.ZP.subscribe((function(e){"object"===(0,l.Z)(p)&&D(e)}));return function(){f.ZP.unsubscribe(e)}}),[]);var O=function(e,t){var n=(0,d.Z)(e).filter((function(e){return e})),r=[],i=[],o=t;return n.forEach((function(e,a){var s,l=null===(s=e.props)||void 0===s?void 0:s.span,c=l||1;if(a===n.length-1)return i.push(w(e,l,o)),void r.push(i);c<o?(o-=c,i.push(e)):(i.push(w(e,c,o)),r.push(i),o=t,i=[])})),r}(y,W),N=i.useMemo((function(){return{labelStyle:C,contentStyle:_}}),[C,_]);return i.createElement(P.Provider,{value:N},i.createElement("div",{className:u()(I,(t={},(0,a.Z)(t,"".concat(I,"-").concat(S),S&&"default"!==S),(0,a.Z)(t,"".concat(I,"-bordered"),!!Z),(0,a.Z)(t,"".concat(I,"-rtl"),"rtl"===q),t),k),style:j},(r||o)&&i.createElement("div",{className:"".concat(I,"-header")},r&&i.createElement("div",{className:"".concat(I,"-title")},r),o&&i.createElement("div",{className:"".concat(I,"-extra")},o)),i.createElement("div",{className:"".concat(I,"-view")},i.createElement("table",null,i.createElement("tbody",null,O.map((function(e,t){return i.createElement(x,{key:t,index:t,colon:m,prefixCls:I,vertical:"vertical"===v,bordered:Z,row:e})})))))))}k.Item=g;var j=k,S="container___nww32",C="right___o0xXT",_="title___DHxWh",M="desc___frhI6",$=n(52053),q=n.n($),I=n(11527),T=o.Z.Link,E=function(e){var t=e.systemInfo;return(0,I.jsxs)("div",{className:S,children:[(0,I.jsx)("img",{alt:"logo",style:{width:140,marginRight:20},src:"https://qn.whyour.cn/logo.png"}),(0,I.jsxs)("div",{className:C,children:[(0,I.jsx)("span",{className:_,children:r.ZP.get("青龙")}),(0,I.jsx)("span",{className:M,children:r.ZP.get("支持python3、javascript、shell、typescript 的定时任务管理面板")}),(0,I.jsxs)(j,{children:[(0,I.jsxs)(j.Item,{label:r.ZP.get("版本"),span:3,children:["develop"===(null==t?void 0:t.branch)?r.ZP.get("开发版"):r.ZP.get("正式版")," ","v",t.version]}),(0,I.jsx)(j.Item,{label:r.ZP.get("更新时间"),span:3,children:q()(1e3*t.publishTime).format("YYYY-MM-DD HH:mm")}),(0,I.jsx)(j.Item,{label:r.ZP.get("更新日志"),span:3,children:(0,I.jsx)(T,{href:"https://qn.whyour.cn/version.yaml?t=".concat(Date.now()),target:"_blank",children:r.ZP.get("查看")})})]}),(0,I.jsxs)("div",{children:[(0,I.jsx)(T,{href:"https://github.com/whyour/qinglong",target:"_blank",style:{marginRight:15},children:"Github"}),(0,I.jsx)(T,{href:"https://t.me/jiao_long",target:"_blank",style:{marginRight:15},children:r.ZP.get("Telegram频道")}),(0,I.jsx)(T,{href:"https://github.com/whyour/qinglong/issues",target:"_blank",children:r.ZP.get("提交BUG")})]})]})]})}},32659:function(e,t,n){"use strict";n.r(t);var r=n(25359),i=n.n(r),o=n(57213),a=n.n(o),s=n(49811),l=n.n(s),c=n(54306),u=n.n(c),d=n(88265),h=n(63313),p=n(67393),f=n(9835),g=n(84163),m=n(22159),Z=n(28756),v=n(57229),y=n(15207),x=n(11527);t.default=function(e){var t=e.app,n=e.handleCancel,r=e.visible,o=p.Z.useForm(),s=u()(o,1)[0],c=(0,h.useState)(!1),P=u()(c,2),b=P[0],w=P[1],k=function(){var e=l()(i()().mark((function e(r){var o,s,l,c,u;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(!0),o=t?"put":"post",s=a()({},r),t&&(s.id=t.id),e.prev=4,e.next=7,v.W[o]("".concat(y.Z.apiPrefix,"apps"),s);case 7:l=e.sent,c=l.code,u=l.data,200===c&&(f.ZP.success(t?d.ZP.get("更新应用成功"):d.ZP.get("创建应用成功")),n(u)),w(!1),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),w(!1);case 17:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}();return(0,h.useEffect)((function(){s.resetFields()}),[t,r]),(0,x.jsx)(g.Z,{title:t?d.ZP.get("编辑应用"):d.ZP.get("创建应用"),open:r,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){s.validateFields().then((function(e){k(e)})).catch((function(e){console.log("Validate Failed:",e)}))},onCancel:function(){return n()},confirmLoading:b,children:(0,x.jsxs)(p.Z,{form:s,layout:"vertical",name:"form_app_modal",initialValues:t,children:[(0,x.jsx)(p.Z.Item,{name:"name",label:d.ZP.get("名称"),rules:[{validator:function(e,t){return["system"].includes(t)?Promise.reject(new Error(d.ZP.get("名称不能为保留关键字"))):Promise.resolve()}}],children:(0,x.jsx)(m.Z,{placeholder:d.ZP.get("请输入应用名称")})}),(0,x.jsx)(p.Z.Item,{name:"scopes",label:d.ZP.get("权限"),rules:[{required:!0}],children:(0,x.jsx)(Z.Z,{mode:"multiple",placeholder:d.ZP.get("请选择模块权限"),allowClear:!0,style:{width:"100%"},children:y.Z.scopes.map((function(e){return(0,x.jsx)(Z.Z.Option,{value:e.value,children:e.name},e.value)}))})})]})})}},78008:function(e,t,n){"use strict";n.r(t);var r=n(54306),i=n.n(r),o=n(40141),a=n(15207),s=n(57229),l=n(21758),c=n(99120),u=n.n(c),d=n(89065),h=n(9835),p=n(84163),f=n(24378),g=n(63313),m=n(88265),Z=n(11527),v=d.Z.Countdown;t.default=function(e){var t=e.systemInfo,n=(0,g.useState)(!1),r=i()(n,2),c=r[0],d=r[1],y=(0,g.useState)(""),x=i()(y,2),P=x[0],b=x[1],w=(0,g.useRef)(),k=function(e){p.Z.confirm({width:500,title:m.ZP.get("更新"),content:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{children:m.ZP.get("已经是最新版了！")}),(0,Z.jsxs)("div",{style:{fontSize:12,fontWeight:400,marginTop:5},children:[m.ZP.get("青龙")," ",e.lastVersion," ",m.ZP.get("是目前检测到的最新可用版本了。")]})]}),okText:m.ZP.get("重新下载"),onOk:function(){S(),s.W.put("".concat(a.Z.apiPrefix,"system/update")).then((function(e){})).catch((function(e){console.log(e)}))}})},j=function(e){var n=e.lastVersion,r=e.lastLog;p.Z.confirm({width:500,title:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{children:m.ZP.get("更新可用")}),(0,Z.jsxs)("div",{style:{fontSize:12,fontWeight:400,marginTop:5},children:[m.ZP.get("新版本")," ",n," ",m.ZP.get("可用，你使用的版本为")," ",t.version,"。"]})]}),content:(0,Z.jsx)("pre",{children:(0,Z.jsx)(u(),{children:r})}),okText:m.ZP.get("下载更新"),cancelText:m.ZP.get("以后再说"),onOk:function(){S(),s.W.put("".concat(a.Z.apiPrefix,"system/update")).then((function(e){})).catch((function(e){console.log(e)}))}})},S=function(){b(""),w.current=p.Z.info({width:600,maskClosable:!1,closable:!1,keyboard:!1,okButtonProps:{disabled:!0},title:m.ZP.get("下载更新中..."),centered:!0,content:(0,Z.jsx)("pre",{children:(0,Z.jsx)(u(),{children:P})})})},C=function(e){s.W.put("".concat(a.Z.apiPrefix,"update/").concat(e)).then((function(e){h.ZP.success({content:(0,Z.jsxs)("span",{children:[m.ZP.get("系统将在"),(0,Z.jsx)(v,{className:"inline-countdown",format:"ss",value:Date.now()+3e4}),m.ZP.get("秒后自动刷新")]}),duration:30}),(0,o.o4)(),setTimeout((function(){window.location.reload()}),3e4)})).catch((function(e){console.log(e)}))};(0,g.useEffect)((function(){if(P){var e=P.includes("失败，请检查");w.current.update({maskClosable:e,closable:e,okButtonProps:{disabled:!e},content:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("pre",{children:(0,Z.jsx)(u(),{children:P})}),(0,Z.jsx)("div",{id:"log-identifier",style:{paddingBottom:5}})]})})}}),[P]);var _=(0,g.useCallback)((function(e){var t=e.message;t.includes("失败，请检查")&&h.ZP.error(m.ZP.get("更新失败，请检查网络及日志或稍后再试")),setTimeout((function(){document.querySelector("#log-identifier").scrollIntoView({behavior:"smooth"})}),600),t.includes("更新包下载成功")&&setTimeout((function(){p.Z.confirm({width:600,maskClosable:!1,title:m.ZP.get("确认重启"),centered:!0,content:m.ZP.get("系统安装包下载成功，确认重启"),okText:m.ZP.get("重启"),onOk:function(){C("system")},onCancel:function(){w.current.update({maskClosable:!0,closable:!0,okButtonProps:{disabled:!1}})}})}),1e3),b((function(e){return"".concat(e).concat(t)}))}),[]);return(0,g.useEffect)((function(){var e=l.Z.getInstance();return e.subscribe("updateSystemVersion",_),function(){e.unsubscribe("updateSystemVersion",_)}}),[]),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(f.Z,{type:"primary",onClick:function(){c||(d(!0),h.ZP.loading(m.ZP.get("检查更新中..."),0),s.W.put("".concat(a.Z.apiPrefix,"system/update-check")).then((function(e){var t=e.code,n=e.data;h.ZP.destroy(),200===t&&(n.hasNewVersion?j(n):k(n))})).catch((function(e){h.ZP.destroy(),console.log(e)})).finally((function(){d(!1)})))},children:m.ZP.get("检查更新")}),(0,Z.jsx)(f.Z,{type:"primary",onClick:function(){return C("reload")},style:{marginLeft:8},children:m.ZP.get("重新启动")})]})}},27609:function(e,t,n){"use strict";n.r(t);var r=n(57213),i=n.n(r),o=n(54306),a=n.n(o),s=n(88265),l=n(63313),c=n(67393),u=n(9835),d=n(22159),h=n(24378),p=n(15207),f=n(57229),g=(n(10761),n(99120)),m=n.n(g),Z=n(19334),v=n.n(Z),y=n(21758),x=n(11527),P={"dependence-proxy":"dependenceProxy","node-mirror":"nodeMirror","python-mirror":"pythonMirror","linux-mirror":"linuxMirror"};t.default=function(){var e=(0,l.useState)(),t=a()(e,2),n=t[0],r=t[1],o=c.Z.useForm(),g=a()(o,1)[0],Z=(0,l.useState)(""),b=a()(Z,2),w=b[0],k=b[1],j=(0,l.useState)(!1),S=a()(j,2),C=S[0],_=S[1],M=function(e){_(!0),k("in progress...\n"),f.W.put("".concat(p.Z.apiPrefix,"system/config/").concat(e),v()(n,P[e])).then((function(e){})).catch((function(){_(!1),k((function(e){return"".concat(e,"update mirror error")}))}))},$=function(e){_(!0),k(""),f.W.put("".concat(p.Z.apiPrefix,"system/config/").concat(e),v()(n,P[e])).then((function(e){var t=e.code;e.data;200===t&&u.ZP.success(s.ZP.get("更新成功"))})).catch((function(e){console.log(e)})).finally((function(){return _(!1)}))},q=function(e){var t=e.message;k((function(e){return"".concat(e).concat(t)})),(t.includes("update node mirror end")||t.includes("update linux mirror end"))&&_(!1)};return(0,l.useEffect)((function(){var e=y.Z.getInstance();return e.subscribe("updateNodeMirror",q),e.subscribe("updateLinuxMirror",q),function(){e.subscribe("updateNodeMirror",q),e.unsubscribe("updateLinuxMirror",q)}}),[]),(0,l.useEffect)((function(){f.W.get("".concat(p.Z.apiPrefix,"system/config")).then((function(e){var t=e.code,n=e.data;200===t&&n.info&&r(n.info)})).catch((function(e){console.log(e)}))}),[]),(0,x.jsxs)("div",{className:"dependence-config-wrapper",children:[(0,x.jsxs)(c.Z,{layout:"vertical",form:g,style:{flexShrink:0},children:[(0,x.jsx)(c.Z.Item,{label:s.ZP.get("代理"),name:"proxy",extra:s.ZP.get("代理与镜像源二选一即可"),tooltip:{title:s.ZP.get("代理地址, 支持HTTP(S)/SOCK5"),placement:"topLeft"},children:(0,x.jsxs)(d.Z.Group,{compact:!0,children:[(0,x.jsx)(d.Z,{placeholder:"http://1.1.1.1:8080",style:{width:250},value:null==n?void 0:n.dependenceProxy,onChange:function(e){r(i()(i()({},n),{},{dependenceProxy:e.target.value}))}}),(0,x.jsx)(h.Z,{type:"primary",loading:C,onClick:function(){$("dependence-proxy")},style:{width:100},children:s.ZP.get("确认")})]})}),(0,x.jsx)(c.Z.Item,{label:s.ZP.get("Node 软件包镜像源"),name:"node",tooltip:s.ZP.get("NPM 镜像源"),children:(0,x.jsxs)(d.Z.Group,{compact:!0,children:[(0,x.jsx)(d.Z,{style:{width:250},placeholder:"https://registry.npmmirror.com",value:null==n?void 0:n.nodeMirror,onChange:function(e){r(i()(i()({},n),{},{nodeMirror:e.target.value}))}}),(0,x.jsx)(h.Z,{type:"primary",loading:C,onClick:function(){M("node-mirror")},style:{width:100},children:s.ZP.get("确认")})]})}),(0,x.jsx)(c.Z.Item,{label:s.ZP.get("Python 软件包镜像源"),name:"python",tooltip:s.ZP.get("PyPI 镜像源"),children:(0,x.jsxs)(d.Z.Group,{compact:!0,children:[(0,x.jsx)(d.Z,{style:{width:250},placeholder:"https://pypi.doubanio.com/simple/",value:null==n?void 0:n.pythonMirror,onChange:function(e){r(i()(i()({},n),{},{pythonMirror:e.target.value}))}}),(0,x.jsx)(h.Z,{type:"primary",loading:C,onClick:function(){$("python-mirror")},style:{width:100},children:s.ZP.get("确认")})]})}),(0,x.jsx)(c.Z.Item,{label:s.ZP.get("Linux 软件包镜像源"),name:"linux",tooltip:s.ZP.get("alpine linux 镜像源"),children:(0,x.jsxs)(d.Z.Group,{compact:!0,children:[(0,x.jsx)(d.Z,{style:{width:250},placeholder:"https://mirrors.aliyun.com",value:null==n?void 0:n.linuxMirror,onChange:function(e){r(i()(i()({},n),{},{linuxMirror:e.target.value}))}}),(0,x.jsx)(h.Z,{type:"primary",loading:C,onClick:function(){M("linux-mirror")},style:{width:100},children:s.ZP.get("确认")})]})})]}),(0,x.jsx)("pre",{style:{fontFamily:"Source Code Pro",zoom:.83,maxHeight:"100%",overflowY:"auto"},children:(0,x.jsx)(m(),{children:w})})]})}},38228:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Y}});var r=n(25359),i=n.n(r),o=n(49811),a=n.n(o),s=n(57213),l=n.n(s),c=n(93525),u=n.n(c),d=n(54306),h=n.n(d),p=n(88265),f=n(63313),g=n(92260),m=n(51704),Z=n(2947),v=n(15367),y=n(84163),x=n(9835),P=n(24378),b=n(86986),w=n(94674),k=n(15207),j=n(23435),S=n(57229),C=n(32659),_=n(32132),M=n(14797),$={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},q=n(46420),I=function(e,t){return f.createElement(q.Z,(0,M.Z)((0,M.Z)({},e),{},{ref:t,icon:$}))};I.displayName="ReloadOutlined";var T=f.forwardRef(I),E=n(13740),B=n(5565),D=n(55396),W=n(24023),O=n(123),N=n(42742),A=n(14851),H=(n(10761),n(61761)),L=n(4273),F=n(27609),R=n(11527),V=g.Z.Text,z="demo"===window.__ENV__DeployEnv,Y=function(){var e=(0,A.useOutletContext)(),t=e.headerStyle,n=e.isPhone,r=e.user,o=e.theme,s=e.reloadUser,c=e.reloadTheme,d=e.systemInfo,g=[{title:p.ZP.get("名称"),dataIndex:"name",key:"name"},{title:"Client ID",dataIndex:"client_id",key:"client_id",render:function(e,t){return(0,R.jsx)(V,{copyable:!0,children:t.client_id})}},{title:"Client Secret",dataIndex:"client_secret",key:"client_secret",render:function(e,t){return(0,R.jsx)(V,{copyable:{text:t.client_secret},children:"*******"})}},{title:p.ZP.get("权限"),dataIndex:"scopes",key:"scopes",width:500,render:function(e,t){return(0,R.jsx)("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:t.scopes.map((function(e){return(0,R.jsx)(m.Z,{style:{marginRight:0},children:k.Z.scopesMap[e]},e)}))})}},{title:p.ZP.get("操作"),key:"action",render:function(e,t,r){var i=!n;return(0,R.jsxs)(Z.Z,{size:"middle",style:{paddingLeft:8},children:[(0,R.jsx)(v.Z,{title:i?p.ZP.get("编辑"):"",children:(0,R.jsx)("a",{onClick:function(){return Ce(t,r)},children:(0,R.jsx)(_.Z,{})})}),(0,R.jsx)(v.Z,{title:i?p.ZP.get("重置secret"):"",children:(0,R.jsx)("a",{onClick:function(){return Me(t,r)},children:(0,R.jsx)(T,{})})}),(0,R.jsx)(v.Z,{title:i?p.ZP.get("删除"):"",children:(0,R.jsx)("a",{onClick:function(){return _e(t,r)},children:(0,R.jsx)(E.Z,{})})})]})}}],M=(0,f.useState)(!0),$=h()(M,2),q=$[0],I=$[1],Y=(0,f.useState)([]),U=h()(Y,2),K=U[0],G=U[1],Q=(0,f.useState)(!1),X=h()(Q,2),J=X[0],ee=X[1],te=(0,f.useState)(),ne=h()(te,2),re=ne[0],ie=ne[1],oe=(0,f.useState)("security"),ae=h()(oe,2),se=ae[0],le=ae[1],ce=(0,f.useState)([]),ue=h()(ce,2),de=ue[0],he=ue[1],pe=(0,f.useState)(""),fe=h()(pe,2),ge=fe[0],me=fe[1],Ze=(0,f.useState)(),ve=h()(Ze,2),ye=ve[0],xe=ve[1],Pe=(0,f.useRef)(null),be=(0,f.useState)(0),we=h()(be,2),ke=we[0],je=we[1];(0,H.Z)(Pe,(function(e){var t,n,r=null===(t=e.target.parentElement)||void 0===t||null===(n=t.parentElement)||void 0===n?void 0:n.offsetHeight;r&&ke!==r-66&&je(r-66)}));var Se=function(){I(!0),S.W.get("".concat(k.Z.apiPrefix,"apps")).then((function(e){var t=e.code,n=e.data;200===t&&G(n)})).finally((function(){return I(!1)}))},Ce=function(e,t){ie(e),ee(!0)},_e=function(e,t){y.Z.confirm({title:p.ZP.get("确认删除"),content:(0,R.jsxs)(R.Fragment,{children:[p.ZP.get("确认删除应用")," ",(0,R.jsx)(V,{style:{wordBreak:"break-all"},type:"warning",children:e.name})," ",p.ZP.get("吗")]}),onOk:function(){S.W.delete("".concat(k.Z.apiPrefix,"apps"),{data:[e.id]}).then((function(e){var n=e.code;e.data;if(200===n){x.ZP.success(p.ZP.get("删除成功"));var r=u()(K);r.splice(t,1),G(r)}}))},onCancel:function(){console.log("Cancel")}})},Me=function(e,t){y.Z.confirm({title:p.ZP.get("确认重置"),content:(0,R.jsxs)(R.Fragment,{children:[p.ZP.get("确认重置应用")," ",(0,R.jsx)(V,{style:{wordBreak:"break-all"},type:"warning",children:e.name})," ",p.ZP.get("的Secret吗"),(0,R.jsx)("br",{}),(0,R.jsx)(V,{type:"secondary",children:p.ZP.get("重置Secret会让当前应用所有token失效")})]}),onOk:function(){S.W.put("".concat(k.Z.apiPrefix,"apps/").concat(e.id,"/reset-secret")).then((function(e){var t=e.code,n=e.data;200===t&&(x.ZP.success(p.ZP.get("重置成功")),$e(n))}))},onCancel:function(){console.log("Cancel")}})},$e=function(e){var t=K.findIndex((function(t){return t.id===e.id})),n=u()(K);-1===t?n.push(e):n.splice(t,1,l()({},e)),G(n)},qe=function(){S.W.get("".concat(k.Z.apiPrefix,"user/notification")).then((function(e){var t=e.code,n=e.data;200===t&&xe(n)})).catch((function(e){console.log(e)}))};return(0,f.useEffect)((function(){z&&Se()}),[]),(0,R.jsxs)(j.ZP,{className:"ql-container-wrapper ql-container-wrapper-has-tab ql-setting-container",title:p.ZP.get("系统设置"),header:{style:t},extra:"app"===se?[(0,R.jsx)(P.Z,{type:"primary",onClick:function(){return ie(null),void ee(!0)},children:p.ZP.get("创建应用")},"2")]:[],children:[(0,R.jsx)("div",{ref:Pe,children:(0,R.jsx)(b.Z,{defaultActiveKey:"security",size:"small",tabPosition:"top",onChange:function(e){le(e),"app"===e?Se():"login"===e?S.W.get("".concat(k.Z.apiPrefix,"user/login-log")).then((function(e){var t=e.code,n=e.data;200===t&&he(n)})).catch((function(e){console.log(e)})):"notification"===e?qe():"syslog"===e&&S.W.get("".concat(k.Z.apiPrefix,"system/log"),{responseType:"blob"}).then(function(){var e=a()(i()().mark((function e(t){return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=me,e.next=3,t.text();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},items:[].concat(u()(z?[]:[{key:"security",label:p.ZP.get("安全设置"),children:(0,R.jsx)(B.default,{user:r,userChange:s})}]),[{key:"app",label:p.ZP.get("应用设置"),children:(0,R.jsx)(w.Z,{columns:g,pagination:!1,dataSource:K,rowKey:"id",size:"middle",scroll:{x:1e3},loading:q})},{key:"notification",label:p.ZP.get("通知设置"),children:(0,R.jsx)(W.default,{data:ye})},{key:"syslog",label:p.ZP.get("系统日志"),children:(0,R.jsx)(L.default,{data:ge,height:ke,theme:o})},{key:"login",label:p.ZP.get("登录日志"),children:(0,R.jsx)(D.default,{data:de})},{key:"dependence",label:p.ZP.get("依赖设置"),children:(0,R.jsx)(F.default,{})},{key:"other",label:p.ZP.get("其他设置"),children:(0,R.jsx)(O.default,{reloadTheme:c,systemInfo:d})},{key:"about",label:p.ZP.get("关于"),children:(0,R.jsx)(N.default,{systemInfo:d})}])})}),(0,R.jsx)(C.default,{visible:J,handleCancel:function(e){ee(!1),e&&$e(e)},app:re})]})}},55396:function(e,t,n){"use strict";n.r(t);var r=n(88265),i=(n(63313),n(92260)),o=n(51704),a=n(94674),s=n(52053),l=n.n(s),c=n(11527),u=(i.Z.Text,i.Z.Link,function(e){return e[e["成功"]=0]="成功",e[e["失败"]=1]="失败",e}(u||{})),d=function(e){return e[e.success=0]="success",e[e.error=1]="error",e}(d||{}),h=[{title:r.ZP.get("序号"),width:50,render:function(e,t,n){return n+1}},{title:r.ZP.get("登录时间"),dataIndex:"timestamp",key:"timestamp",width:120,render:function(e,t){return l()(t.timestamp).format("YYYY-MM-DD HH:mm:ss")}},{title:r.ZP.get("登录地址"),dataIndex:"address",width:120,key:"address"},{title:r.ZP.get("登录IP"),dataIndex:"ip",width:100,key:"ip"},{title:r.ZP.get("登录设备"),dataIndex:"platform",key:"platform",width:80},{title:r.ZP.get("登录状态"),dataIndex:"status",key:"status",width:80,render:function(e,t){return(0,c.jsx)(o.Z,{color:d[t.status],style:{marginRight:0},children:r.ZP.get(u[t.status])})}}];t.default=function(e){var t=e.data;return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(a.Z,{columns:h,pagination:!1,dataSource:t,rowKey:"id",size:"middle",scroll:{x:1e3},sticky:!0})})}},24023:function(e,t,n){"use strict";n.r(t);var r=n(57213),i=n.n(r),o=n(54306),a=n.n(o),s=n(88265),l=n(63313),c=n(28756),u=n(67393),d=n(9835),h=n(22159),p=n(24378),f=n(57229),g=n(15207),m=n(11527),Z=c.Z.Option;t.default=function(e){var t=e.data,n=(0,l.useState)(!1),r=a()(n,2),o=r[0],v=r[1],y=(0,l.useState)("closed"),x=a()(y,2),P=x[0],b=x[1],w=(0,l.useState)([]),k=a()(w,2),j=k[0],S=k[1],C=u.Z.useForm(),_=a()(C,1)[0],M=function(e){b(e);var t=g.Z.notificationModeMap[e];S(t||[])};return(0,l.useEffect)((function(){t&&t.type&&(M(t.type),_.setFieldsValue(i()({},t)))}),[t]),(0,m.jsx)("div",{children:(0,m.jsxs)(u.Z,{onFinish:function(e){v(!0),"closed"==e.type&&(e.type=""),f.W.put("".concat(g.Z.apiPrefix,"user/notification"),e).then((function(t){var n=t.code;t.data;200===n&&d.ZP.success(e.type?s.ZP.get("通知发送成功"):s.ZP.get("通知关闭成功"))})).catch((function(e){console.log(e)})).finally((function(){return v(!1)}))},form:_,layout:"vertical",children:[(0,m.jsx)(u.Z.Item,{label:s.ZP.get("通知方式"),name:"type",rules:[{required:!0}],style:{maxWidth:400},initialValue:P,children:(0,m.jsx)(c.Z,{onChange:M,disabled:o,children:g.Z.notificationModes.map((function(e){return(0,m.jsx)(Z,{value:e.value,children:e.label},e.value)}))})}),j.map((function(e){return(0,m.jsx)(u.Z.Item,{label:e.label,name:e.label,extra:e.tip,rules:[{required:e.required}],style:{maxWidth:400},children:e.items?(0,m.jsx)(c.Z,{placeholder:e.placeholder||"".concat(s.ZP.get("请选择")," ").concat(e.label),disabled:o,children:e.items.map((function(e){return(0,m.jsx)(Z,{value:e.value,children:e.label||e.value},e.value)}))}):(0,m.jsx)(h.Z.TextArea,{disabled:o,autoSize:{minRows:1,maxRows:5},placeholder:e.placeholder||"".concat(s.ZP.get("请输入")," ").concat(e.label)})},e.label)})),(0,m.jsx)(p.Z,{type:"primary",htmlType:"submit",disabled:o,children:o?s.ZP.get("测试中..."):s.ZP.get("保存")})]})})}},123:function(e,t,n){"use strict";n.r(t);var r=n(57213),i=n.n(r),o=n(54306),a=n.n(o),s=n(88265),l=n(63313),c=n(67393),u=n(9835),d=n(84163),h=n(84468),p=n(22159),f=n(55484),g=n(24378),m=n(28756),Z=n(57679),v=n(71571),y=n(15207),x=n(57229),P=n(78008),b=n(87105),w=(n(10761),n(59953)),k=n(41422),j=n(7154),S=n(19334),C=n.n(S),_=n(40141),M=n(11527),$={"log-remove-frequency":"logRemoveFrequency","cron-concurrency":"cronConcurrency"};t.default=function(e){var t=e.systemInfo,n=e.reloadTheme,r=localStorage.getItem("qinglong_dark_theme")||"auto",o=(0,l.useState)(),S=a()(o,2),q=S[0],I=S[1],T=c.Z.useForm(),E=a()(T,1)[0],B=(0,l.useState)(!1),D=a()(B,2),W=D[0],O=D[1],N=(0,j.default)(s.ZP.get("上传")),A=(0,j.default)(s.ZP.get("下载")),H=v||{},L=H.enable,F=H.disable,R=(H.exportGeneratedCSS,H.setFetchMethod),V=H.auto,z=function(e){x.W.put("".concat(y.Z.apiPrefix,"system/config/").concat(e),C()(q,$[e])).then((function(e){var t=e.code;e.data;200===t&&u.ZP.success(s.ZP.get("更新成功"))})).catch((function(e){console.log(e)}))};return(0,l.useEffect)((function(){x.W.get("".concat(y.Z.apiPrefix,"system/config")).then((function(e){var t=e.code,n=e.data;200===t&&n.info&&I(n.info)})).catch((function(e){console.log(e)}))}),[]),(0,M.jsxs)(c.Z,{layout:"vertical",form:E,children:[(0,M.jsx)(c.Z.Item,{label:s.ZP.get("主题"),name:"theme",initialValue:r,children:(0,M.jsxs)(h.ZP.Group,{onChange:function(e){var t=e.target.value;localStorage.setItem("qinglong_dark_theme",e.target.value),R(fetch),"dark"===t?L({}):"light"===t?F():V({}),n()},value:r,optionType:"button",buttonStyle:"solid",children:[(0,M.jsx)(h.ZP.Button,{value:"light",style:{width:70,textAlign:"center"},children:s.ZP.get("亮色")}),(0,M.jsx)(h.ZP.Button,{value:"dark",style:{width:66,textAlign:"center"},children:s.ZP.get("暗色")}),(0,M.jsx)(h.ZP.Button,{value:"auto",style:{width:129,textAlign:"center"},children:s.ZP.get("跟随系统")})]})}),(0,M.jsx)(c.Z.Item,{label:s.ZP.get("日志删除频率"),name:"frequency",tooltip:s.ZP.get("每x天自动删除x天以前的日志"),children:(0,M.jsxs)(p.Z.Group,{compact:!0,children:[(0,M.jsx)(f.Z,{addonBefore:s.ZP.get("每"),addonAfter:s.ZP.get("天"),style:{width:180},min:0,value:null==q?void 0:q.logRemoveFrequency,onChange:function(e){I(i()(i()({},q),{},{logRemoveFrequency:e}))}}),(0,M.jsx)(g.Z,{type:"primary",onClick:function(){z("log-remove-frequency")},style:{width:84},children:s.ZP.get("确认")})]})}),(0,M.jsx)(c.Z.Item,{label:s.ZP.get("定时任务并发数"),name:"frequency",children:(0,M.jsxs)(p.Z.Group,{compact:!0,children:[(0,M.jsx)(f.Z,{style:{width:180},min:1,value:null==q?void 0:q.cronConcurrency,onChange:function(e){I(i()(i()({},q),{},{cronConcurrency:e}))}}),(0,M.jsx)(g.Z,{type:"primary",onClick:function(){z("cron-concurrency")},style:{width:84},children:s.ZP.get("确认")})]})}),(0,M.jsx)(c.Z.Item,{label:s.ZP.get("语言"),name:"lang",children:(0,M.jsx)(m.Z,{defaultValue:localStorage.getItem("lang")||"",style:{width:264},onChange:function(e){localStorage.setItem("lang",e),setTimeout((function(){window.location.reload()}),500)},options:[{value:"",label:s.ZP.get("跟随系统")},{value:"zh",label:"简体中文"},{value:"en",label:"English"}]})}),(0,M.jsxs)(c.Z.Item,{label:s.ZP.get("数据备份还原"),name:"frequency",children:[(0,M.jsx)(g.Z,{type:"primary",onClick:function(){O(!0),x.W.put("".concat(y.Z.apiPrefix,"system/data/export"),{},{responseType:"blob",timeout:864e5,onDownloadProgress:function(e){e.progress&&A(parseFloat((100*e.progress).toFixed(1)))}}).then((function(e){(0,b.saveAs)(e,"data.tgz")})).catch((function(e){console.log(e)})).finally((function(){return O(!1)}))},loading:W,children:W?s.ZP.get("生成数据中..."):s.ZP.get("备份")}),(0,M.jsx)(Z.Z,{method:"put",showUploadList:!1,maxCount:1,action:"".concat(y.Z.apiPrefix,"system/data/import"),onChange:function(e){var t=e.file,n=e.event;null!=n&&n.percent&&N(Math.min(parseFloat(null==n?void 0:n.percent.toFixed(1)),99)),"done"===t.status&&(N(100),d.Z.confirm({width:600,maskClosable:!1,title:s.ZP.get("确认重启"),centered:!0,content:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{children:s.ZP.get("备份数据上传成功，确认覆盖数据")}),(0,M.jsxs)("div",{children:[s.ZP.get("如果恢复失败，可进入容器执行")," ql reload data"]})]}),okText:s.ZP.get("重启"),onOk:function(){x.W.put("".concat(y.Z.apiPrefix,"update/data")).then((function(){u.ZP.success({content:(0,M.jsxs)("span",{children:[s.ZP.get("系统将在"),(0,M.jsx)(k.Z,{className:"inline-countdown",format:"ss",value:Date.now()+3e4}),s.ZP.get("秒后自动刷新")]}),duration:30}),(0,_.o4)(),setTimeout((function(){window.location.reload()}),3e4)})).catch((function(e){console.log(e)}))}})),"error"===t.status&&u.ZP.error("上传失败")},name:"data",headers:{Authorization:"Bearer ".concat(localStorage.getItem(y.Z.authKey))},children:(0,M.jsx)(g.Z,{icon:(0,M.jsx)(w.Z,{}),style:{marginLeft:8},children:s.ZP.get("还原数据")})})]}),(0,M.jsx)(c.Z.Item,{label:s.ZP.get("检查更新"),name:"update",children:(0,M.jsx)(P.default,{systemInfo:t})})]})}},7154:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var r=n(88265),i=n(13800),o=n(84163),a=n(63313),s=n(11527),l=function(e){var t=e.percent;return(0,s.jsx)(i.Z,{style:{display:"flex",justifyContent:"center"},type:"circle",percent:t})};function c(e){var t=(0,a.useRef)();return function(n){t.current?(t.current.update({title:"".concat(e).concat(n>=100?r.ZP.get("成功"):r.ZP.get("中...")),content:(0,s.jsx)(l,{percent:n}),okButtonProps:{disabled:100!==n}}),100===n&&setTimeout((function(){var e;null===(e=t.current)||void 0===e||e.destroy(),t.current=null}))):t.current=o.Z.info({width:600,maskClosable:!1,title:"".concat(e).concat(n>=100?r.ZP.get("成功"):r.ZP.get("中...")),centered:!0,content:(0,s.jsx)(l,{percent:n}),okButtonProps:{disabled:!0}})}}},5565:function(e,t,n){"use strict";n.r(t);var r=n(54306),i=n.n(r),o=n(88265),a=n(63313),s=n(92260),l=n(9835),c=n(22159),u=n(24378),d=n(67393),h=n(83535),p=n(57679),f=n(57229),g=n(15207),m=n(14851),Z=n(48039),v=n.n(Z),y=n(4574),x=n(3513),P=n(59953),b=n(24244),w=(n(73324),n(11527)),k=s.Z.Title,j=s.Z.Link;t.default=function(e){var t=e.user,n=e.userChange,r=(0,a.useState)(!1),s=i()(r,2),Z=s[0],S=s[1],C=(0,a.useState)(),_=i()(C,2),M=_[0],$=_[1],q=(0,a.useState)(!1),I=i()(q,2),T=I[0],E=I[1],B=(0,a.useState)(),D=i()(B,2),W=D[0],O=D[1],N=(0,a.useState)(),A=i()(N,2),H=A[0],L=A[1],F=(0,a.useState)(),R=i()(F,2),V=R[0],z=R[1],Y=function(){f.W.put("".concat(g.Z.apiPrefix,"user/two-factor/deactive")).then((function(e){var t=e.code,r=e.data;200===t&&r&&($(!1),n())})).catch((function(e){console.log(e)}))},U=function(){f.W.get("".concat(g.Z.apiPrefix,"user/two-factor/init")).then((function(e){var t=e.code,n=e.data;200===t&&O(n)})).catch((function(e){console.log(e)}))};return(0,a.useEffect)((function(){$(t&&t.twoFactorActivated),z(t.avatar&&"".concat(g.Z.apiPrefix,"static/").concat(t.avatar))}),[t]),T?(0,w.jsx)(w.Fragment,{children:W?(0,w.jsxs)("div",{children:[(0,w.jsx)(k,{level:5,children:o.ZP.get("第一步")}),o.ZP.get("下载两步验证手机应用，比如 Google Authenticator 、"),(0,w.jsx)(j,{href:"https://www.microsoft.com/en-us/security/mobile-authenticator-app",target:"_blank",children:"Microsoft Authenticator"}),"、",(0,w.jsx)(j,{href:"https://authy.com/download/",target:"_blank",children:"Authy"}),"、",(0,w.jsx)(j,{href:"https://support.1password.com/one-time-passwords/",target:"_blank",children:"1Password"}),"、",(0,w.jsx)(j,{href:"https://support.logmeininc.com/lastpass/help/lastpass-authenticator-lp030014",target:"_blank",children:"LastPass Authenticator"}),(0,w.jsx)(k,{style:{marginTop:5},level:5,children:o.ZP.get("第二步")}),o.ZP.get("使用手机应用扫描二维码，或者输入秘钥")," ",null==W?void 0:W.secret,(0,w.jsx)("div",{style:{marginTop:10},children:(0,w.jsx)(v(),{style:{border:"1px solid #21262d",borderRadius:6},includeMargin:!0,size:187,value:null==W?void 0:W.url})}),(0,w.jsx)(k,{style:{marginTop:5},level:5,children:o.ZP.get("第三步")}),o.ZP.get("输入手机应用上的6位数字"),(0,w.jsx)(c.Z,{style:{margin:"10px 0 10px 0",display:"block",maxWidth:200},value:H,onChange:function(e){return L(e.target.value)},placeholder:"123456"}),(0,w.jsx)(u.Z,{type:"primary",loading:Z,onClick:function(){S(!0),f.W.put("".concat(g.Z.apiPrefix,"user/two-factor/active"),{code:H}).then((function(e){var t=e.code,r=e.data;200===t&&(r?(l.ZP.success(o.ZP.get("激活成功")),E(!1),$(!0),n()):l.ZP.success(o.ZP.get("验证失败")))})).catch((function(e){console.log(e)})).finally((function(){return S(!1)}))},children:o.ZP.get("完成设置")})]}):(0,w.jsx)(y.Z,{})}):(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("div",{style:{fontSize:18,borderBottom:"1px solid #f0f0f0",marginBottom:8,paddingBottom:4},children:o.ZP.get("修改用户名密码")}),(0,w.jsxs)(d.Z,{onFinish:function(e){f.W.put("".concat(g.Z.apiPrefix,"user"),{username:e.username,password:e.password}).then((function(e){var t=e.code;e.data;200===t&&(localStorage.removeItem(g.Z.authKey),m.history.push("/login"))})).catch((function(e){console.log(e)}))},layout:"vertical",children:[(0,w.jsx)(d.Z.Item,{label:o.ZP.get("用户名"),name:"username",rules:[{required:!0}],hasFeedback:!0,style:{maxWidth:300},children:(0,w.jsx)(c.Z,{autoComplete:"username",placeholder:o.ZP.get("用户名")})}),(0,w.jsx)(d.Z.Item,{label:o.ZP.get("密码"),name:"password",rules:[{required:!0},{pattern:/^(?!admin$).*$/,message:o.ZP.get("密码不能为admin")}],hasFeedback:!0,style:{maxWidth:300},children:(0,w.jsx)(c.Z,{type:"password",autoComplete:"current-password",placeholder:o.ZP.get("密码")})}),(0,w.jsx)(u.Z,{type:"primary",htmlType:"submit",children:o.ZP.get("保存")})]}),(0,w.jsx)("div",{style:{fontSize:18,borderBottom:"1px solid #f0f0f0",marginBottom:8,paddingBottom:4,marginTop:16},children:o.ZP.get("两步验证")}),(0,w.jsx)(u.Z,{type:"primary",danger:M,onClick:function(){M?Y():(U(),E(!0))},children:M?o.ZP.get("禁用"):o.ZP.get("启用")}),(0,w.jsx)("div",{style:{fontSize:18,borderBottom:"1px solid #f0f0f0",marginBottom:8,paddingBottom:4,marginTop:16},children:o.ZP.get("头像")}),(0,w.jsx)(h.C,{size:128,shape:"square",icon:(0,w.jsx)(x.Z,{}),src:V}),(0,w.jsx)(b.Z,{rotationSlider:!0,children:(0,w.jsx)(p.Z,{method:"put",showUploadList:!1,maxCount:1,action:"".concat(g.Z.apiPrefix,"user/avatar"),onChange:function(e){e.file&&e.file.response&&(z("".concat(g.Z.apiPrefix,"static/").concat(e.file.response.data)),n())},name:"avatar",headers:{Authorization:"Bearer ".concat(localStorage.getItem(g.Z.authKey))},children:(0,w.jsx)(u.Z,{icon:(0,w.jsx)(P.Z,{}),style:{marginLeft:8},children:o.ZP.get("更换头像")})})})]})}},4273:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return g}});var r=n(63313),i=n(31988),o=n(24378),a=n(14797),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z"}}]},name:"vertical-align-top",theme:"outlined"},l=n(46420),c=function(e,t){return r.createElement(l.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:t,icon:s}))};c.displayName="VerticalAlignTopOutlined";var u=r.forwardRef(c),d={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z"}}]},name:"vertical-align-bottom",theme:"outlined"},h=function(e,t){return r.createElement(l.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:t,icon:d}))};h.displayName="VerticalAlignBottomOutlined";var p=r.forwardRef(h),f=n(11527),g=function(e){var t=e.data,n=e.height,a=e.theme,s=(0,r.useRef)(null),l=function(e){s.current.scrollDOM.scrollTo({top:"start"===e?0:s.current.scrollDOM.scrollHeight})};return(0,f.jsxs)("div",{style:{position:"relative"},children:[(0,f.jsx)(i.ZP,{maxHeight:"".concat(n,"px"),value:t,onCreateEditor:function(e){s.current=e},readOnly:!0,theme:a.includes("dark")?"dark":"light"}),(0,f.jsxs)("div",{style:{position:"absolute",bottom:20,right:20,display:"flex",flexDirection:"column",gap:10},children:[(0,f.jsx)(o.Z,{size:"small",icon:(0,f.jsx)(u,{}),onClick:function(){l("start")}}),(0,f.jsx)(o.Z,{size:"small",icon:(0,f.jsx)(p,{}),onClick:function(){l("end")}})]})]})}},15207:function(e,t,n){"use strict";var r=n(88265),i=window.__ENV__QlBaseUrl||"/";t.Z={siteName:r.ZP.get("青龙"),baseUrl:i,apiPrefix:"".concat(i,"api/"),authKey:"token",layouts:[{name:"primary",include:[/.*/],exclude:[/(\/(en|zh))*\/login/]}],i18n:{languages:[{key:"pt-br",title:"Português",flag:"/portugal.svg"},{key:"en",title:"English",flag:"/america.svg"},{key:"zh",title:r.ZP.get("中文"),flag:"/china.svg"}],defaultLanguage:"en"},scopes:[{name:r.ZP.get("定时任务"),value:"crons"},{name:r.ZP.get("环境变量"),value:"envs"},{name:r.ZP.get("订阅管理"),value:"subscriptions"},{name:r.ZP.get("配置文件"),value:"configs"},{name:r.ZP.get("脚本管理"),value:"scripts"},{name:r.ZP.get("日志管理"),value:"logs"},{name:r.ZP.get("依赖管理"),value:"dependencies"},{name:r.ZP.get("系统信息"),value:"system"}],scopesMap:{crons:r.ZP.get("定时任务"),envs:r.ZP.get("环境变量"),subscriptions:r.ZP.get("订阅管理"),configs:r.ZP.get("配置文件"),scripts:r.ZP.get("脚本管理"),logs:r.ZP.get("日志管理"),dependencies:r.ZP.get("依赖管理"),system:r.ZP.get("系统信息")},notificationModes:[{value:"gotify",label:"Gotify"},{value:"goCqHttpBot",label:"GoCqHttpBot"},{value:"serverChan",label:r.ZP.get("Server酱")},{value:"pushDeer",label:"PushDeer"},{value:"bark",label:"Bark"},{value:"telegramBot",label:r.ZP.get("Telegram机器人")},{value:"dingtalkBot",label:r.ZP.get("钉钉机器人")},{value:"weWorkBot",label:r.ZP.get("企业微信机器人")},{value:"weWorkApp",label:r.ZP.get("企业微信应用")},{value:"aibotk",label:r.ZP.get("智能微秘书")},{value:"iGot",label:"IGot"},{value:"pushPlus",label:"PushPlus"},{value:"wePlusBot",label:r.ZP.get("微加机器人")},{value:"chat",label:r.ZP.get("群晖chat")},{value:"email",label:r.ZP.get("邮箱")},{value:"lark",label:r.ZP.get("飞书机器人")},{value:"pushMe",label:"PushMe"},{value:"chronocat",label:"Chronocat"},{value:"webhook",label:r.ZP.get("自定义通知")},{value:"closed",label:r.ZP.get("已关闭")}],notificationModeMap:{gotify:[{label:"gotifyUrl",tip:r.ZP.get("gotify的url地址，例如 https://push.example.de:8080"),required:!0},{label:"gotifyToken",tip:r.ZP.get("gotify的消息应用token码"),required:!0},{label:"gotifyPriority",tip:r.ZP.get("推送消息的优先级")}],chat:[{label:"chatUrl",tip:r.ZP.get("chat的url地址"),required:!0},{label:"chatToken",tip:r.ZP.get("chat的token码"),required:!0}],goCqHttpBot:[{label:"goCqHttpBotUrl",tip:r.ZP.get("推送到个人QQ: http://127.0.0.1/send_private_msg，群：http://127.0.0.1/send_group_msg"),required:!0},{label:"goCqHttpBotToken",tip:r.ZP.get("访问密钥"),required:!0},{label:"goCqHttpBotQq",tip:r.ZP.get("如果GOBOT_URL设置 /send_private_msg 则需要填入 user_id=个人QQ 相反如果是 /send_group_msg 则需要填入 group_id=QQ群"),required:!0}],serverChan:[{label:"serverChanKey",tip:r.ZP.get("Server酱SENDKEY"),required:!0}],pushDeer:[{label:"pushDeerKey",tip:r.ZP.get("PushDeer的Key，https://github.com/easychen/pushdeer"),required:!0},{label:"pushDeerUrl",tip:r.ZP.get("PushDeer的自架API endpoint，默认是 https://api2.pushdeer.com/message/push")}],bark:[{label:"barkPush",tip:r.ZP.get("Bark的信息IP/设备码，例如：https://api.day.app/XXXXXXXX"),required:!0},{label:"barkIcon",tip:r.ZP.get("BARK推送图标，自定义推送图标 (需iOS15或以上才能显示)")},{label:"barkSound",tip:r.ZP.get("BARK推送铃声，铃声列表去APP查看复制填写")},{label:"barkGroup",tip:r.ZP.get("BARK推送消息的分组，默认为qinglong")},{label:"barkLevel",tip:r.ZP.get("BARK推送消息的时效性，默认为active")},{label:"barkUrl",tip:r.ZP.get("BARK推送消息的跳转URL")},{label:"barkArchive",tip:r.ZP.get("BARK是否保存推送消息")}],telegramBot:[{label:"telegramBotToken",tip:r.ZP.get("telegram机器人的token，例如：1077xxx4424:AAFjv0FcqxxxxxxgEMGfi22B4yh15R5uw"),required:!0},{label:"telegramBotUserId",tip:r.ZP.get("telegram用户的id，例如：129xxx206"),required:!0},{label:"telegramBotProxyHost",tip:r.ZP.get("代理IP")},{label:"telegramBotProxyPort",tip:r.ZP.get("代理端口")},{label:"telegramBotProxyAuth",tip:r.ZP.get("telegram代理配置认证参数，用户名与密码用英文冒号连接 user:password")},{label:"telegramBotApiHost",tip:r.ZP.get("telegram api自建的反向代理地址，默认tg官方api")}],dingtalkBot:[{label:"dingtalkBotToken",tip:r.ZP.get("钉钉机器人webhook token，例如：5a544165465465645d0f31dca676e7bd07415asdasd"),required:!0},{label:"dingtalkBotSecret",tip:r.ZP.get("密钥，机器人安全设置页面，加签一栏下面显示的SEC开头的字符串")}],weWorkBot:[{label:"weWorkBotKey",tip:r.ZP.get("企业微信机器人的webhook(详见文档 https://work.weixin.qq.com/api/doc/90000/90136/91770)，例如：693a91f6-7xxx-4bc4-97a0-0ec2sifa5aaa"),required:!0},{label:"weWorkOrigin",tip:r.ZP.get("企业微信代理地址")}],weWorkApp:[{label:"weWorkAppKey",tip:r.ZP.get("corpid、corpsecret、touser(注:多个成员ID使用|隔开)、agentid、消息类型(选填，不填默认文本消息类型) 注意用,号隔开(英文输入法的逗号)，例如：wwcfrs,B-76WERQ,qinglong,1000001,2COat"),required:!0},{label:"weWorkOrigin",tip:r.ZP.get("企业微信代理地址")}],aibotk:[{label:"aibotkKey",tip:r.ZP.get("密钥key，智能微秘书个人中心获取apikey，申请地址：https://wechat.aibotk.com/signup?from=ql"),required:!0},{label:"aibotkType",tip:r.ZP.get("发送的目标，群组或者好友"),required:!0,placeholder:r.ZP.get("请输入要发送的目标"),items:[{value:"room",label:r.ZP.get("群聊")},{value:"contact",label:r.ZP.get("好友")}]},{label:"aibotkName",tip:r.ZP.get("要发送的用户昵称或群名，如果目标是群，需要填群名，如果目标是好友，需要填好友昵称"),required:!0}],iGot:[{label:"iGotPushKey",tip:r.ZP.get("iGot的信息推送key，例如：https://push.hellyw.com/XXXXXXXX"),required:!0}],pushPlus:[{label:"pushPlusToken",tip:r.ZP.get("微信扫码登录后一对一推送或一对多推送下面的token(您的Token)，不提供PUSH_PLUS_USER则默认为一对一推送，参考 https://www.pushplus.plus/"),required:!0},{label:"pushPlusUser",tip:r.ZP.get("一对多推送的“群组编码”（一对多推送下面->您的群组(如无则创建)->群组编码，如果您是创建群组人。也需点击“查看二维码”扫描绑定，否则不能接受群组消息推送）")}],wePlusBot:[{label:"wePlusBotToken",tip:r.ZP.get("用户令牌，扫描登录后 我的—>设置->令牌 中获取，参考 https://www.weplusbot.com/"),required:!0},{label:"wePlusBotReceiver",tip:r.ZP.get("消息接收人")},{label:"wePlusBotVersion",tip:r.ZP.get("调用版本；专业版填写pro，个人版填写personal，为空默认使用专业版")}],lark:[{label:"larkKey",tip:r.ZP.get("飞书群组机器人：https://www.feishu.cn/hc/zh-CN/articles/360024984973"),required:!0}],email:[{label:"emailService",tip:r.ZP.get("邮箱服务名称，比如126、163、Gmail、QQ等，支持列表https://github.com/nodemailer/nodemailer/blob/master/lib/well-known/services.json"),required:!0},{label:"emailUser",tip:r.ZP.get("邮箱地址"),required:!0},{label:"emailPass",tip:r.ZP.get("SMTP 登录密码，也可能为特殊口令，视具体邮件服务商说明而定"),required:!0}],pushMe:[{label:"pushMeKey",tip:r.ZP.get("PushMe的Key，https://push.i-i.me/"),required:!0},{label:"pushMeUrl",tip:r.ZP.get("自建的PushMeServer消息接口地址，例如：http://127.0.0.1:3010，不填则使用官方消息接口"),required:!1}],chronocat:[{label:"chronocatURL",tip:r.ZP.get("Chronocat Red 服务的连接地址 https://chronocat.vercel.app/install/docker/official/"),required:!0},{label:"chronocatQQ",tip:r.ZP.get("个人:user_id=个人QQ 群则填入group_id=QQ群 多个用英文;隔开同时支持个人和群 如：user_id=xxx;group_id=xxxx;group_id=xxxxx"),required:!0},{label:"chronocatToken",tip:r.ZP.get("docker安装在持久化config目录下的chronocat.yml文件可找到"),required:!0}],webhook:[{label:"webhookMethod",tip:r.ZP.get("请求方法"),required:!0,items:[{value:"GET"},{value:"POST"},{value:"PUT"}]},{label:"webhookContentType",tip:r.ZP.get("请求头Content-Type"),required:!0,items:[{value:"text/plain"},{value:"application/json"},{value:"multipart/form-data"},{value:"application/x-www-form-urlencoded"}]},{label:"webhookUrl",tip:r.ZP.get("请求链接以http或者https开头。url或者body中必须包含$title，$content可选，对应api内容的位置"),required:!0,placeholder:"https://xxx.cn/api?content=$title\n"},{label:"webhookHeaders",tip:r.ZP.get("请求头格式Custom-Header1: Header1，多个换行分割"),placeholder:"Custom-Header1: Header1\nCustom-Header2: Header2"},{label:"webhookBody",tip:r.ZP.get("请求体格式key1: value1，多个换行分割。url或者body中必须包含$title，$content可选，对应api内容的位置"),placeholder:"key1: $title\nkey2: $content"}]},documentTitleMap:{"/login":r.ZP.get("登录"),"/initialization":r.ZP.get("初始化"),"/crontab":r.ZP.get("定时任务"),"/env":r.ZP.get("环境变量"),"/subscription":r.ZP.get("订阅管理"),"/config":r.ZP.get("配置文件"),"/script":r.ZP.get("脚本管理"),"/diff":r.ZP.get("对比工具"),"/log":r.ZP.get("日志管理"),"/setting":r.ZP.get("系统设置"),"/error":r.ZP.get("错误日志"),"/dependence":r.ZP.get("依赖管理")},dependenceTypes:["nodejs","python3","linux"]}},57229:function(e,t,n){"use strict";n.d(t,{W:function(){return g}});var r=n(25359),i=n.n(r),o=n(49811),a=n.n(o),s=n(88265),l=n(9835),c=n(15207),u=n(14851),d=n(73669);l.ZP.config({duration:2});var h=Date.now(),p=d.Z.create({timeout:6e4,params:{t:h}}),f=["/api/user/login","/open/auth/token","/api/user/two-factor/login","/api/system","/api/user/init","/api/user/notification/init"];p.interceptors.request.use((function(e){var t=localStorage.getItem(c.Z.authKey);return t&&!f.includes(e.url)?(e.headers.Authorization="Bearer ".concat(t),e):e})),p.interceptors.response.use(function(){var e=a()(i()().mark((function e(t){var n,r,o;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.status,![502,504].includes(n)){e.next=5;break}u.history.push("/error"),e.next=18;break;case 5:if(401!==n){e.next=9;break}"/login"!==u.history.location.pathname&&(localStorage.removeItem(c.Z.authKey),u.history.push("/login")),e.next=18;break;case 9:return e.prev=9,200!==(r=t.data).code&&(o=r.message||r.data)&&l.ZP.error({content:o,style:{maxWidth:500,margin:"0 auto"}}),e.abrupt("return",r);case 15:e.prev=15,e.t0=e.catch(9);case 17:case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}}),e,null,[[9,15]])})));return function(t){return e.apply(this,arguments)}}(),(function(e){if(e.response){var t=e.response.data?e.response.data.message||e.message||e.response.data:e.response.statusText,n=e.response.status;if([502,504].includes(n))u.history.push("/error");else if(401===n)"/login"!==u.history.location.pathname&&(l.ZP.error(s.ZP.get("登录已过期，请重新登录")),localStorage.removeItem(c.Z.authKey),u.history.push("/login"));else{var r,i;if("function"==typeof(null===(r=e.config)||void 0===r?void 0:r.onError))return null===(i=e.config)||void 0===i?void 0:i.onError(e.response);l.ZP.error({content:t,style:{maxWidth:500,margin:"0 auto"}})}}else console.log(e.message);return Promise.reject(e)}));var g=p},40141:function(e,t,n){"use strict";n.d(t,{ZP:function(){return c},I1:function(){return h},o4:function(){return y},w7:function(){return d},DY:function(){return p},FA:function(){return g},rS:function(){return Z},H$:function(){return v},W9:function(){return u},x$:function(){return f}});var r=n(93525),i=n.n(r),o=n(88265),a={".py":"python",".js":"javascript",".mjs":"javascript",".sh":"shell",".ts":"typescript"},s=n(11186),l=n.n(s);function c(){var e=navigator.userAgent.toLowerCase(),t=function(t){return t.test(e)},n=function(t){return(e.match(t)||[]).toString().replace(/[^0-9|_.]/g,"").replace(/_/g,".")},r="unknow";t(/windows|win32|win64|wow32|wow64/g)?r="windows":t(/macintosh|macintel/g)?r="macos":t(/x11/g)?r="linux":t(/android|adr/g)?r="android":t(/ios|iphone|ipad|ipod|iwatch/g)&&(r="ios");var i="unknow";"windows"===r?t(/windows nt 5.0|windows 2000/g)?i="2000":t(/windows nt 5.1|windows xp/g)?i="xp":t(/windows nt 5.2|windows 2003/g)?i="2003":t(/windows nt 6.0|windows vista/g)?i="vista":t(/windows nt 6.1|windows 7/g)?i="7":t(/windows nt 6.2|windows 8/g)?i="8":t(/windows nt 6.3|windows 8.1/g)?i="8.1":t(/windows nt 10.0|windows 10/g)&&(i="10"):"macos"===r?i=n(/os x [\d._]+/g):"android"===r?i=n(/android [\d._]+/g):"ios"===r&&(i=n(/os [\d._]+/g));var o="unknow";"windows"===r||"macos"===r||"linux"===r?o="desktop":("android"===r||"ios"===r||t(/mobile/g))&&(o="mobile");var a="unknow",s="unknow";t(/applewebkit/g)?(a="webkit",t(/edge/g)?s="edge":t(/opr/g)?s="opera":t(/chrome/g)?s="chrome":t(/safari/g)&&(s="safari")):t(/gecko/g)&&t(/firefox/g)?(a="gecko",s="firefox"):t(/presto/g)?(a="presto",s="opera"):t(/trident|compatible|msie/g)&&(a="trident",s="iexplore");var l="unknow";"webkit"===a?l=n(/applewebkit\/[\d._]+/g):"gecko"===a?l=n(/gecko\/[\d._]+/g):"presto"===a?l=n(/presto\/[\d._]+/g):"trident"===a&&(l=n(/trident\/[\d._]+/g));var c="unknow";"chrome"===s?c=n(/chrome\/[\d._]+/g):"safari"===s?c=n(/version\/[\d._]+/g):"firefox"===s?c=n(/firefox\/[\d._]+/g):"opera"===s?c=n(/opr\/[\d._]+/g):"iexplore"===s?c=n(/(msie [\d._]+)|(rv:[\d._]+)/g):"edge"===s&&(c=n(/edge\/[\d._]+/g));var u="none",d="unknow";t(/micromessenger/g)?(u="wechat",d=n(/micromessenger\/[\d._]+/g)):t(/qqbrowser/g)?(u="qq",d=n(/qqbrowser\/[\d._]+/g)):t(/ucbrowser/g)?(u="uc",d=n(/ucbrowser\/[\d._]+/g)):t(/qihu 360se/g)?u="360":t(/2345explorer/g)?(u="2345",d=n(/2345explorer\/[\d._]+/g)):t(/metasr/g)?u="sougou":t(/lbbrowser/g)?u="liebao":t(/maxthon/g)&&(u="maxthon",d=n(/maxthon\/[\d._]+/g));var h=Object.assign({engine:a,engineVs:l,platform:o,supporter:s,supporterVs:c,system:r,systemVs:i},"none"===u?{}:{shell:u,shellVs:d});return console.log("%c\n .d88b.  d888888b d8b   db  d888b  db       .d88b.  d8b   db  d888b  \n.8P  Y8.   `88'   888o  88 88' Y8b 88      .8P  Y8. 888o  88 88' Y8b \n88    88    88    88V8o 88 88      88      88    88 88V8o 88 88      \n88    88    88    88 V8o88 88  ooo 88      88    88 88 V8o88 88  ooo \n`8P  d8'   .88.   88  V888 88. ~8~ 88booo. `8b  d8' 88  V888 88. ~8~ \n `Y88'Y8 Y888888P VP   V8P  Y888P  Y88888P  `Y88P'  VP   V8P  Y888P  \n                                                                     \n                                                                     \n","color: blue;font-size: 14px;"),console.log("%c忘形雨笠烟蓑，知心牧唱樵歌。明月清风共我，闲人三个，从他今古消磨。\n","color: yellow;font-size: 18px;"),console.log("%c青龙运行环境:\n\n系统：".concat(h.system,"/").concat(h.systemVs,"\n浏览器：").concat(h.supporter,"/").concat(h.supporterVs,"\n内核：").concat(h.engine,"/").concat(h.engineVs),"color: green;font-size: 14px;font-weight: bold;"),h}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.extraHeight,n=e.target;void 0===t&&(t=99);var r=null,i=0;(r=n||document.querySelector(".ant-table-wrapper"))&&(i=r.getBoundingClientRect().top);var o=document.body.clientHeight-i-t;return o}function d(e,t){var n,r,i=window.URL||window.webkitURL||window,o=new Blob([t]),a=document.createElementNS("http://www.w3.org/1999/xhtml","a");a.href=i.createObjectURL(o),a.download=e,n=a,(r=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(r)}function h(e,t,n){var r=i()(e),o=[];return function e(r){if(r)for(var i=0;i<(null==r?void 0:r.length);i++){if(t(r[i]))return n?void(r[i].children?r[i].children.unshift(n):r[i].children=[n]):void r.splice(i,1);r[i].children&&(o.push(r[i].key),e(r[i].children))}}(r),r}function p(e,t){var n;return function e(r){if(r)for(var i=0;i<(null==r?void 0:r.length);i++)t(r[i])?n=r[i]:r[i].children&&e(r[i].children)}(i()(e)),n}function f(e){return["　　　　　",o.ZP.get("执行结束")].some((function(t){return e.includes(t)}))}function g(e){var t=e.split(" ");if("repo"===t[1]||"raw"===t[1])return t[2];var n=t.find((function(e){return[".js",".ts",".sh",".py"].some((function(t){return e.endsWith(t)}))}));if(n){var r,i;n.startsWith("/ql/data/scripts")&&(n=n.replace("/ql/data/scripts/",""));var o=n.lastIndexOf("/");return o>=0?(i=n.slice(o+1),r=n.slice(0,o)):(i=n,r=""),[i,r]}}function m(e){try{var t=l().parseExpression(e);if(t)return t.next().toDate()}catch(e){}return null}function Z(e,t){var n=m(e);return null!=t&&t.length&&t.forEach((function(e){var t=m(e);t&&(!n||t<n)&&(n=t)})),n}function v(e){var t=function(e){if(!e)return"";var t=e.split(".");return".".concat(t[t.length-1])}(e);return a[t]}function y(){var e=document.createElement("div");e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.width="100%",e.style.height="100%",e.style.backgroundColor="transparent",e.style.zIndex="9999",document.body.appendChild(e),e.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault()})),document.body.style.overflow="hidden"}},21758:function(e,t,n){"use strict";var r=n(93525),i=n.n(r),o=n(12342),a=n.n(o),s=n(25359),l=n.n(s),c=n(49811),u=n.n(c),d=n(21140),h=n.n(d),p=n(63466),f=n.n(p),g=n(52510),m=n.n(g),Z=n(78078),v=n.n(Z),y=["type"],x=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};h()(this,e),m()(this,"url",void 0),m()(this,"socket",null),m()(this,"subscriptions",new Map),m()(this,"options",void 0),m()(this,"reconnectAttempts",0),m()(this,"heartbeatTimeout",null),m()(this,"state","closed"),this.url=t,this.options={maxReconnectAttempts:n.maxReconnectAttempts||5,reconnectInterval:n.reconnectInterval||3e3,heartbeatInterval:n.heartbeatInterval||3e4},this.init()}var t,n;return f()(e,[{key:"init",value:(n=u()(l()().mark((function e(){var t=this;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.state="connecting",this.emit("connecting");case 3:if(!(this.reconnectAttempts<this.options.maxReconnectAttempts)){e.next=16;break}return this.socket=new(v())(this.url),this.setupEventListeners(),this.startHeartbeat(),e.next=9,this.waitForClose();case 9:return this.stopHeartbeat(),this.socket=null,this.reconnectAttempts++,e.next=14,new Promise((function(e){return setTimeout(e,t.options.reconnectInterval)}));case 14:e.next=3;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),this.handleError(e.t0);case 21:case"end":return e.stop()}}),e,this,[[0,18]])}))),function(){return n.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this;this.socket&&(this.socket.onopen=function(){e.state="open",e.emit("open")},this.socket.onmessage=function(t){var n=JSON.parse(t.data);e.dispatchMessage(n)},this.socket.onclose=function(){e.state="closed",e.emit("close")})}},{key:"waitForClose",value:(t=u()(l()().mark((function e(){var t;return l()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(t=this.socket)||void 0===t?void 0:t.readyState)===v().CLOSED){e.next=5;break}return e.next=3,new Promise((function(e){return setTimeout(e,100)}));case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"subscribe",value:function(e,t){var n=this.subscriptions.get(e)||new Set;if(!n.has(t)){n.add(t),this.subscriptions.set(e,n);var r={action:"subscribe",topic:e};this.send(r)}}},{key:"unsubscribe",value:function(e,t){var n=this.subscriptions.get(e)||new Set;if(n.has(t)){n.delete(t);var r={action:"unsubscribe",topic:e};this.send(r)}}},{key:"send",value:function(e){var t;(null===(t=this.socket)||void 0===t?void 0:t.readyState)===v().OPEN&&this.socket.send(JSON.stringify(e))}},{key:"dispatchMessage",value:function(e){var t=e.type,n=a()(e,y),r=this.subscriptions.get(t)||new Set;i()(r).forEach((function(e){return e(n)}))}},{key:"startHeartbeat",value:function(){var e=this;this.heartbeatTimeout=setInterval((function(){var t;(null===(t=e.socket)||void 0===t?void 0:t.readyState)===v().OPEN&&e.socket.send(JSON.stringify({type:"heartbeat"}))}),this.options.heartbeatInterval)}},{key:"stopHeartbeat",value:function(){this.heartbeatTimeout&&clearInterval(this.heartbeatTimeout)}},{key:"close",value:function(){this.socket&&(this.state="closed",this.stopHeartbeat(),this.socket.close(),this.emit("close"))}},{key:"handleError",value:function(e){console.error("WebSocket错误:",e),this.emit("error",e)}},{key:"on",value:function(e,t){}},{key:"emit",value:function(e,t){}}],[{key:"getInstance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;return e.instance||(e.instance=new e(t,n)),e.instance}}]),e}();m()(x,"instance",null),t.Z=x},10761:function(){},52053:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,r="millisecond",i="second",o="minute",a="hour",s="day",l="week",c="month",u="quarter",d="year",h="date",p="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},Z=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},v={s:Z,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+Z(r,2,"0")+":"+Z(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(r,c),o=n-i<0,a=t.clone().add(r+(o?-1:1),c);return+(-(r+(n-i)/(o?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:l,d:s,D:h,h:a,m:o,s:i,ms:r,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",x={};x[y]=m;var P=function(e){return e instanceof j},b=function e(t,n,r){var i;if(!t)return y;if("string"==typeof t){var o=t.toLowerCase();x[o]&&(i=o),n&&(x[o]=n,i=o);var a=t.split("-");if(!i&&a.length>1)return e(a[0])}else{var s=t.name;x[s]=t,i=s}return!r&&i&&(y=i),i||!r&&y},w=function(e,t){if(P(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new j(n)},k=v;k.l=b,k.i=P,k.w=function(e,t){return w(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var j=function(){function m(e){this.$L=b(e.locale,null,!0),this.parse(e)}var Z=m.prototype;return Z.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(k.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(f);if(r){var i=r[2]-1||0,o=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},Z.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},Z.$utils=function(){return k},Z.isValid=function(){return!(this.$d.toString()===p)},Z.isSame=function(e,t){var n=w(e);return this.startOf(t)<=n&&n<=this.endOf(t)},Z.isAfter=function(e,t){return w(e)<this.startOf(t)},Z.isBefore=function(e,t){return this.endOf(t)<w(e)},Z.$g=function(e,t,n){return k.u(e)?this[t]:this.set(n,e)},Z.unix=function(){return Math.floor(this.valueOf()/1e3)},Z.valueOf=function(){return this.$d.getTime()},Z.startOf=function(e,t){var n=this,r=!!k.u(t)||t,u=k.p(e),p=function(e,t){var i=k.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?i:i.endOf(s)},f=function(e,t){return k.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},g=this.$W,m=this.$M,Z=this.$D,v="set"+(this.$u?"UTC":"");switch(u){case d:return r?p(1,0):p(31,11);case c:return r?p(1,m):p(0,m+1);case l:var y=this.$locale().weekStart||0,x=(g<y?g+7:g)-y;return p(r?Z-x:Z+(6-x),m);case s:case h:return f(v+"Hours",0);case a:return f(v+"Minutes",1);case o:return f(v+"Seconds",2);case i:return f(v+"Milliseconds",3);default:return this.clone()}},Z.endOf=function(e){return this.startOf(e,!1)},Z.$set=function(e,t){var n,l=k.p(e),u="set"+(this.$u?"UTC":""),p=(n={},n[s]=u+"Date",n[h]=u+"Date",n[c]=u+"Month",n[d]=u+"FullYear",n[a]=u+"Hours",n[o]=u+"Minutes",n[i]=u+"Seconds",n[r]=u+"Milliseconds",n)[l],f=l===s?this.$D+(t-this.$W):t;if(l===c||l===d){var g=this.clone().set(h,1);g.$d[p](f),g.init(),this.$d=g.set(h,Math.min(this.$D,g.daysInMonth())).$d}else p&&this.$d[p](f);return this.init(),this},Z.set=function(e,t){return this.clone().$set(e,t)},Z.get=function(e){return this[k.p(e)]()},Z.add=function(r,u){var h,p=this;r=Number(r);var f=k.p(u),g=function(e){var t=w(p);return k.w(t.date(t.date()+Math.round(e*r)),p)};if(f===c)return this.set(c,this.$M+r);if(f===d)return this.set(d,this.$y+r);if(f===s)return g(1);if(f===l)return g(7);var m=(h={},h[o]=t,h[a]=n,h[i]=e,h)[f]||1,Z=this.$d.getTime()+r*m;return k.w(Z,this)},Z.subtract=function(e,t){return this.add(-1*e,t)},Z.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||p;var r=e||"YYYY-MM-DDTHH:mm:ssZ",i=k.z(this),o=this.$H,a=this.$m,s=this.$M,l=n.weekdays,c=n.months,u=function(e,n,i,o){return e&&(e[n]||e(t,r))||i[n].slice(0,o)},d=function(e){return k.s(o%12||12,e,"0")},h=n.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},f={YY:String(this.$y).slice(-2),YYYY:k.s(this.$y,4,"0"),M:s+1,MM:k.s(s+1,2,"0"),MMM:u(n.monthsShort,s,c,3),MMMM:u(c,s),D:this.$D,DD:k.s(this.$D,2,"0"),d:String(this.$W),dd:u(n.weekdaysMin,this.$W,l,2),ddd:u(n.weekdaysShort,this.$W,l,3),dddd:l[this.$W],H:String(o),HH:k.s(o,2,"0"),h:d(1),hh:d(2),a:h(o,a,!0),A:h(o,a,!1),m:String(a),mm:k.s(a,2,"0"),s:String(this.$s),ss:k.s(this.$s,2,"0"),SSS:k.s(this.$ms,3,"0"),Z:i};return r.replace(g,(function(e,t){return t||f[e]||i.replace(":","")}))},Z.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Z.diff=function(r,h,p){var f,g=k.p(h),m=w(r),Z=(m.utcOffset()-this.utcOffset())*t,v=this-m,y=k.m(this,m);return y=(f={},f[d]=y/12,f[c]=y,f[u]=y/3,f[l]=(v-Z)/6048e5,f[s]=(v-Z)/864e5,f[a]=v/n,f[o]=v/t,f[i]=v/e,f)[g]||v,p?y:k.a(y)},Z.daysInMonth=function(){return this.endOf(c).$D},Z.$locale=function(){return x[this.$L]},Z.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=b(e,t,!0);return r&&(n.$L=r),n},Z.clone=function(){return k.w(this.$d,this)},Z.toDate=function(){return new Date(this.valueOf())},Z.toJSON=function(){return this.isValid()?this.toISOString():null},Z.toISOString=function(){return this.$d.toISOString()},Z.toString=function(){return this.$d.toUTCString()},m}(),S=j.prototype;return w.prototype=S,[["$ms",r],["$s",i],["$m",o],["$H",a],["$W",s],["$M",c],["$y",d],["$D",h]].forEach((function(e){S[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),w.extend=function(e,t){return e.$i||(e(t,j,w),e.$i=!0),w},w.locale=b,w.isDayjs=P,w.unix=function(e){return w(1e3*e)},w.en=x[y],w.Ls=x,w.p={},w}()},38433:function(){}}]);
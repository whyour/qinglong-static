(self.webpackChunk=self.webpackChunk||[]).push([[9818],{88939:function(e,t,n){"use strict";var i=n(2053),r=n(75271),a=n(19579),o=n(48881),c=function(e,t){return r.createElement(o.Z,(0,i.Z)({},e,{ref:t,icon:a.Z}))},l=r.forwardRef(c);t.Z=l},82802:function(e,t,n){"use strict";var i=n(26068),r=n.n(i),a=n(75271);t.Z=function(e,t,n){var i=n.treeNodeFilterProp;return(0,a.useMemo)((function(){var n=[];if(!t)return{treeData:e,keys:n};var a=t.toUpperCase();function o(e,t){var n=t[i];return String(n).toUpperCase().includes(a)}return{treeData:function e(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.map((function(t){var a=t.children,c=i||o(0,t),l=e(a||[],c);return c||l.length?(l.length&&n.push(t.key),r()(r()({},t),{},{children:l})):null})).filter((function(e){return e}))}(e),keys:n}}),[e,t,i])}},85565:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var i=n(15558),r=n.n(i),a=n(48305),o=n.n(a),c=n(72317),l=n(75271),s=n(50691),u=n(45520),f=n(61508),d=n(88142),g=n(59816),h=n(93481),p=n(17082),m=n(13107),x=n(98705),v=n(3475),y=n(47508),Z=n(83383),b=n(16314),P={"left-tree-container":"left-tree-container___zHanw","left-tree-scroller":"left-tree-scroller___PInUN","log-container":"log-container___ba9Tr"},k=n(71742),S=n(43382),j=n(98783),w=n(88939),B=n(52076),C=n(66292),E=n.n(C),N=n(4363),M=n.n(N),F=n(82802),D=n(79514),_=n(52676),I=s.Z.Text,T=function(){var e=(0,j.useOutletContext)(),t=e.headerStyle,n=e.isPhone,i=e.theme,a=(0,l.useState)(c.ZP.get("请选择日志文件")),s=o()(a,2),C=s[0],N=s[1],T=(0,l.useState)(c.ZP.get("请选择日志文件")),z=o()(T,2),L=z[0],A=z[1],G=(0,l.useState)([]),O=o()(G,2),Y=O[0],$=O[1],H=(0,l.useState)(!1),K=o()(H,2),R=K[0],U=K[1],W=(0,l.useState)(),q=o()(W,2),J=q[0],Q=q[1],V=(0,l.useRef)(),X=(0,l.useState)([]),ee=o()(X,2),te=ee[0],ne=ee[1],ie=(0,l.useState)(),re=o()(ie,2),ae=re[0],oe=re[1],ce=(0,l.useState)(""),le=o()(ce,2),se=le[0],ue=le[1],fe=function(e,t){t.key!==L&&e&&(oe(t),A(e),"directory"!==t.type?(N(c.ZP.get("加载中...")),function(e){b.W.get("".concat(v.Z.apiPrefix,"logs/detail?file=").concat(e.title,"&path=").concat(e.parent||"")).then((function(e){var t=e.code,n=e.data;200===t&&N(n)}))}(t)):N(c.ZP.get("请选择日志文件")))},de=(0,l.useCallback)((function(e,t){fe(e[0],t.node)}),[]),ge=(0,l.useCallback)((function(e){var t=e.target.value;he(t)}),[Y]),he=(0,l.useCallback)(E()((function(e){ue(e)}),300),[Y]),pe=(0,F.Z)(Y,se,{treeNodeFilterProp:"title"}),me=pe.treeData,xe=pe.keys;(0,l.useEffect)((function(){ne(M()([].concat(r()(te),r()(xe))))}),[xe]);var ve=function(){A(""),oe(null),N(c.ZP.get("请选择脚本文件"))};return(0,l.useEffect)((function(){U(!0),b.W.get("".concat(v.Z.apiPrefix,"logs")).then((function(e){var t=e.code,n=e.data;200===t&&$(n)})).finally((function(){return U(!1)}))}),[]),(0,l.useEffect)((function(){V.current&&Q(V.current.clientHeight)}),[V.current,Y]),(0,_.jsx)(y.ZP,{className:"ql-container-wrapper log-wrapper",title:(0,_.jsxs)(_.Fragment,{children:[L,"file"===(null==ae?void 0:ae.type)&&(0,_.jsx)("span",{style:{marginLeft:6,fontSize:12,color:"#999",display:"inline-block",height:14},children:(0,D.Z)(ae.size)})]}),loading:R,extra:n?[(0,_.jsx)(d.Z,{treeExpandAction:"click",className:"log-select",value:L,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:Y,placeholder:c.ZP.get("请选择日志"),fieldNames:{value:"key"},treeNodeFilterProp:"title",showSearch:!0,allowClear:!0,onSelect:fe})]:[(0,_.jsx)(g.Z,{title:c.ZP.get("删除"),children:(0,_.jsx)(h.Z,{type:"primary",disabled:!L,onClick:function(){u.Z.confirm({title:"确认删除",content:(0,_.jsxs)(_.Fragment,{children:[c.ZP.get("确认删除"),(0,_.jsxs)(I,{style:{wordBreak:"break-all"},type:"warning",children:[" ",L," "]}),c.ZP.get("文件"),"directory"===ae.type?c.ZP.get("夹下所有日志"):"",c.ZP.get("，删除后不可恢复")]}),onOk:function(){b.W.delete("".concat(v.Z.apiPrefix,"logs"),{data:{filename:ae.title,path:ae.parent||"",type:ae.type}}).then((function(e){if(200===e.code){f.ZP.success("删除成功");var t=r()(Y);if(ae.parent)t=(0,B.I1)(t,(function(e){return e.key===ae.key}));else{var n=t.findIndex((function(e){return e.key===ae.key}));-1!==n&&t.splice(n,1)}$(t),ve()}}))},onCancel:function(){console.log("Cancel")}})},icon:(0,_.jsx)(w.Z,{})})})],header:{style:t},children:(0,_.jsxs)("div",{className:"".concat(P["log-container"]," log-container"),children:[!n&&(0,_.jsxs)(S.Z,{split:"vertical",size:200,maxSize:-100,children:[(0,_.jsx)("div",{className:P["left-tree-container"],children:Y.length>0?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(p.Z.Search,{className:P["left-tree-search"],onChange:ge,placeholder:c.ZP.get("请输入日志名"),allowClear:!0}),(0,_.jsx)("div",{className:P["left-tree-scroller"],ref:V,children:(0,_.jsx)(m.Z,{expandAction:"click",className:P["left-tree"],treeData:me,showIcon:!0,height:J,selectedKeys:[L],showLine:{showLeafIcon:!0},onSelect:de,expandedKeys:te,onExpand:function(e){ne(e)}})})]}):(0,_.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,_.jsx)(x.Z,{description:c.ZP.get("暂无日志"),image:x.Z.PRESENTED_IMAGE_SIMPLE})})}),(0,_.jsx)(Z.ZP,{language:"shell",theme:i,value:C,options:{readOnly:!0,fontSize:12,minimap:{enabled:!1},lineNumbersMinChars:3,folding:!1,glyphMargin:!1}})]}),n&&(0,_.jsx)(k.ZP,{value:C,readOnly:!0,theme:i.includes("dark")?"dark":"light",onChange:function(e,t){N(e)}})]})})}},45170:function(e,t,n){var i=n(13807);e.exports=function(e,t){return!!(null==e?0:e.length)&&i(e,t,0)>-1}},94936:function(e){e.exports=function(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1}},92504:function(e){e.exports=function(e,t,n,i){for(var r=e.length,a=n+(i?1:-1);i?a--:++a<r;)if(t(e[a],a,e))return a;return-1}},13807:function(e,t,n){var i=n(92504),r=n(99940),a=n(3729);e.exports=function(e,t,n){return t==t?a(e,t,n):i(e,r,n)}},99940:function(e){e.exports=function(e){return e!=e}},95453:function(e,t,n){var i=n(78188),r=n(45170),a=n(94936),o=n(29880),c=n(17319),l=n(79967);e.exports=function(e,t,n){var s=-1,u=r,f=e.length,d=!0,g=[],h=g;if(n)d=!1,u=a;else if(f>=200){var p=t?null:c(e);if(p)return l(p);d=!1,u=o,h=new i}else h=t?[]:g;e:for(;++s<f;){var m=e[s],x=t?t(m):m;if(m=n||0!==m?m:0,d&&x==x){for(var v=h.length;v--;)if(h[v]===x)continue e;t&&h.push(x),g.push(m)}else u(h,x,n)||(h!==g&&h.push(x),g.push(m))}return g}},17319:function(e,t,n){var i=n(81956),r=n(43226),a=n(79967),o=i&&1/a(new i([,-0]))[1]==1/0?function(e){return new i(e)}:r;e.exports=o},3729:function(e){e.exports=function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}},43226:function(e){e.exports=function(){}},4363:function(e,t,n){var i=n(95453);e.exports=function(e){return e&&e.length?i(e):[]}},79514:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});const i=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],r=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],a=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],o=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],c=(e,t,n)=>{let i=e;return"string"==typeof t||Array.isArray(t)?i=e.toLocaleString(t,n):!0!==t&&void 0===n||(i=e.toLocaleString(void 0,n)),i};function l(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const n=(t={bits:!1,binary:!1,space:!0,...t}).bits?t.binary?o:a:t.binary?r:i,l=t.space?" ":"";if(t.signed&&0===e)return` 0${l}${n[0]}`;const s=e<0,u=s?"-":t.signed?"+":"";let f;if(s&&(e=-e),void 0!==t.minimumFractionDigits&&(f={minimumFractionDigits:t.minimumFractionDigits}),void 0!==t.maximumFractionDigits&&(f={maximumFractionDigits:t.maximumFractionDigits,...f}),e<1){return u+c(e,t.locale,f)+l+n[0]}const d=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),n.length-1);e/=(t.binary?1024:1e3)**d,f||(e=e.toPrecision(3));return u+c(Number(e),t.locale,f)+l+n[d]}}}]);
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1074],{61934:function(ue,R,e){var F=e(45968),B=(0,F.Z)({scriptUrl:["//at.alicdn.com/t/c/font_3354854_z0d9rbri1ci.js"]});R.Z=B},22911:function(ue,R,e){e.r(R);var F=e(44463),B=e.n(F),X=e(35290),p=e.n(X),q=e(30279),s=e.n(q),ee=e(411),ne=e.n(ee),M=e(46686),z=e.n(M),I=e(63313),me=e.n(I),u=e(78455),D=e(77073),_e=e(97325),G=e(2991),te=e(74309),x=e(26591),S=e(76385),ae=e(7619),Y=e(35382),H=e(54064),re=e(61934),n=e(11527),le=["key","name"],oe=["key","name"],o=[{name:"\u547D\u4EE4",value:"command"},{name:"\u540D\u79F0",value:"name"},{name:"\u5B9A\u65F6\u89C4\u5219",value:"schedule"},{name:"\u72B6\u6001",value:"status"}],ie=[{name:"\u5305\u542B",value:"Reg"},{name:"\u4E0D\u5305\u542B",value:"NotReg"},{name:"\u5C5E\u4E8E",value:"In"},{name:"\u4E0D\u5C5E\u4E8E",value:"Nin"}],se=[{name:"\u987A\u5E8F",value:"ASC"},{name:"\u5012\u5E8F",value:"DESC"}],J=[{name:"\u8FD0\u884C\u4E2D",value:0},{name:"\u7A7A\u95F2\u4E2D",value:1},{name:"\u5DF2\u7981\u7528",value:2}],w;(function(V){V.and="\u4E14",V.or="\u6216"})(w||(w={}));var de=function(E){var m=E.view,y=E.handleCancel,A=E.visible,f=u.Z.useForm(),N=z()(f,1),P=N[0],T=(0,I.useState)(!1),g=z()(T,2),j=g[0],b=g[1],W=(0,I.useState)("and"),L=z()(W,2),C=L[0],k=L[1],U=function(){var i=ne()(p()().mark(function d(v){var r,_,t,l;return p()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return b(!0),v.filterRelation=C,r=m?"put":"post",a.prev=3,a.next=6,S.W[r]("".concat(ae.Z.apiPrefix,"crons/views"),{data:m?s()(s()({},v),{},{id:m.id}):v});case 6:_=a.sent,t=_.code,l=_.data,t===200&&y(l),b(!1),a.next=16;break;case 13:a.prev=13,a.t0=a.catch(3),b(!1);case 16:case"end":return a.stop()}},d,null,[[3,13]])}));return function(v){return i.apply(this,arguments)}}();(0,I.useEffect)(function(){m||P.resetFields(),P.setFieldsValue(m||{filters:[{property:"command",operation:"Reg"}]})},[m,A]);var K=(0,n.jsx)(D.Z,{style:{width:80},children:ie.map(function(i){return(0,n.jsx)(D.Z.Option,{value:i.value,children:i.name},i.name)})}),h=function(d){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,n.jsx)(D.Z,{style:v,children:d.map(function(r){return(0,n.jsx)(D.Z.Option,{value:r.value,children:r.name},r.name)})})},$=(0,n.jsx)(D.Z,{children:se.map(function(i){return(0,n.jsx)(D.Z.Option,{value:i.value,children:i.name},i.name)})}),Z=(0,n.jsx)(D.Z,{mode:"multiple",allowClear:!0,placeholder:"\u8BF7\u9009\u62E9\u72B6\u6001",children:J.map(function(i){return(0,n.jsx)(D.Z.Option,{value:i.value,children:i.name},i.name)})});return(0,n.jsx)(_e.Z,{title:m?"\u7F16\u8F91\u89C6\u56FE":"\u65B0\u5EFA\u89C6\u56FE",open:A,forceRender:!0,width:580,centered:!0,maskClosable:!1,onOk:function(){P.validateFields().then(function(d){U(d)}).catch(function(d){console.log("Validate Failed:",d)})},onCancel:function(){return y()},confirmLoading:j,children:(0,n.jsxs)(u.Z,{form:P,layout:"vertical",name:"env_modal",children:[(0,n.jsx)(u.Z.Item,{name:"name",label:"\u89C6\u56FE\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"}],children:(0,n.jsx)(G.Z,{placeholder:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"})}),(0,n.jsx)(u.Z.List,{name:"filters",children:function(d,v){var r=v.add,_=v.remove;return(0,n.jsxs)("div",{style:{position:"relative"},className:"view-filters-container ".concat(d.length>1?"active":""),children:[d.length>1&&(0,n.jsx)("div",{style:{position:"absolute",width:50,borderRadius:10,border:"1px solid rgb(190, 220, 255)",borderRight:"none",height:56*(d.length-1),top:46,left:15},children:(0,n.jsx)(te.Z,{type:"primary",size:"small",style:{position:"absolute",top:"50%",translate:"-50% -50%",padding:"0 0 0 3px",cursor:"pointer"},onClick:function(){k(C==="and"?"or":"and")},children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:w[C]}),(0,n.jsx)(re.Z,{type:"ql-icon-d-caret"})]})})}),(0,n.jsxs)("div",{children:[d.map(function(t,l){var c=t.key,a=t.name,O=B()(t,le);return(0,n.jsx)(u.Z.Item,{label:l===0?"\u7B5B\u9009\u6761\u4EF6":"",style:{marginBottom:0},required:!0,className:"filter-item",children:(0,n.jsxs)(x.Z,{className:"view-create-modal-filters",align:"baseline",style:d.length>1?{width:"calc(100% - 40px)"}:{},children:[(0,n.jsx)(u.Z.Item,s()(s()({},O),{},{name:[a,"property"],rules:[{required:!0}],children:h(o,{width:90})})),(0,n.jsx)(u.Z.Item,s()(s()({},O),{},{name:[a,"operation"],rules:[{required:!0}],children:K})),(0,n.jsx)(u.Z.Item,s()(s()({},O),{},{name:[a,"value"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9"}],children:["In","Nin"].includes(P.getFieldValue(["filters",l,"operation"]))?Z:(0,n.jsx)(G.Z,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"})})),l!==0&&(0,n.jsx)(Y.Z,{onClick:function(){return _(a)}})]})},c)}),(0,n.jsx)(u.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return r({property:"command",operation:"Reg"})},children:[(0,n.jsx)(H.Z,{}),"\u65B0\u589E\u7B5B\u9009\u6761\u4EF6"]})})]})]})}}),(0,n.jsx)(u.Z.List,{name:"sorts",children:function(d,v){var r=v.add,_=v.remove;return(0,n.jsxs)(n.Fragment,{children:[d.map(function(t,l){var c=t.key,a=t.name,O=B()(t,oe);return(0,n.jsx)(u.Z.Item,{label:l===0?"\u6392\u5E8F\u65B9\u5F0F":"",style:{marginBottom:0},children:(0,n.jsxs)(x.Z,{className:"view-create-modal-sorts",align:"baseline",children:[(0,n.jsx)(u.Z.Item,s()(s()({},O),{},{name:[a,"property"],rules:[{required:!0}],children:h(o,{width:240})})),(0,n.jsx)(u.Z.Item,s()(s()({},O),{},{name:[a,"type"],rules:[{required:!0}],children:$})),(0,n.jsx)(Y.Z,{onClick:function(){return _(a)}})]})},c)}),(0,n.jsx)(u.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return r({property:"command",type:"ASC"})},children:[(0,n.jsx)(H.Z,{}),"\u65B0\u589E\u6392\u5E8F\u65B9\u5F0F"]})})]})}})]})})};R.default=de},61074:function(ue,R,e){e.r(R);var F=e(94434),B=e.n(F),X=e(30279),p=e.n(X),q=e(46686),s=e.n(q),ee=e(44463),ne=e.n(ee),M=e(63313),z=e.n(M),I=e(6946),me=e(18254),u=e(26591),D=e(97325),_e=e(80743),G=e(74309),te=e(46669),x=e(76385),S=e(7619),ae=e(26099),Y=e(39449),H=e(40034),re=e(97920),n=e(21158),le=e(66255),oe=e(22911),o=e(11527),ie=["index","moveRow","className","style"],se=I.Z.Text,J="DragableBodyRow",w=function(E){var m=E.index,y=E.moveRow,A=E.className,f=E.style,N=ne()(E,ie),P=(0,M.useRef)(),T=(0,H.L)({accept:J,collect:function(h){var $=h.getItem()||{},Z=$.index;return Z===m?{}:{isOver:h.isOver(),dropClassName:Z<m?" drop-over-downward":" drop-over-upward"}},drop:function(h){y(h.index,m)}}),g=s()(T,2),j=g[0],b=j.isOver,W=j.dropClassName,L=g[1],C=(0,re.c)({type:J,item:{index:m},collect:function(h){return{isDragging:h.isDragging()}}}),k=s()(C,2),U=k[1];return L(U(P)),(0,o.jsx)("tr",p()({ref:P,className:"".concat(A).concat(b?W:""),style:p()({cursor:"move"},f)},N))},de=function(E){var m=E.cronViews,y=E.handleCancel,A=E.visible,f=E.cronViewChange,N=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",align:"center",render:function(_){return(0,o.jsx)("div",{style:{textAlign:"left",paddingLeft:30},children:_})}},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",align:"center",render:function(_){return _===1?"\u7CFB\u7EDF":"\u4E2A\u4EBA"}},{title:"\u663E\u793A",key:"isDisabled",dataIndex:"isDisabled",align:"center",width:100,render:function(_,t,l){return(0,o.jsx)(me.Z,{checked:!t.isDisabled,onChange:function(a){return i(a,t,l)}})}},{title:"\u64CD\u4F5C",key:"action",width:100,align:"center",render:function(_,t,l){return t.type!==1?(0,o.jsxs)(u.Z,{size:"middle",children:[(0,o.jsx)("a",{onClick:function(){return $(t,l)},children:(0,o.jsx)(ae.Z,{})}),(0,o.jsx)("a",{onClick:function(){return Z(t,l)},children:(0,o.jsx)(Y.Z,{})})]}):"-"}}],P=(0,M.useState)([]),T=s()(P,2),g=T[0],j=T[1],b=(0,M.useState)(!1),W=s()(b,2),L=W[0],C=W[1],k=(0,M.useState)(null),U=s()(k,2),K=U[0],h=U[1],$=function(_,t){h(_),C(!0)},Z=function(_,t){D.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,o.jsxs)(o.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u89C6\u56FE"," ",(0,o.jsx)(se,{style:{wordBreak:"break-all"},type:"warning",children:_.name})," ","\u5417"]}),onOk:function(){x.W.delete("".concat(S.Z.apiPrefix,"crons/views"),{data:[_.id]}).then(function(c){var a=c.code,O=c.data;a===200&&(_e.ZP.success("\u5220\u9664\u6210\u529F"),f())})},onCancel:function(){console.log("Cancel")}})},i=function(_,t,l){console.log(_),x.W.put("".concat(S.Z.apiPrefix,"crons/views/").concat(_?"enable":"disable"),{data:[t.id]}).then(function(c){var a=c.code,O=c.data;if(a===200){var Q=B()(g);Q.splice(l,1,p()(p()({},g[l]),{},{isDisabled:!_})),j(Q),f()}})},d={body:{row:w}},v=(0,M.useCallback)(function(r,_){if(r!==_){var t=g[r];x.W.put("".concat(S.Z.apiPrefix,"crons/views/move"),{data:{fromIndex:r,toIndex:_,id:t.id}}).then(function(l){var c=l.code,a=l.data;if(c===200){var O=B()(g);O.splice(r,1),O.splice(_,0,p()(p()({},t),a)),j(O),f()}})}},[g]);return(0,M.useEffect)(function(){j(m)},[m]),(0,o.jsxs)(D.Z,{title:"\u89C6\u56FE\u7BA1\u7406",open:A,centered:!0,width:620,onCancel:function(){return y()},className:"view-manage-modal",forceRender:!0,footer:!1,maskClosable:!1,children:[(0,o.jsx)(u.Z,{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:(0,o.jsx)(G.Z,{type:"primary",onClick:function(){h(null),C(!0)},children:"\u65B0\u5EFA\u89C6\u56FE"},"2")}),(0,o.jsx)(n.W,{backend:le.PD,children:(0,o.jsx)(te.Z,{bordered:!0,columns:N,pagination:!1,dataSource:g,rowKey:"id",size:"middle",style:{marginBottom:20},components:d,onRow:function(_,t){return{index:t,moveRow:v}}})}),(0,o.jsx)(oe.default,{view:K,visible:L,handleCancel:function(_){C(!1),f(_)}})]})};R.default=de}}]);

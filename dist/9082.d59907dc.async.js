(self.webpackChunk=self.webpackChunk||[]).push([[9082],{69082:function($,S,n){"use strict";n.r(S);var q=n(25359),A=n.n(q),ee=n(57213),P=n.n(ee),H=n(49811),ue=n.n(H),ne=n(54306),s=n.n(ne),E=n(63313),ae=n.n(E),U=n(57179),l=n(91692),le=n(32049),c=n(38626),te=n(43274),re=n(24550),D=n(59720),N=n(16672),oe=n(96786),a=n(45277),j=n(73183),_=n.n(j),h=n(46207),C=n.n(h),e=n(11527),f=U.Z.Option,b=/([^\/\:]+\/[^\/]+)(?=\.git)/,O=/([^\/\:]+\/[^\/\.]+)\.[a-z]+$/,k=function(y){var o=y.subscription,Z=y.handleCancel,g=y.visible,V=l.Z.useForm(),x=s()(V,1),i=x[0],B=(0,E.useState)(!1),J=s()(B,2),z=J[0],G=J[1],se=(0,E.useState)("public-repo"),Q=s()(se,2),v=Q[0],T=Q[1],R=(0,E.useState)("crontab"),he=s()(R,2),ie=he[0],ve=he[1],pe=(0,E.useState)("ssh-key"),_e=s()(pe,2),Fe=_e[0],Ce=_e[1],De=function(){var d=ue()(A()().mark(function u(t){var r,p,F,I,M;return A()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return G(!0),r=o?"put":"post",p=P()(P()({},t),{},{autoAddCron:Boolean(t.autoAddCron),autoDelCron:Boolean(t.autoDelCron)}),o&&(p.id=o.id),m.prev=4,m.next=7,oe.W[r]("".concat(a.Z.apiPrefix,"subscriptions"),{data:p});case 7:F=m.sent,I=F.code,M=F.data,I===200&&(le.ZP.success(o?"\u66F4\u65B0\u8BA2\u9605\u6210\u529F":"\u65B0\u5EFA\u8BA2\u9605\u6210\u529F"),Z(M)),G(!1),m.next=17;break;case 14:m.prev=14,m.t0=m.catch(4),G(!1);case 17:case"end":return m.stop()}},u,null,[[4,14]])}));return function(t){return d.apply(this,arguments)}}(),fe=function(u){T(u.target.value);var t=i.getFieldValue("url"),r=i.getFieldValue("branch");i.setFieldsValue({alias:X(t,r,u.target.value)}),t&&i.validateFields(["url"])},ge=function(u){ve(u.target.value),i.setFieldsValue({schedule:""})},xe=function(u){Ce(u.target.value)},me=function(u){var t=i.getFieldValue("branch");i.setFieldsValue({alias:X(u.target.value,t)})},Ee=function(u){var t=i.getFieldValue("url");i.setFieldsValue({alias:X(t,u.target.value)})},X=function(u,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:v,p="",F=r==="file"?O:b;return F.test(u)&&(p=u.match(F)[1].replaceAll("/","_").replaceAll(".","_")),t&&(p=p+"_"+t),p},Be=function(u){var t=u.value,r=u.onChange,p=(0,E.useState)("days"),F=s()(p,2),I=F[0],M=F[1],Y=(0,E.useState)(),m=s()(Y,2),K=m[0],L=m[1],ce=function(W){M(W),K&&K>0&&(r==null||r({type:W,value:K}))},Oe=function(W){L(W||1),W?r==null||r({type:I,value:W}):r==null||r(null)};return(0,E.useEffect)(function(){t&&(M(t.type),L(t.value))},[t]),(0,e.jsxs)(c.Z.Group,{compact:!0,children:[(0,e.jsx)(te.Z,{addonBefore:"\u6BCF",precision:0,min:1,value:K,style:{width:"calc(100% - 58px)"},onChange:Oe}),(0,e.jsxs)(U.Z,{value:I,onChange:ce,children:[(0,e.jsx)(f,{value:"days",children:"\u5929"}),(0,e.jsx)(f,{value:"hours",children:"\u65F6"}),(0,e.jsx)(f,{value:"minutes",children:"\u5206"}),(0,e.jsx)(f,{value:"seconds",children:"\u79D2"})]})]})},Ae=function(u){var t=u.value,r=u.onChange,p=u.type;return p==="ssh-key"?(0,e.jsx)(l.Z.Item,{name:["pull_option","private_key"],label:"\u79C1\u94A5",rules:[{required:!0}],children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:{minRows:1,maxRows:6},placeholder:"\u8BF7\u8F93\u5165\u79C1\u94A5"})}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.Z.Item,{name:["pull_option","username"],label:"\u7528\u6237\u540D",rules:[{required:!0}],children:(0,e.jsx)(c.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BA4\u8BC1\u7528\u6237\u540D"})}),(0,e.jsx)(l.Z.Item,{name:["pull_option","password"],tooltip:"Github\u5DF2\u4E0D\u652F\u6301\u5BC6\u7801\u8BA4\u8BC1\uFF0C\u8BF7\u4F7F\u7528Token\u65B9\u5F0F",label:"\u5BC6\u7801/Token",rules:[{required:!0}],children:(0,e.jsx)(c.Z,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801\u6216\u8005Token"})})]})},de=(0,E.useCallback)(function(d){var u=d.clipboardData.getData("text");if(u.startsWith("ql ")){var t=u.split(" ").map(function(ce){return ce.trim().replace(/\"/g,"").replace(/\'/,"")}),r=s()(t,8),p=r[1],F=r[2],I=r[3],M=r[4],Y=r[5],m=r[6],K=r[7],L=p==="raw"?"file":F.startsWith("http")?"public-repo":"private-repo";i.setFieldsValue({type:L,url:F,whitelist:I,blacklist:M,dependences:Y,branch:m,extensions:K,alias:X(F,m,L)}),T(L)}},[]),Pe=(0,E.useCallback)(function(d){var u=d.clipboardData.getData("text");u.startsWith("ql ")&&d.preventDefault(),de(d)},[]),je=function(u){return P()(P()({},u),{},{autoAddCron:C()(u==null?void 0:u.autoAddCron)?!0:Boolean(u==null?void 0:u.autoAddCron),autoDelCron:C()(u==null?void 0:u.autoDelCron)?!0:Boolean(u==null?void 0:u.autoDelCron)})};return(0,E.useEffect)(function(){g?window.addEventListener("paste",de):window.removeEventListener("paste",de)},[g]),(0,E.useEffect)(function(){i.setFieldsValue(P()(P()({},o),je(o))||{}),T(o&&o.type||"public-repo"),ve(o&&o.schedule_type||"crontab"),Ce(o&&o.pull_type||"ssh-key"),o||i.resetFields()},[o,g]),(0,e.jsx)(re.Z,{title:o?"\u7F16\u8F91\u8BA2\u9605":"\u65B0\u5EFA\u8BA2\u9605",open:g,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){i.validateFields().then(function(u){De(u)}).catch(function(u){console.log("Validate Failed:",u)})},onCancel:function(){return Z()},confirmLoading:z,children:(0,e.jsxs)(l.Z,{form:i,name:"form_in_modal",layout:"vertical",children:[(0,e.jsx)(l.Z.Item,{name:"name",label:"\u540D\u79F0",rules:[{required:!0}],children:(0,e.jsx)(c.Z,{placeholder:"\u652F\u6301\u62F7\u8D1D ql repo/raw \u547D\u4EE4\uFF0C\u7C98\u8D34\u5BFC\u5165",onPaste:Pe})}),(0,e.jsx)(l.Z.Item,{name:"type",label:"\u7C7B\u578B",rules:[{required:!0}],initialValue:"public-repo",children:(0,e.jsxs)(D.ZP.Group,{onChange:fe,children:[(0,e.jsx)(D.ZP,{value:"public-repo",children:"\u516C\u5F00\u4ED3\u5E93"}),(0,e.jsx)(D.ZP,{value:"private-repo",children:"\u79C1\u6709\u4ED3\u5E93"}),(0,e.jsx)(D.ZP,{value:"file",children:"\u5355\u6587\u4EF6"})]})}),(0,e.jsx)(l.Z.Item,{name:"url",label:"\u94FE\u63A5",rules:[{required:!0},{pattern:v==="file"?O:b}],children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605\u94FE\u63A5",onPaste:me,onChange:me})}),v!=="file"&&(0,e.jsx)(l.Z.Item,{name:"branch",label:"\u5206\u652F",children:(0,e.jsx)(c.Z,{placeholder:"\u8BF7\u8F93\u5165\u5206\u652F",onPaste:Ee,onChange:Ee})}),(0,e.jsx)(l.Z.Item,{name:"alias",label:"\u552F\u4E00\u503C",rules:[{required:!0,message:""}],tooltip:"\u552F\u4E00\u503C\u7528\u4E8E\u65E5\u5FD7\u76EE\u5F55\u548C\u79C1\u94A5\u522B\u540D",children:(0,e.jsx)(c.Z,{placeholder:"\u81EA\u52A8\u751F\u6210",disabled:!0})}),v==="private-repo"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.Z.Item,{name:"pull_type",label:"\u62C9\u53D6\u65B9\u5F0F",initialValue:"ssh-key",rules:[{required:!0}],children:(0,e.jsxs)(D.ZP.Group,{onChange:xe,children:[(0,e.jsx)(D.ZP,{value:"ssh-key",children:"\u79C1\u94A5"}),(0,e.jsx)(D.ZP,{value:"user-pwd",children:"\u7528\u6237\u540D\u5BC6\u7801/Token"})]})}),(0,e.jsx)(Ae,{type:Fe})]}),(0,e.jsx)(l.Z.Item,{name:"schedule_type",label:"\u5B9A\u65F6\u7C7B\u578B",initialValue:"crontab",rules:[{required:!0}],children:(0,e.jsxs)(D.ZP.Group,{onChange:ge,children:[(0,e.jsx)(D.ZP,{value:"crontab",children:"crontab"}),(0,e.jsx)(D.ZP,{value:"interval",children:"interval"})]})}),(0,e.jsx)(l.Z.Item,{name:ie==="crontab"?"schedule":"interval_schedule",label:"\u5B9A\u65F6\u89C4\u5219",rules:[{required:!0},{validator:function(u,t){return ie==="interval"||!t||_().parseExpression(t).hasNext()?Promise.resolve():Promise.reject("Subscription\u8868\u8FBE\u5F0F\u683C\u5F0F\u6709\u8BEF")}}],children:ie==="interval"?(0,e.jsx)(Be,{}):(0,e.jsx)(c.Z,{placeholder:"\u79D2(\u53EF\u9009) \u5206 \u65F6 \u5929 \u6708 \u5468"})}),v!=="file"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(l.Z.Item,{name:"whitelist",label:"\u767D\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u767D\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,e.jsx)(l.Z.Item,{name:"blacklist",label:"\u9ED1\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u9ED1\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,e.jsx)(l.Z.Item,{name:"dependences",label:"\u4F9D\u8D56\u6587\u4EF6",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u4F9D\u8D56\u6587\u4EF6\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,e.jsx)(l.Z.Item,{name:"extensions",label:"\u6587\u4EF6\u540E\u7F00",tooltip:"\u4ED3\u5E93\u9700\u8981\u62C9\u53D6\u7684\u6587\u4EF6\u540E\u7F00\uFF0C\u591A\u4E2A\u540E\u7F00\u7A7A\u683C\u5206\u9694\uFF0C\u9ED8\u8BA4\u4F7F\u7528\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684RepoFileExtensions",children:(0,e.jsx)(c.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540E\u7F00"})}),(0,e.jsx)(l.Z.Item,{name:"sub_before",label:"\u6267\u884C\u524D",tooltip:"\u8FD0\u884C\u8BA2\u9605\u524D\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u524D\u8981\u6267\u884C\u7684\u547D\u4EE4"})}),(0,e.jsx)(l.Z.Item,{name:"sub_after",label:"\u6267\u884C\u540E",tooltip:"\u8FD0\u884C\u8BA2\u9605\u540E\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,e.jsx)(c.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u540E\u8981\u6267\u884C\u7684\u547D\u4EE4"})})]}),(0,e.jsx)(l.Z.Item,{name:"proxy",label:"\u4EE3\u7406",tooltip:"\u516C\u5F00\u4ED3\u5E93\u652F\u6301HTTP/SOCK5\u4EE3\u7406\uFF0C\u79C1\u6709\u4ED3\u5E93\u652F\u6301SOCK5\u4EE3\u7406",children:(0,e.jsx)(c.Z,{placeholder:v==="private-repo"?"SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 IP:PORT":"HTTP/SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 http://127.0.0.1:1080"})}),(0,e.jsxs)(l.Z.Item,{style:{marginBottom:0},className:"inline-form-item",children:[(0,e.jsx)(l.Z.Item,{name:"autoAddCron",label:"\u81EA\u52A8\u6DFB\u52A0\u4EFB\u52A1",valuePropName:"checked",initialValue:!0,children:(0,e.jsx)(N.Z,{})}),(0,e.jsx)(l.Z.Item,{name:"autoDelCron",label:"\u81EA\u52A8\u5220\u9664\u4EFB\u52A1",valuePropName:"checked",initialValue:!0,children:(0,e.jsx)(N.Z,{})})]})]})})};S.default=k},16672:function($,S,n){"use strict";n.d(S,{Z:function(){return oe}});var q=n(51163),A=n(24572),ee=n(39882),P=n(84875),H=n.n(P),ue=n(91600),ne=n(58733),s=n(63313),E=n(28780),ae=n(58236),U=s.forwardRef(function(a,j){var _,h=a.prefixCls,C=h===void 0?"rc-switch":h,e=a.className,f=a.checked,b=a.defaultChecked,O=a.disabled,k=a.loadingIcon,w=a.checkedChildren,y=a.unCheckedChildren,o=a.onClick,Z=a.onChange,g=a.onKeyDown,V=(0,ne.Z)(a,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),x=(0,E.Z)(!1,{value:f,defaultValue:b}),i=(0,ue.Z)(x,2),B=i[0],J=i[1];function z(v,T){var R=B;return O||(R=v,J(R),Z==null||Z(R,T)),R}function G(v){v.which===ae.Z.LEFT?z(!1,v):v.which===ae.Z.RIGHT&&z(!0,v),g==null||g(v)}function se(v){var T=z(!B,v);o==null||o(T,v)}var Q=H()(C,e,(_={},(0,A.Z)(_,"".concat(C,"-checked"),B),(0,A.Z)(_,"".concat(C,"-disabled"),O),_));return s.createElement("button",Object.assign({},V,{type:"button",role:"switch","aria-checked":B,disabled:O,className:Q,ref:j,onKeyDown:G,onClick:se}),k,s.createElement("span",{className:"".concat(C,"-inner")},B?w:y))});U.displayName="Switch";var l=U,le=n(56220),c=n(40987),te=n(75654),re=n(1927),D=function(a,j){var _={};for(var h in a)Object.prototype.hasOwnProperty.call(a,h)&&j.indexOf(h)<0&&(_[h]=a[h]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var C=0,h=Object.getOwnPropertySymbols(a);C<h.length;C++)j.indexOf(h[C])<0&&Object.prototype.propertyIsEnumerable.call(a,h[C])&&(_[h[C]]=a[h[C]]);return _},N=s.forwardRef(function(a,j){var _,h=a.prefixCls,C=a.size,e=a.disabled,f=a.loading,b=a.className,O=b===void 0?"":b,k=D(a,["prefixCls","size","disabled","loading","className"]),w=s.useContext(le.E_),y=w.getPrefixCls,o=w.direction,Z=s.useContext(te.Z),g=s.useContext(c.Z),V=(e!=null?e:g)||f,x=y("switch",h),i=s.createElement("div",{className:"".concat(x,"-handle")},f&&s.createElement(ee.Z,{className:"".concat(x,"-loading-icon")})),B=H()((_={},(0,A.Z)(_,"".concat(x,"-small"),(C||Z)==="small"),(0,A.Z)(_,"".concat(x,"-loading"),f),(0,A.Z)(_,"".concat(x,"-rtl"),o==="rtl"),_),O);return s.createElement(re.Z,{insertExtraNode:!0},s.createElement(l,(0,q.Z)({},k,{prefixCls:x,className:B,disabled:V,ref:j,loadingIcon:i})))});N.__ANT_SWITCH=!0;var oe=N},46207:function($){function S(n){return n==null}$.exports=S}}]);

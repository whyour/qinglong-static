"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8447],{89332:function(ue,B,e){var Z=e(55258),x=(0,Z.Z)({scriptUrl:["//at.alicdn.com/t/c/font_3354854_ob5y15ewlyq.js"]});B.Z=x},89905:function(ue,B,e){e.r(B);var Z=e(12342),x=e.n(Z),J=e(25359),M=e.n(J),Q=e(57213),d=e.n(Q),X=e(49811),q=e.n(X),C=e(54306),k=e.n(C),I=e(63313),me=e.n(I),u=e(67393),v=e(28756),ee=e(84163),$=e(22159),z=e(24378),T=e(2947),F=e(96787),ne=e(61858),G=e(32320),Y=e(26839),te=e(89332),n=e(11527),_e=["key","name"],ae=["key","name"],i=[{name:"\u547D\u4EE4",value:"command"},{name:"\u540D\u79F0",value:"name"},{name:"\u5B9A\u65F6\u89C4\u5219",value:"schedule"},{name:"\u72B6\u6001",value:"status"},{name:"\u6807\u7B7E",value:"labels"}],oe={Reg:"",NotReg:"",In:"select",Nin:"select"},re=[{name:"\u5305\u542B",value:"Reg"},{name:"\u4E0D\u5305\u542B",value:"NotReg"},{name:"\u5C5E\u4E8E",value:"In",type:"select"},{name:"\u4E0D\u5C5E\u4E8E",value:"Nin",type:"select"}],H=[{name:"\u987A\u5E8F",value:"ASC"},{name:"\u5012\u5E8F",value:"DESC"}],le={status:[{name:"\u8FD0\u884C\u4E2D",value:0},{name:"\u7A7A\u95F2\u4E2D",value:1},{name:"\u5DF2\u7981\u7528",value:2}]},W;(function(c){c.and="\u4E14",c.or="\u6216"})(W||(W={}));var se=function(h){var g=h.view,L=h.handleCancel,f=h.visible,S=u.Z.useForm(),U=k()(S,1),P=U[0],p=(0,I.useState)(!1),j=k()(p,2),w=j[0],R=j[1],V=(0,I.useState)("and"),b=k()(V,2),y=b[0],K=b[1],O=u.Z.useWatch("filters",P),D=function(){var m=q()(M()().mark(function t(_){var a,r,o,E;return M()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return R(!0),_.filterRelation=y,a=g?"put":"post",s.prev=3,s.next=6,F.W[a]("".concat(ne.Z.apiPrefix,"crons/views"),{data:g?d()(d()({},_),{},{id:g.id}):_});case 6:r=s.sent,o=r.code,E=r.data,o===200&&L(E),R(!1),s.next=16;break;case 13:s.prev=13,s.t0=s.catch(3),R(!1);case 16:case"end":return s.stop()}},t,null,[[3,13]])}));return function(_){return m.apply(this,arguments)}}();(0,I.useEffect)(function(){g||P.resetFields(),P.setFieldsValue(g||{filters:[{property:"command",operation:"Reg"}]})},[g,f]);var N=(0,n.jsx)(v.Z,{style:{width:80},children:re.map(function(m){return(0,n.jsx)(v.Z.Option,{value:m.value,children:m.name},m.name)})}),A=function(t){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,n.jsx)(v.Z,{style:_,children:t.map(function(a){return(0,n.jsx)(v.Z.Option,{value:a.value,children:a.name},a.name)})})},ie=(0,n.jsx)(v.Z,{style:{width:80},children:H.map(function(m){return(0,n.jsx)(v.Z.Option,{value:m.value,children:m.name},m.name)})}),de=function(t){var _;return(0,n.jsx)(v.Z,{mode:"tags",allowClear:!0,placeholder:"\u8F93\u5165\u540E\u56DE\u8F66\u589E\u52A0\u81EA\u5B9A\u4E49\u9009\u9879",children:(_=le[t])===null||_===void 0?void 0:_.map(function(a){return(0,n.jsx)(v.Z.Option,{value:a.value,children:a.name},a.name)})})};return(0,n.jsx)(ee.Z,{title:g?"\u7F16\u8F91\u89C6\u56FE":"\u65B0\u5EFA\u89C6\u56FE",open:f,forceRender:!0,width:580,centered:!0,maskClosable:!1,onOk:function(){P.validateFields().then(function(t){D(t)}).catch(function(t){console.log("Validate Failed:",t)})},onCancel:function(){return L()},confirmLoading:w,children:(0,n.jsxs)(u.Z,{form:P,layout:"vertical",name:"env_modal",children:[(0,n.jsx)(u.Z.Item,{name:"name",label:"\u89C6\u56FE\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"}],children:(0,n.jsx)($.Z,{placeholder:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"})}),(0,n.jsx)(u.Z.List,{name:"filters",children:function(t,_){var a=_.add,r=_.remove;return(0,n.jsxs)("div",{style:{position:"relative"},className:"view-filters-container ".concat(t.length>1?"active":""),children:[t.length>1&&(0,n.jsx)("div",{style:{position:"absolute",width:50,borderRadius:10,border:"1px solid rgb(190, 220, 255)",borderRight:"none",height:56*(t.length-1),top:46,left:15},children:(0,n.jsx)(z.Z,{type:"primary",size:"small",style:{position:"absolute",top:"50%",translate:"-50% -50%",padding:"0 3px",cursor:"pointer"},onClick:function(){K(y==="and"?"or":"and")},children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:W[y]}),(0,n.jsx)(te.Z,{type:"ql-icon-d-caret"})]})})}),(0,n.jsxs)("div",{children:[t.map(function(o){var E=o.key,l=o.name,s=x()(o,_e);return(0,n.jsx)(u.Z.Item,{label:l===0?"\u7B5B\u9009\u6761\u4EF6":"",style:{marginBottom:0},required:!0,className:"filter-item",children:(0,n.jsxs)(T.Z,{className:"view-create-modal-filters",align:"baseline",children:[(0,n.jsx)(u.Z.Item,d()(d()({},s),{},{name:[l,"property"],rules:[{required:!0}],children:A(i,{width:90})})),(0,n.jsx)(u.Z.Item,d()(d()({},s),{},{name:[l,"operation"],rules:[{required:!0}],children:N})),(0,n.jsx)(u.Z.Item,d()(d()({},s),{},{name:[l,"value"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9"}],children:oe[O==null?void 0:O[l].operation]==="select"?de(O==null?void 0:O[l].property):(0,n.jsx)($.Z,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"})})),l!==0&&(0,n.jsx)(G.Z,{onClick:function(){return r(l)}})]})},E)}),(0,n.jsx)(u.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return a({property:"command",operation:"Reg"})},children:[(0,n.jsx)(Y.Z,{}),"\u65B0\u589E\u7B5B\u9009\u6761\u4EF6"]})})]})]})}}),(0,n.jsx)(u.Z.List,{name:"sorts",children:function(t,_){var a=_.add,r=_.remove;return(0,n.jsxs)("div",{style:{position:"relative"},className:"view-filters-container ".concat(t.length>1?"active":""),children:[t.length>1&&(0,n.jsx)("div",{style:{position:"absolute",width:50,borderRadius:10,border:"1px solid rgb(190, 220, 255)",borderRight:"none",height:56*(t.length-1),top:46,left:15},children:(0,n.jsx)(z.Z,{type:"primary",size:"small",style:{position:"absolute",top:"50%",translate:"-50% -50%",padding:"0 3px",cursor:"pointer"},children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("span",{children:W[y]})})})}),(0,n.jsxs)("div",{children:[t.map(function(o){var E=o.key,l=o.name,s=x()(o,ae);return(0,n.jsx)(u.Z.Item,{label:l===0?"\u6392\u5E8F\u65B9\u5F0F":"",style:{marginBottom:0},className:"filter-item",children:(0,n.jsxs)(T.Z,{className:"view-create-modal-sorts",align:"baseline",children:[(0,n.jsx)(u.Z.Item,d()(d()({},s),{},{name:[l,"property"],rules:[{required:!0}],children:A(i)})),(0,n.jsx)(u.Z.Item,d()(d()({},s),{},{name:[l,"type"],rules:[{required:!0}],children:ie})),(0,n.jsx)(G.Z,{onClick:function(){return r(l)}})]})},E)}),(0,n.jsx)(u.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return a({property:"command",type:"ASC"})},children:[(0,n.jsx)(Y.Z,{}),"\u65B0\u589E\u6392\u5E8F\u65B9\u5F0F"]})})]})]})}})]})})};B.default=se},8447:function(ue,B,e){e.r(B);var Z=e(93525),x=e.n(Z),J=e(57213),M=e.n(J),Q=e(54306),d=e.n(Q),X=e(12342),q=e.n(X),C=e(63313),k=e.n(C),I=e(92260),me=e(16861),u=e(2947),v=e(84163),ee=e(9835),$=e(24378),z=e(60986),T=e(96787),F=e(61858),ne=e(32132),G=e(13740),Y=e(75742),te=e(22638),n=e(22587),_e=e(66255),ae=e(89905),i=e(11527),oe=["index","moveRow","className","style"],re=I.Z.Text,H="DragableBodyRow",le=function(c){var h=c.index,g=c.moveRow,L=c.className,f=c.style,S=q()(c,oe),U=(0,C.useRef)(),P=(0,Y.L)({accept:H,collect:function(D){var N=D.getItem()||{},A=N.index;return A===h?{}:{isOver:D.isOver(),dropClassName:A<h?" drop-over-downward":" drop-over-upward"}},drop:function(D){g(D.index,h)}}),p=d()(P,2),j=p[0],w=j.isOver,R=j.dropClassName,V=p[1],b=(0,te.c)({type:H,item:{index:h},collect:function(D){return{isDragging:D.isDragging()}}}),y=d()(b,2),K=y[1];return V(K(U)),(0,i.jsx)("tr",M()({ref:U,className:"".concat(L).concat(w?R:""),style:M()({cursor:"move"},f)},S))},W=function(c){var h=c.cronViews,g=c.handleCancel,L=c.visible,f=c.cronViewChange,S=[{title:"\u540D\u79F0",dataIndex:"name",key:"name"},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",render:function(_){return _===1?"\u7CFB\u7EDF":"\u4E2A\u4EBA"}},{title:"\u663E\u793A",key:"isDisabled",dataIndex:"isDisabled",width:100,render:function(_,a,r){return(0,i.jsx)(me.Z,{checked:!a.isDisabled,onChange:function(E){return ie(E,a,r)}})}},{title:"\u64CD\u4F5C",key:"action",width:100,render:function(_,a,r){return a.type!==1?(0,i.jsxs)(u.Z,{size:"middle",children:[(0,i.jsx)("a",{onClick:function(){return N(a,r)},children:(0,i.jsx)(ne.Z,{})}),(0,i.jsx)("a",{onClick:function(){return A(a,r)},children:(0,i.jsx)(G.Z,{})})]}):"-"}}],U=(0,C.useState)([]),P=d()(U,2),p=P[0],j=P[1],w=(0,C.useState)(!1),R=d()(w,2),V=R[0],b=R[1],y=(0,C.useState)(null),K=d()(y,2),O=K[0],D=K[1],N=function(_,a){D(_),b(!0)},A=function(_,a){v.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,i.jsxs)(i.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u89C6\u56FE"," ",(0,i.jsx)(re,{style:{wordBreak:"break-all"},type:"warning",children:_.name})," ","\u5417"]}),onOk:function(){T.W.delete("".concat(F.Z.apiPrefix,"crons/views"),{data:[_.id]}).then(function(o){var E=o.code,l=o.data;E===200&&(ee.ZP.success("\u5220\u9664\u6210\u529F"),f())})},onCancel:function(){console.log("Cancel")}})},ie=function(_,a,r){T.W.put("".concat(F.Z.apiPrefix,"crons/views/").concat(_?"enable":"disable"),{data:[a.id]}).then(function(o){var E=o.code,l=o.data;if(E===200){var s=x()(p);s.splice(r,1,M()(M()({},p[r]),{},{isDisabled:!_})),j(s),f()}})},de={body:{row:le}},m=(0,C.useCallback)(function(t,_){if(t!==_){var a=p[t];T.W.put("".concat(F.Z.apiPrefix,"crons/views/move"),{data:{fromIndex:t,toIndex:_,id:a.id}}).then(function(r){var o=r.code,E=r.data;if(o===200){var l=x()(p);l.splice(t,1),l.splice(_,0,M()(M()({},a),E)),j(l),f()}})}},[p]);return(0,C.useEffect)(function(){j(h)},[h]),(0,i.jsxs)(v.Z,{title:"\u89C6\u56FE\u7BA1\u7406",open:L,centered:!0,width:620,onCancel:function(){return g()},className:"view-manage-modal",forceRender:!0,footer:!1,maskClosable:!1,children:[(0,i.jsx)(u.Z,{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:(0,i.jsx)($.Z,{type:"primary",onClick:function(){D(null),b(!0)},children:"\u65B0\u5EFA\u89C6\u56FE"},"2")}),(0,i.jsx)(n.W,{backend:_e.PD,children:(0,i.jsx)(z.Z,{bordered:!0,columns:S,pagination:!1,dataSource:p,rowKey:"id",size:"middle",style:{marginBottom:20},components:de,onRow:function(_,a){return{index:a,moveRow:m}}})}),(0,i.jsx)(ae.default,{view:O,visible:V,handleCancel:function(_){b(!1),f(_)}})]})};B.default=W}}]);

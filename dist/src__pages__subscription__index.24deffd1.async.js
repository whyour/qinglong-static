(self.webpackChunk=self.webpackChunk||[]).push([[7953,578],{56996:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},h=o,F=e(17536),l=function(c,D){return r.createElement(F.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:D,icon:h}))};l.displayName="ClockCircleOutlined";var s=r.forwardRef(l)},5962:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},h=o,F=e(17536),l=function(c,D){return r.createElement(F.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:D,icon:h}))};l.displayName="DeleteOutlined";var s=r.forwardRef(l)},62198:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},h=o,F=e(17536),l=function(c,D){return r.createElement(F.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:D,icon:h}))};l.displayName="FileTextOutlined";var s=r.forwardRef(l)},35316:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"}}]},name:"loading-3-quarters",theme:"outlined"},h=o,F=e(17536),l=function(c,D){return r.createElement(F.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:D,icon:h}))};l.displayName="Loading3QuartersOutlined";var s=r.forwardRef(l)},22932:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},h=o,F=e(17536),l=function(c,D){return r.createElement(F.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:D,icon:h}))};l.displayName="PauseCircleOutlined";var s=r.forwardRef(l)},66260:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},h=o,F=e(17536),l=function(c,D){return r.createElement(F.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:D,icon:h}))};l.displayName="PlayCircleOutlined";var s=r.forwardRef(l)},85451:function(v,f,e){"use strict";e.d(f,{Z:function(){return s}});var d=e(56453),r=e(63313),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},h=o,F=e(17536),l=function(c,D){return r.createElement(F.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:D,icon:h}))};l.displayName="StopOutlined";var s=r.forwardRef(l)},46586:function(v,f,e){"use strict";var d=e(46686),r=e.n(d),o=e(63313),h=e.n(o),F=e(61761),l=e(79418);f.Z=function(s,S){var c=(0,o.useState)(),D=r()(c,2),$=D[0],p=D[1];return(0,F.Z)(s,function(y){var x=y.target;x.classList.contains("ant-table-wrapper")||(x=y.target.querySelector(".ant-table-wrapper")),p((0,l.W9)({extraHeight:S,target:x}))}),$}},31713:function(v,f,e){"use strict";e.r(f),e.d(f,{IntervalSchedule:function(){return Z},SubscriptionStatus:function(){return T},SubscriptionType:function(){return H},default:function(){return pe}});var d=e(94434),r=e.n(d),o=e(46686),h=e.n(o),F=e(30279),l=e.n(F),s=e(63313),S=e(87670),c=e(30314),D=e(96384),$=e(65646),p=e(61135),y=e(4352),x=e(63533),Pe=e(22999),Q=e(59225),A=e(61685),ge=e(56996),te=e(35316),ne=e(74761),se=e(66260),t=e(22932),G=e(62198),de=e(97947),ue=e(9734),Ce=e(85451),xe=e(5962),J=e(59140),O=e(27382),ce=e(13055),U=e(74083),ve=e(14096),_e=e(69500),j=e(76368),fe=e(46586),a=e(11527),q=S.Z.Text,ae=S.Z.Paragraph,le=c.Z.Search,T;(function(_){_[_.running=0]="running",_[_.idle=1]="idle",_[_.disabled=2]="disabled",_[_.queued=3]="queued"})(T||(T={}));var Z;(function(_){_.days="\u5929",_.hours="\u65F6",_.minutes="\u5206",_.seconds="\u79D2"})(Z||(Z={}));var H;(function(_){_["private-repo"]="\u79C1\u6709\u4ED3\u5E93",_["public-repo"]="\u516C\u5F00\u4ED3\u5E93",_.file="\u5355\u6587\u4EF6"})(H||(H={}));var he=function(){var K=(0,_e.bx)(),Ze=K.headerStyle,Fe=K.isPhone,re=K.socketMessage,Se=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",width:150,align:"center",sorter:{compare:function(n,u){return n.name.localeCompare(u.name)},multiple:2}},{title:"\u94FE\u63A5",dataIndex:"url",key:"url",align:"center",sorter:{compare:function(n,u){return n.name.localeCompare(u.name)},multiple:2},render:function(n,u){return(0,a.jsx)(ae,{style:{wordBreak:"break-all",marginBottom:0,textAlign:"left"},ellipsis:{tooltip:n,rows:2},children:n})}},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",width:130,align:"center",render:function(n,u){return H[u.type]}},{title:"\u5206\u652F",dataIndex:"branch",key:"branch",width:130,align:"center",render:function(n,u){return u.branch||"-"}},{title:"\u5B9A\u65F6\u89C4\u5219",width:180,align:"center",render:function(n,u){if(u.schedule_type==="interval"){var m=u.interval_schedule,P=m.type,b=m.value;return"\u6BCF".concat(b).concat(Z[P])}return u.schedule}},{title:"\u72B6\u6001",key:"status",dataIndex:"status",align:"center",width:110,filters:[{text:"\u8FD0\u884C\u4E2D",value:0},{text:"\u7A7A\u95F2\u4E2D",value:1},{text:"\u5DF2\u7981\u7528",value:2}],onFilter:function(n,u){return u.is_disabled&&u.status!==0?n===2:u.status===n},render:function(n,u){return(0,a.jsxs)(a.Fragment,{children:[(!u.is_disabled||u.status!==T.idle)&&(0,a.jsxs)(a.Fragment,{children:[u.status===T.idle&&(0,a.jsx)(D.Z,{icon:(0,a.jsx)(ge.Z,{}),color:"default",children:"\u7A7A\u95F2\u4E2D"}),u.status===T.running&&(0,a.jsx)(D.Z,{icon:(0,a.jsx)(te.Z,{spin:!0}),color:"processing",children:"\u8FD0\u884C\u4E2D"})]}),u.is_disabled===1&&u.status===T.idle&&(0,a.jsx)(D.Z,{icon:(0,a.jsx)(ne.Z,{}),color:"error",children:"\u5DF2\u7981\u7528"})]})}},{title:"\u64CD\u4F5C",key:"action",align:"center",width:130,render:function(n,u,m){var P=!Fe;return(0,a.jsxs)($.Z,{size:"middle",children:[u.status===T.idle&&(0,a.jsx)(p.Z,{title:P?"\u8FD0\u884C":"",children:(0,a.jsx)("a",{onClick:function(V){V.stopPropagation(),Qe(u,m)},children:(0,a.jsx)(se.Z,{})})}),u.status!==T.idle&&(0,a.jsx)(p.Z,{title:P?"\u505C\u6B62":"",children:(0,a.jsx)("a",{onClick:function(V){V.stopPropagation(),Ge(u,m)},children:(0,a.jsx)(t.Z,{})})}),(0,a.jsx)(p.Z,{title:P?"\u65E5\u5FD7":"",children:(0,a.jsx)("a",{onClick:function(V){V.stopPropagation(),we(l()(l()({},u),{},{timestamp:Date.now()}))},children:(0,a.jsx)(G.Z,{})})}),(0,a.jsx)(et,{record:u,index:m},"more")]})}}],Me=(0,s.useState)([]),Be=h()(Me,2),z=Be[0],X=Be[1],be=(0,s.useState)(!0),De=h()(be,2),ie=De[0],Ae=De[1],Te=(0,s.useState)(!1),Oe=h()(Te,2),Ie=Oe[0],B=Oe[1],i=(0,s.useState)(),C=h()(i,2),E=C[0],I=C[1],W=(0,s.useState)(""),N=h()(W,2),w=N[0],me=N[1],M=(0,s.useState)(1),Y=h()(M,2),oe=Y[0],Ee=Y[1],Re=(0,s.useState)(20),ye=h()(Re,2),ee=ye[0],Le=ye[1],Ve=(0,s.useState)(!1),We=h()(Ve,2),He=We[0],Ue=We[1],Ne=(0,s.useState)(),Ke=h()(Ne,2),je=Ke[0],we=Ke[1],ze=(0,s.useRef)(),ke=(0,fe.Z)(ze),Qe=function(n,u){y.Z.confirm({title:"\u786E\u8BA4\u8FD0\u884C",content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4\u8FD0\u884C\u5B9A\u65F6\u4EFB\u52A1"," ",(0,a.jsx)(q,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){U.W.put("".concat(O.Z.apiPrefix,"subscriptions/run"),{data:[n.id]}).then(function(P){var b=P.code,V=P.data;if(b===200){var R=r()(z),L=R.findIndex(function(k){return k.id===n.id});L!==-1&&(R.splice(L,1,l()(l()({},n),{},{status:T.running})),X(R))}})},onCancel:function(){console.log("Cancel")}})},Ge=function(n,u){y.Z.confirm({title:"\u786E\u8BA4\u505C\u6B62",content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4\u505C\u6B62\u5B9A\u65F6\u4EFB\u52A1"," ",(0,a.jsx)(q,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){U.W.put("".concat(O.Z.apiPrefix,"subscriptions/stop"),{data:[n.id]}).then(function(P){var b=P.code,V=P.data;if(b===200){var R=r()(z),L=R.findIndex(function(k){return k.id===n.id});L!==-1&&(R.splice(L,1,l()(l()({},n),{},{pid:null,status:T.idle})),X(R))}})},onCancel:function(){console.log("Cancel")}})},Je=function(){Ae(!0),U.W.get("".concat(O.Z.apiPrefix,"subscriptions?searchValue=").concat(w)).then(function(n){var u=n.code,m=n.data;u===200&&(X(m),Ee(1))}).finally(function(){return Ae(!1)})},Xe=function(){I(null),B(!0)},Ye=function(n,u){I(n),B(!0)},$e=function(n,u){y.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u5B9A\u65F6\u8BA2\u9605"," ",(0,a.jsx)(q,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){U.W.delete("".concat(O.Z.apiPrefix,"subscriptions"),{data:[n.id]}).then(function(P){var b=P.code,V=P.data;if(b===200){x.ZP.success("\u5220\u9664\u6210\u529F");var R=r()(z),L=R.findIndex(function(k){return k.id===n.id});L!==-1&&(R.splice(L,1),X(R))}})},onCancel:function(){console.log("Cancel")}})},qe=function(n,u){y.Z.confirm({title:"\u786E\u8BA4".concat(n.is_disabled===1?"\u542F\u7528":"\u7981\u7528"),content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4",n.is_disabled===1?"\u542F\u7528":"\u7981\u7528","\u5B9A\u65F6\u8BA2\u9605"," ",(0,a.jsx)(q,{style:{wordBreak:"break-all"},type:"warning",children:n.name})," ","\u5417"]}),onOk:function(){U.W.put("".concat(O.Z.apiPrefix,"subscriptions/").concat(n.is_disabled===1?"enable":"disable"),{data:[n.id]}).then(function(P){var b=P.code,V=P.data;if(b===200){var R=n.is_disabled===1?0:1,L=r()(z),k=L.findIndex(function(it){return it.id===n.id});k!==-1&&(L.splice(k,1,l()(l()({},n),{},{is_disabled:R})),X(L))}})},onCancel:function(){console.log("Cancel")}})},et=function(n){var u=n.record,m=n.index;return(0,a.jsx)(Pe.Z,{arrow:{pointAtCenter:!0},placement:"bottomRight",trigger:["click"],menu:{items:[{label:"\u7F16\u8F91",key:"edit",icon:(0,a.jsx)(de.Z,{})},{label:u.is_disabled===1?"\u542F\u7528":"\u7981\u7528",key:"enableOrDisable",icon:u.is_disabled===1?(0,a.jsx)(ue.Z,{}):(0,a.jsx)(Ce.Z,{})},{label:"\u5220\u9664",key:"delete",icon:(0,a.jsx)(xe.Z,{})}],onClick:function(b){var V=b.key,R=b.domEvent;R.stopPropagation(),tt(V,u,m)}},children:(0,a.jsx)("a",{onClick:function(b){return b.stopPropagation()},children:(0,a.jsx)(J.Z,{})})})},tt=function(n,u,m){switch(n){case"edit":Ye(u,m);break;case"enableOrDisable":qe(u,m);break;case"delete":$e(u,m);break;default:break}},nt=function(n){B(!1),n&&at(n)},ut=function(n){me(n.trim())},at=function(n){var u=z.findIndex(function(P){return P.id===n.id}),m=r()(z);u===-1?m.unshift(n):m.splice(u,1,l()({},n)),X(m)},lt=function(n,u){Ee(n),Le(u),localStorage.setItem("pageSize",u+"")},rt=function(n,u){return n.isPinned?"pinned-subscription subscription":"subscription"};return(0,s.useEffect)(function(){if(!!re){var g=re.type,n=re.message,u=re.references;if(g==="runSubscriptionEnd"&&u.length>0){for(var m=r()(z),P=function(R){var L=z.findIndex(function(k){return k.id===u[R]});L!==-1&&m.splice(L,1,l()(l()({},z[L]),{},{status:T.idle}))},b=0;b<u.length;b++)P(b);X(m)}}},[re]),(0,s.useEffect)(function(){je&&(localStorage.setItem("logSubscription",je.id),Ue(!0))},[je]),(0,s.useEffect)(function(){Je()},[w]),(0,s.useEffect)(function(){Le(parseInt(localStorage.getItem("pageSize")||"20"))},[]),(0,a.jsxs)(ce.ZP,{className:"ql-container-wrapper subscriptiontab-wrapper",title:"\u8BA2\u9605\u7BA1\u7406",extra:[(0,a.jsx)(le,{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0\u6216\u8005\u5173\u952E\u8BCD",style:{width:"auto"},enterButton:!0,allowClear:!0,loading:ie,onSearch:ut}),(0,a.jsx)(Q.Z,{type:"primary",onClick:function(){return Xe()},children:"\u65B0\u5EFA\u8BA2\u9605"},"2")],header:{style:Ze},children:[(0,a.jsx)(A.Z,{ref:ze,columns:Se,pagination:{current:oe,onChange:lt,pageSize:ee,showSizeChanger:!0,simple:Fe,defaultPageSize:20,showTotal:function(n,u){return"\u7B2C ".concat(u[0],"-").concat(u[1]," \u6761/\u603B\u5171 ").concat(n," \u6761")},pageSizeOptions:[20,100,500,1e3]},dataSource:z,rowKey:"id",size:"middle",scroll:{x:1e3,y:ke},loading:ie,rowClassName:rt}),(0,a.jsx)(ve.default,{visible:Ie,handleCancel:nt,subscription:E}),(0,a.jsx)(j.default,{visible:He,handleCancel:function(){Ue(!1)},subscription:je})]})},pe=he},76368:function(v,f,e){"use strict";e.r(f);var d=e(46686),r=e.n(d),o=e(63313),h=e.n(o),F=e(4352),l=e(59225),s=e(74083),S=e(27382),c=e(35316),D=e(9734),$=e(58406),p=e(79418),y=e(11527),x=function(Q){var A=Q.subscription,ge=Q.handleCancel,te=Q.visible,ne=Q.data,se=Q.logUrl,t=(0,o.useState)("\u542F\u52A8\u4E2D..."),G=r()(t,2),de=G[0],ue=G[1],Ce=(0,o.useState)(!0),xe=r()(Ce,2),J=xe[0],O=xe[1],ce=(0,o.useState)(!0),U=r()(ce,2),ve=U[0],_e=U[1],j=(0,o.useState)(!1),fe=r()(j,2),a=fe[0],q=fe[1],ae=function Z(H){H&&O(!0),s.W.get(se||"".concat(S.Z.apiPrefix,"subscriptions/").concat(A.id,"/log")).then(function(he){var pe=he.code,_=he.data;if(pe===200&&localStorage.getItem("logSubscription")===String(A.id)){var K=_;ue(K||"\u6682\u65E0\u65E5\u5FD7"),_e(K&&!(0,p.x$)(K)),K&&!(0,p.x$)(K)&&setTimeout(function(){Z()},2e3)}}).finally(function(){H&&O(!1)})},le=function(){localStorage.removeItem("logSubscription"),ge()},T=function(){return(0,y.jsxs)(y.Fragment,{children:[(ve||J)&&(0,y.jsx)(c.Z,{spin:!0}),!ve&&!J&&(0,y.jsx)(D.Z,{}),(0,y.jsx)("span",{style:{marginLeft:5},children:A&&A.name})]})};return(0,o.useEffect)(function(){A&&A.id&&te&&ae(!0)},[A,te]),(0,o.useEffect)(function(){ne&&ue(ne)},[ne]),(0,o.useEffect)(function(){q(document.body.clientWidth<768)},[]),(0,y.jsx)(F.Z,{title:T(),open:te,centered:!0,className:"log-modal",bodyStyle:{minHeight:"300px"},forceRender:!0,onOk:function(){return le()},onCancel:function(){return le()},footer:[(0,y.jsx)(l.Z,{type:"primary",onClick:function(){return le()},children:"\u77E5\u9053\u4E86"})],children:J?(0,y.jsx)($.Z,{}):(0,y.jsx)("pre",{style:a?{fontFamily:"Source Code Pro",width:375,zoom:.83}:{},children:de})})};f.default=x},14096:function(v,f,e){"use strict";e.r(f);var d=e(35290),r=e.n(d),o=e(30279),h=e.n(o),F=e(411),l=e.n(F),s=e(46686),S=e.n(s),c=e(63313),D=e.n(c),$=e(61839),p=e(71976),y=e(63533),x=e(30314),Pe=e(50499),Q=e(4352),A=e(28666),ge=e(74083),te=e(27382),ne=e(73183),se=e.n(ne),t=e(11527),G=$.Z.Option,de=/[^\/\:]+\/[^\/]+(?=\.git)/,ue=/[^\/\:]+\/[^\/]+$/,Ce=function(J){var O=J.subscription,ce=J.handleCancel,U=J.visible,ve=p.Z.useForm(),_e=S()(ve,1),j=_e[0],fe=(0,c.useState)(!1),a=S()(fe,2),q=a[0],ae=a[1],le=(0,c.useState)("public-repo"),T=S()(le,2),Z=T[0],H=T[1],he=(0,c.useState)("crontab"),pe=S()(he,2),_=pe[0],K=pe[1],Ze=(0,c.useState)("ssh-key"),Fe=S()(Ze,2),re=Fe[0],Se=Fe[1],Me=function(){var B=l()(r()().mark(function i(C){var E,I,W,N,w;return r()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return ae(!0),E=O?"put":"post",I=h()({},C),O&&(I.id=O.id),M.prev=4,M.next=7,ge.W[E]("".concat(te.Z.apiPrefix,"subscriptions"),{data:I});case 7:W=M.sent,N=W.code,w=W.data,N===200&&(y.ZP.success(O?"\u66F4\u65B0\u8BA2\u9605\u6210\u529F":"\u65B0\u5EFA\u8BA2\u9605\u6210\u529F"),ce(w)),ae(!1),M.next=17;break;case 14:M.prev=14,M.t0=M.catch(4),ae(!1);case 17:case"end":return M.stop()}},i,null,[[4,14]])}));return function(C){return B.apply(this,arguments)}}(),Be=function(i){H(i.target.value);var C=j.getFieldValue("url"),E=j.getFieldValue("branch");j.setFieldsValue({alias:ie(C,E,i.target.value)}),C&&j.validateFields(["url"])},z=function(i){K(i.target.value),j.setFieldsValue({schedule:""})},X=function(i){Se(i.target.value)},be=function(i){var C=j.getFieldValue("branch");j.setFieldsValue({alias:ie(i.target.value,C)})},De=function(i){var C=j.getFieldValue("url");j.setFieldsValue({alias:ie(C,i.target.value)})},ie=function(i,C){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Z,I="",W=E==="file"?ue:de;return W.test(i)&&(I=i.match(W)[0].replaceAll("/","_").replaceAll(".","_")),C&&(I=I+"_"+C),I},Ae=function(i){var C=i.value,E=i.onChange,I=(0,c.useState)("days"),W=S()(I,2),N=W[0],w=W[1],me=(0,c.useState)(),M=S()(me,2),Y=M[0],oe=M[1],Ee=function(ee){w(ee),Y&&Y>0&&(E==null||E({type:ee,value:Y}))},Re=function(ee){oe(ee),ee?E==null||E({type:N,value:ee}):E==null||E(null)};return(0,c.useEffect)(function(){C&&(w(C.type),oe(C.value))},[C]),(0,t.jsxs)(x.Z.Group,{compact:!0,children:[(0,t.jsx)(Pe.Z,{addonBefore:"\u6BCF",precision:0,min:1,value:Y,style:{width:"calc(100% - 58px)"},onChange:Re}),(0,t.jsxs)($.Z,{value:N,onChange:Ee,children:[(0,t.jsx)(G,{value:"days",children:"\u5929"}),(0,t.jsx)(G,{value:"hours",children:"\u65F6"}),(0,t.jsx)(G,{value:"minutes",children:"\u5206"}),(0,t.jsx)(G,{value:"seconds",children:"\u79D2"})]})]})},Te=function(i){var C=i.value,E=i.onChange,I=i.type;return I==="ssh-key"?(0,t.jsx)(p.Z.Item,{name:["pull_option","private_key"],label:"\u79C1\u94A5",rules:[{required:!0}],children:(0,t.jsx)(x.Z.TextArea,{rows:4,autoSize:{minRows:1,maxRows:6},placeholder:"\u8BF7\u8F93\u5165\u79C1\u94A5"})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z.Item,{name:["pull_option","username"],label:"\u7528\u6237\u540D",rules:[{required:!0}],children:(0,t.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BA4\u8BC1\u7528\u6237\u540D"})}),(0,t.jsx)(p.Z.Item,{name:["pull_option","password"],tooltip:"Github\u5DF2\u4E0D\u652F\u6301\u5BC6\u7801\u8BA4\u8BC1\uFF0C\u8BF7\u4F7F\u7528Token\u65B9\u5F0F",label:"\u5BC6\u7801/Token",rules:[{required:!0}],children:(0,t.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801\u6216\u8005Token"})})]})},Oe=(0,c.useCallback)(function(B){var i=B.clipboardData.getData("text");if(i.startsWith("ql ")){var C=i.split(" ").map(function(Ee){return Ee.trim().replace(/\"/g,"").replace(/\'/,"")}),E=S()(C,8),I=E[1],W=E[2],N=E[3],w=E[4],me=E[5],M=E[6],Y=E[7],oe=I==="raw"?"file":W.startsWith("http")?"public-repo":"private-repo";j.setFieldsValue({type:oe,url:W,whitelist:N,blacklist:w,dependences:me,branch:M,extensions:Y,alias:ie(W,M)}),H(oe)}},[]),Ie=(0,c.useCallback)(function(B){var i=B.clipboardData.getData("text");i.startsWith("ql ")&&B.preventDefault()},[]);return(0,c.useEffect)(function(){U?window.addEventListener("paste",Oe):window.removeEventListener("paste",Oe)},[U]),(0,c.useEffect)(function(){j.setFieldsValue(O||{}),H(O&&O.type||"public-repo"),K(O&&O.schedule_type||"crontab"),Se(O&&O.pull_type||"ssh-key"),O||j.resetFields()},[O,U]),(0,t.jsx)(Q.Z,{title:O?"\u7F16\u8F91\u8BA2\u9605":"\u65B0\u5EFA\u8BA2\u9605",open:U,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){j.validateFields().then(function(i){Me(i)}).catch(function(i){console.log("Validate Failed:",i)})},onCancel:function(){return ce()},confirmLoading:q,children:(0,t.jsxs)(p.Z,{form:j,name:"form_in_modal",layout:"vertical",children:[(0,t.jsx)(p.Z.Item,{name:"name",label:"\u540D\u79F0",children:(0,t.jsx)(x.Z,{placeholder:"\u652F\u6301\u62F7\u8D1Dql repo/raw\u547D\u4EE4\uFF0C\u7C98\u8D34\u5BFC\u5165",onPaste:Ie})}),(0,t.jsx)(p.Z.Item,{name:"type",label:"\u7C7B\u578B",rules:[{required:!0}],initialValue:"public-repo",children:(0,t.jsxs)(A.ZP.Group,{onChange:Be,children:[(0,t.jsx)(A.ZP,{value:"public-repo",children:"\u516C\u5F00\u4ED3\u5E93"}),(0,t.jsx)(A.ZP,{value:"private-repo",children:"\u79C1\u6709\u4ED3\u5E93"}),(0,t.jsx)(A.ZP,{value:"file",children:"\u5355\u6587\u4EF6"})]})}),(0,t.jsx)(p.Z.Item,{name:"url",label:"\u94FE\u63A5",rules:[{required:!0},{pattern:Z==="file"?ue:de}],children:(0,t.jsx)(x.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605\u94FE\u63A5",onPaste:be,onChange:be})}),Z!=="file"&&(0,t.jsx)(p.Z.Item,{name:"branch",label:"\u5206\u652F",children:(0,t.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u5206\u652F",onPaste:De,onChange:De})}),(0,t.jsx)(p.Z.Item,{name:"alias",label:"\u552F\u4E00\u503C",rules:[{required:!0,message:""}],tooltip:"\u552F\u4E00\u503C\u7528\u4E8E\u65E5\u5FD7\u76EE\u5F55\u548C\u79C1\u94A5\u522B\u540D",children:(0,t.jsx)(x.Z,{placeholder:"\u81EA\u52A8\u751F\u6210",disabled:!0})}),Z==="private-repo"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z.Item,{name:"pull_type",label:"\u62C9\u53D6\u65B9\u5F0F",initialValue:"ssh-key",rules:[{required:!0}],children:(0,t.jsxs)(A.ZP.Group,{onChange:X,children:[(0,t.jsx)(A.ZP,{value:"ssh-key",children:"\u79C1\u94A5"}),(0,t.jsx)(A.ZP,{value:"user-pwd",children:"\u7528\u6237\u540D\u5BC6\u7801/Token"})]})}),(0,t.jsx)(Te,{type:re})]}),(0,t.jsx)(p.Z.Item,{name:"schedule_type",label:"\u5B9A\u65F6\u7C7B\u578B",initialValue:"crontab",rules:[{required:!0}],children:(0,t.jsxs)(A.ZP.Group,{onChange:z,children:[(0,t.jsx)(A.ZP,{value:"crontab",children:"crontab"}),(0,t.jsx)(A.ZP,{value:"interval",children:"interval"})]})}),(0,t.jsx)(p.Z.Item,{name:_==="crontab"?"schedule":"interval_schedule",label:"\u5B9A\u65F6\u89C4\u5219",rules:[{required:!0},{validator:function(i,C){return _==="interval"||!C||se().parseExpression(C).hasNext()?Promise.resolve():Promise.reject("Subscription\u8868\u8FBE\u5F0F\u683C\u5F0F\u6709\u8BEF")}}],children:_==="interval"?(0,t.jsx)(Ae,{}):(0,t.jsx)(x.Z,{placeholder:"\u79D2(\u53EF\u9009) \u5206 \u65F6 \u5929 \u6708 \u5468"})}),Z!=="file"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Z.Item,{name:"whitelist",label:"\u767D\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(x.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u767D\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(p.Z.Item,{name:"blacklist",label:"\u9ED1\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(x.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u9ED1\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(p.Z.Item,{name:"dependences",label:"\u4F9D\u8D56\u6587\u4EF6",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,t.jsx)(x.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u4F9D\u8D56\u6587\u4EF6\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,t.jsx)(p.Z.Item,{name:"extensions",label:"\u6587\u4EF6\u540E\u7F00",tooltip:"\u4ED3\u5E93\u9700\u8981\u62C9\u53D6\u7684\u6587\u4EF6\u540E\u7F00\uFF0C\u591A\u4E2A\u540E\u7F00\u7A7A\u683C\u5206\u9694\uFF0C\u9ED8\u8BA4\u4F7F\u7528\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684RepoFileExtensions",children:(0,t.jsx)(x.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540E\u7F00"})}),(0,t.jsx)(p.Z.Item,{name:"sub_before",label:"\u6267\u884C\u524D",tooltip:"\u8FD0\u884C\u8BA2\u9605\u524D\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,t.jsx)(x.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u524D\u8981\u6267\u884C\u7684\u547D\u4EE4"})}),(0,t.jsx)(p.Z.Item,{name:"sub_after",label:"\u6267\u884C\u540E",tooltip:"\u8FD0\u884C\u8BA2\u9605\u540E\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,t.jsx)(x.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u540E\u8981\u6267\u884C\u7684\u547D\u4EE4"})})]}),(0,t.jsx)(p.Z.Item,{name:"proxy",label:"\u4EE3\u7406",tooltip:"\u516C\u5F00\u4ED3\u5E93\u652F\u6301HTTP/SOCK5\u4EE3\u7406\uFF0C\u79C1\u6709\u4ED3\u5E93\u652F\u6301SOCK5\u4EE3\u7406",children:(0,t.jsx)(x.Z,{placeholder:Z==="private-repo"?"SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 IP:PORT":"HTTP/SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 http://127.0.0.1:1080"})})]})})};f.default=Ce},35167:function(){},13989:function(v,f,e){var d=e(33737);function r(o){if(Array.isArray(o))return d(o)}v.exports=r,v.exports.__esModule=!0,v.exports.default=v.exports},56037:function(v){function f(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}v.exports=f,v.exports.__esModule=!0,v.exports.default=v.exports},90623:function(v){function f(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}v.exports=f,v.exports.__esModule=!0,v.exports.default=v.exports},94434:function(v,f,e){var d=e(13989),r=e(56037),o=e(94945),h=e(90623);function F(l){return d(l)||r(l)||o(l)||h()}v.exports=F,v.exports.__esModule=!0,v.exports.default=v.exports}}]);

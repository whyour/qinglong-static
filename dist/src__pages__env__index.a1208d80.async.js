"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8247],{72439:function(e,t,n){var r=n(48305),a=n.n(r),i=n(75271),c=n(30502),s=n(52076);t.Z=function(e,t){var n=(0,i.useState)(0),r=a()(n,2),l=r[0],o=r[1];return(0,c.Z)(e,(function(e){var n=e.target;n.classList.contains("ant-table-wrapper")||(n=e.target.querySelector(".ant-table-wrapper")),o((0,s.W9)({extraHeight:t,target:n}))})),l}},55416:function(e,t,n){n.r(t);var r=n(90228),a=n.n(r),i=n(87999),c=n.n(i),s=n(48305),l=n.n(s),o=n(72317),u=n(75271),d=n(72338),f=n(61508),p=n(45520),m=n(17082),Z=n(16314),g=n(3475),x=n(52676);t.default=function(e){var t=e.ids,n=e.handleCancel,r=e.visible,i=d.Z.useForm(),s=l()(i,1)[0],h=(0,u.useState)(!1),v=l()(h,2),P=v[0],j=v[1],y=function(){var e=c()(a()().mark((function e(r){var i,c;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.prev=1,e.next=4,Z.W.put("".concat(g.Z.apiPrefix,"envs/name"),{ids:t,name:r.name});case 4:i=e.sent,c=i.code,i.data,200===c&&(f.ZP.success(o.ZP.get("更新环境变量名称成功")),n()),j(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),j(!1);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}();return(0,u.useEffect)((function(){s.resetFields()}),[t,r]),(0,x.jsx)(p.Z,{title:o.ZP.get("修改环境变量名称"),open:r,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){s.validateFields().then((function(e){y(e)})).catch((function(e){console.log("Validate Failed:",e)}))},onCancel:function(){return n()},confirmLoading:P,children:(0,x.jsx)(d.Z,{form:s,layout:"vertical",name:"edit_name_modal",children:(0,x.jsx)(d.Z.Item,{name:"name",rules:[{required:!0,message:o.ZP.get("请输入新的环境变量名称")}],children:(0,x.jsx)(m.Z,{placeholder:o.ZP.get("请输入新的环境变量名称")})})})})}},14532:function(e,t,n){n.r(t),n.d(t,{default:function(){return se}});var r=n(90228),a=n.n(r),i=n(87999),c=n.n(i),s=n(67825),l=n.n(s),o=n(26068),u=n.n(o),d=n(15558),f=n.n(d),p=n(48305),m=n.n(p),Z=n(72317),g=n(75271),x=n(50691),h=n(17082),v=n(59816),P=n(63505),j=n(47667),y=n(45520),k=n(61508),w=n(6367),b=n(93481),C=n(10948),S=n(28423),L=n(44084),R=n(1704),I=n(88939),F=n(79231),O=n(3475),W=n(47508),D=n(16314),N=n(51396),B=n(55416),T=n(12363),z=n(18708),A=n(78637),E=n(4690),q=n(52076),V=n(98783),_=n(72439),Y=n(88629),H=n(13868),K=n(58226),M=n(52676),G=x.Z.Link,J=function(e){var t=e.text,n=(0,g.useState)(!1),r=m()(n,2),a=r[0],i=r[1],c=(0,g.useRef)(),s=function(){window.clearTimeout(c.current)};return(0,M.jsx)(G,{onClick:function(e){null==e||e.preventDefault(),null==e||e.stopPropagation(),i(!0),s(),c.current=window.setTimeout((function(){i(!1)}),3e3)},style:{marginLeft:1},children:(0,M.jsx)(K.CopyToClipboard,{text:t,children:(0,M.jsx)(v.Z,{title:a?Z.ZP.get("复制成功"):Z.ZP.get("复制"),children:a?(0,M.jsx)(Y.Z,{}):(0,M.jsx)(H.Z,{})},"copy")})})},U=n(19610),$=n(16483),Q=n.n($),X=["index","moveRow","className","style"],ee=x.Z.Paragraph,te=h.Z.Search,ne=function(e){return e[e["已启用"]=0]="已启用",e[e["已禁用"]=1]="已禁用",e}(ne||{}),re=function(e){return e[e.success=0]="success",e[e.error=1]="error",e}(re||{}),ae=function(e){return e[e["启用"]=0]="启用",e[e["禁用"]=1]="禁用",e}(ae||{}),ie=function(e){return e[e.enable=0]="enable",e[e.disable=1]="disable",e}(ie||{}),ce="DragableBodyRow",se=function(){var e=(0,V.useOutletContext)(),t=e.headerStyle,n=e.isPhone,r=(e.theme,[{title:Z.ZP.get("序号"),width:80,render:function(e,t,n){return(0,M.jsxs)("span",{style:{cursor:"text"},children:[n+1," "]})}},{title:Z.ZP.get("名称"),dataIndex:"name",key:"name",sorter:function(e,t){return e.name.localeCompare(t.name)},render:function(e,t){return(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,M.jsx)(v.Z,{title:e,placement:"topLeft",children:(0,M.jsx)("div",{className:"text-ellipsis",children:e})}),(0,M.jsx)(J,{text:e})]})}},{title:Z.ZP.get("值"),dataIndex:"value",key:"value",width:"35%",render:function(e,t){return(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,M.jsx)(v.Z,{title:e,placement:"topLeft",children:(0,M.jsx)("div",{className:"text-ellipsis",children:e})}),(0,M.jsx)(J,{text:e})]})}},{title:Z.ZP.get("备注"),dataIndex:"remarks",key:"remarks",render:function(e,t){return(0,M.jsx)(v.Z,{title:e,placement:"topLeft",children:(0,M.jsx)("div",{className:"text-ellipsis",children:e})})}},{title:Z.ZP.get("更新时间"),dataIndex:"timestamp",key:"timestamp",width:165,ellipsis:{showTitle:!1},sorter:{compare:function(e,t){return new Date(e.updatedAt||e.timestamp).getTime()-new Date(t.updatedAt||t.timestamp).getTime()}},render:function(e,t){var n=Q()(t.updatedAt||t.timestamp).format("YYYY-MM-DD HH:mm:ss");return(0,M.jsx)(v.Z,{placement:"topLeft",title:n,trigger:["hover","click"],children:(0,M.jsx)("span",{children:n})})}},{title:Z.ZP.get("状态"),key:"status",dataIndex:"status",width:100,filters:[{text:Z.ZP.get("已启用"),value:0},{text:Z.ZP.get("已禁用"),value:1}],onFilter:function(e,t){return t.status===e},render:function(e,t,n){return(0,M.jsx)(P.Z,{size:"middle",style:{cursor:"text"},children:(0,M.jsx)(j.Z,{color:re[t.status],style:{marginRight:0},children:Z.ZP.get(ne[t.status])})})}},{title:Z.ZP.get("操作"),key:"action",width:120,render:function(e,t,r){var a=!n;return(0,M.jsxs)(P.Z,{size:"middle",children:[(0,M.jsx)(v.Z,{title:a?Z.ZP.get("编辑"):"",children:(0,M.jsx)("a",{onClick:function(){return Fe(t,r)},children:(0,M.jsx)(S.Z,{})})}),(0,M.jsx)(v.Z,{title:a?t.status===ne.已禁用?Z.ZP.get("启用"):Z.ZP.get("禁用"):"",children:(0,M.jsx)("a",{onClick:function(){return Ie(t,r)},children:t.status===ne.已禁用?(0,M.jsx)(L.Z,{}):(0,M.jsx)(R.Z,{})})}),(0,M.jsx)(v.Z,{title:a?Z.ZP.get("删除"):"",children:(0,M.jsx)("a",{onClick:function(){return Oe(t,r)},children:(0,M.jsx)(I.Z,{})})})]})}}]),i=(0,g.useState)([]),s=m()(i,2),o=s[0],d=s[1],p=(0,g.useState)(!0),x=m()(p,2),h=x[0],Y=x[1],H=(0,g.useState)(!1),K=m()(H,2),G=K[0],$=K[1],se=(0,g.useState)(!1),le=m()(se,2),oe=le[0],ue=le[1],de=(0,g.useState)(),fe=m()(de,2),pe=fe[0],me=fe[1],Ze=(0,g.useState)([]),ge=m()(Ze,2),xe=ge[0],he=ge[1],ve=(0,g.useState)(""),Pe=m()(ve,2),je=Pe[0],ye=Pe[1],ke=(0,g.useState)(!1),we=m()(ke,2),be=we[0],Ce=we[1],Se=(0,g.useRef)(null),Le=(0,_.Z)(Se,59),Re=function(){Y(!0),D.W.get("".concat(O.Z.apiPrefix,"envs?searchValue=").concat(je)).then((function(e){var t=e.code,n=e.data;200===t&&d(n)})).finally((function(){return Y(!1)}))},Ie=function(e,t){y.Z.confirm({title:"确认".concat(e.status===ne.已禁用?Z.ZP.get("启用"):Z.ZP.get("禁用")),content:(0,M.jsxs)(M.Fragment,{children:[Z.ZP.get("确认"),e.status===ne.已禁用?Z.ZP.get("启用"):Z.ZP.get("禁用"),"Env"," ",(0,M.jsx)(ee,{style:{wordBreak:"break-all",display:"inline"},ellipsis:{rows:6,expandable:!0},type:"warning",copyable:!0,children:e.value})," ",Z.ZP.get("吗")]}),onOk:function(){D.W.put("".concat(O.Z.apiPrefix,"envs/").concat(e.status===ne.已禁用?"enable":"disable"),[e.id]).then((function(n){var r=n.code;n.data;if(200===r){k.ZP.success("".concat(e.status===ne.已禁用?Z.ZP.get("启用"):Z.ZP.get("禁用")).concat(Z.ZP.get("成功")));var a=e.status===ne.已禁用?ne.已启用:ne.已禁用,i=f()(o);i.splice(t,1,u()(u()({},e),{},{status:a})),d(i)}}))},onCancel:function(){console.log("Cancel")}})},Fe=function(e,t){me(e),$(!0)},Oe=function(e,t){y.Z.confirm({title:Z.ZP.get("确认删除"),content:(0,M.jsxs)(M.Fragment,{children:[Z.ZP.get("确认删除变量")," ",(0,M.jsxs)(ee,{style:{wordBreak:"break-all",display:"inline"},ellipsis:{rows:6,expandable:!0},type:"warning",copyable:!0,children:[e.name,": ",e.value]})," ",Z.ZP.get("吗")]}),onOk:function(){D.W.delete("".concat(O.Z.apiPrefix,"envs"),{data:[e.id]}).then((function(e){var n=e.code;e.data;if(200===n){k.ZP.success(Z.ZP.get("删除成功"));var r=f()(o);r.splice(t,1),d(r)}}))},onCancel:function(){console.log("Cancel")}})},We=(0,U.u)((function(){return{scroll:{y:Le}}}),[Le]),De=m()(We,2),Ne=De[0],Be=De[1],Te=g.forwardRef((function(e,t){var n=e.index,r=e.moveRow,a=e.className,i=e.style,c=l()(e,X),s=(0,T.L)({accept:ce,collect:function(e){var t=(e.getItem()||{}).index;return t===n?{}:{isOver:e.isOver(),dropClassName:t<n?" drop-over-downward":" drop-over-upward"}},drop:function(e){r(e.index,n)}}),o=m()(s,2),d=o[0],f=d.isOver,p=d.dropClassName,Z=o[1],x=(0,z.c)({type:ce,item:{index:n},collect:function(e){return{isDragging:e.isDragging()}}}),h=m()(x,2)[1];return(0,g.useEffect)((function(){Z(h(t))}),[t]),(0,M.jsx)("tr",u()({ref:t,className:"".concat(a).concat(f?p:""),style:u()({cursor:"move"},i)},c))}));(0,g.useEffect)((function(){return Be({body:{row:Te}})}),[]);var ze,Ae=(0,g.useCallback)((function(e,t){if(e!==t){var n=o[e];D.W.put("".concat(O.Z.apiPrefix,"envs/").concat(n.id,"/move"),{fromIndex:e,toIndex:t}).then((function(r){var a=r.code,i=r.data;if(200===a){var c=f()(o);c.splice(e,1),c.splice(t,0,u()(u()({},n),i)),d(f()(c))}}))}}),[o]),Ee={selectedRowKeys:xe,onChange:function(e){he(e)}},qe=function(e){y.Z.confirm({title:"确认".concat(ae[e]),content:(0,M.jsxs)(M.Fragment,{children:[Z.ZP.get("确认"),ae[e],Z.ZP.get("选中的变量吗")]}),onOk:function(){D.W.put("".concat(O.Z.apiPrefix,"envs/").concat(ie[e]),xe).then((function(e){var t=e.code;e.data;200===t&&Re()}))},onCancel:function(){console.log("Cancel")}})},Ve={accept:"application/json",beforeUpload:(ze=c()(a()().mark((function e(t){var n,r,i,c;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new FormData).append("env",t),Ce(!0),e.prev=3,e.next=6,D.W.post("".concat(O.Z.apiPrefix,"envs/upload"),n);case 6:r=e.sent,i=r.code,c=r.data,200===i&&(k.ZP.success("成功上传".concat(c.length,"个环境变量")),Re()),Ce(!1),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),Ce(!1);case 16:return e.abrupt("return",!1);case 17:case"end":return e.stop()}}),e,null,[[3,13]])}))),function(e){return ze.apply(this,arguments)}),fileList:[]};return(0,g.useEffect)((function(){Re()}),[je]),(0,M.jsxs)(W.ZP,{className:"ql-container-wrapper env-wrapper",title:Z.ZP.get("环境变量"),extra:[(0,M.jsx)(te,{placeholder:Z.ZP.get("请输入名称/值/备注"),style:{width:"auto"},enterButton:!0,loading:h,onSearch:function(e){ye(e.trim())}}),(0,M.jsx)(w.Z,u()(u()({},Ve),{},{children:(0,M.jsx)(b.Z,{type:"primary",icon:(0,M.jsx)(F.Z,{}),loading:be,children:Z.ZP.get("导入")})})),(0,M.jsx)(b.Z,{type:"primary",onClick:function(){return me(null),void $(!0)},children:Z.ZP.get("创建变量")},"2")],header:{style:t},children:[(0,M.jsxs)("div",{ref:Se,children:[xe.length>0&&(0,M.jsxs)("div",{style:{marginBottom:16},children:[(0,M.jsx)(b.Z,{type:"primary",style:{marginBottom:5},onClick:function(){ue(!0)},children:Z.ZP.get("批量修改变量名称")}),(0,M.jsx)(b.Z,{type:"primary",style:{marginBottom:5,marginLeft:8},onClick:function(){y.Z.confirm({title:Z.ZP.get("确认删除"),content:(0,M.jsx)(M.Fragment,{children:Z.ZP.get("确认删除选中的变量吗")}),onOk:function(){D.W.delete("".concat(O.Z.apiPrefix,"envs"),{data:xe}).then((function(e){var t=e.code;e.data;200===t&&(k.ZP.success(Z.ZP.get("批量删除成功")),he([]),Re())}))},onCancel:function(){console.log("Cancel")}})},children:Z.ZP.get("批量删除")}),(0,M.jsx)(b.Z,{type:"primary",onClick:function(){return e=o.filter((function(e){return xe.includes(e.id)})).map((function(e){return{value:e.value,name:e.name,remarks:e.remarks}})),void(0,q.w7)("env.json",JSON.stringify(e));var e},style:{marginLeft:8,marginRight:8},children:Z.ZP.get("批量导出")}),(0,M.jsx)(b.Z,{type:"primary",onClick:function(){return qe(0)},style:{marginLeft:8,marginBottom:5},children:Z.ZP.get("批量启用")}),(0,M.jsx)(b.Z,{type:"primary",onClick:function(){return qe(1)},style:{marginLeft:8,marginRight:8},children:Z.ZP.get("批量禁用")}),(0,M.jsxs)("span",{style:{marginLeft:8},children:[Z.ZP.get("已选择"),(0,M.jsx)("a",{children:null==xe?void 0:xe.length}),Z.ZP.get("项")]})]}),(0,M.jsx)(A.W,{backend:E.PD,children:(0,M.jsx)(C.Z,{columns:r,rowSelection:Ee,pagination:!1,dataSource:o,rowKey:"id",size:"middle",scroll:{x:1200,y:Le},components:Ne,loading:h,onRow:function(e,t){return{index:t,moveRow:Ae}}})})]}),(0,M.jsx)(N.default,{visible:G,handleCancel:function(e){$(!1),Re()},env:pe}),(0,M.jsx)(B.default,{visible:oe,handleCancel:function(e){ue(!1),Re()},ids:xe})]})}},51396:function(e,t,n){n.r(t);var r=n(90228),a=n.n(r),i=n(26068),c=n.n(i),s=n(87999),l=n.n(s),o=n(48305),u=n.n(o),d=n(72317),f=n(75271),p=n(72338),m=n(61508),Z=n(45520),g=n(17082),x=n(94747),h=n(16314),v=n(3475),P=n(52676);t.default=function(e){var t=e.env,n=e.handleCancel,r=e.visible,i=p.Z.useForm(),s=u()(i,1)[0],o=(0,f.useState)(!1),j=u()(o,2),y=j[0],k=j[1],w=function(){var e=l()(a()().mark((function e(r){var i,s,l,o,u,f,p,Z,g,x;return a()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(!0),i=r.value,s=r.split,l=r.name,o=r.remarks,u=t?"put":"post",t?f=c()(c()({},r),{},{id:t.id}):"1"===s?(p=i.includes("&")?"&":"\n",f=i.split(p).map((function(e){return{name:l,value:e,remarks:o}}))):f=[{value:i,name:l,remarks:o}],e.prev=4,e.next=7,h.W[u]("".concat(v.Z.apiPrefix,"envs"),f);case 7:Z=e.sent,g=Z.code,x=Z.data,200===g&&(m.ZP.success(t?d.ZP.get("更新变量成功"):d.ZP.get("创建变量成功")),n(x)),k(!1),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),k(!1);case 17:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}();return(0,f.useEffect)((function(){s.resetFields()}),[t,r]),(0,P.jsx)(Z.Z,{title:t?d.ZP.get("编辑变量"):d.ZP.get("创建变量"),open:r,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){s.validateFields().then((function(e){w(e)})).catch((function(e){console.log("Validate Failed:",e)}))},onCancel:function(){return n()},confirmLoading:y,children:(0,P.jsxs)(p.Z,{form:s,layout:"vertical",name:"env_modal",initialValues:t,children:[(0,P.jsx)(p.Z.Item,{name:"name",label:d.ZP.get("名称"),rules:[{required:!0,message:d.ZP.get("请输入环境变量名称"),whitespace:!0},{pattern:/^[a-zA-Z_][0-9a-zA-Z_]*$/,message:d.ZP.get("只能输入字母数字下划线，且不能以数字开头")}],children:(0,P.jsx)(g.Z,{placeholder:d.ZP.get("请输入环境变量名称")})}),!t&&(0,P.jsx)(p.Z.Item,{name:"split",label:d.ZP.get("自动拆分"),initialValue:"0",tooltip:d.ZP.get("多个依赖是否换行分割"),children:(0,P.jsxs)(x.ZP.Group,{children:[(0,P.jsx)(x.ZP,{value:"1",children:d.ZP.get("是")}),(0,P.jsx)(x.ZP,{value:"0",children:d.ZP.get("否")})]})}),(0,P.jsx)(p.Z.Item,{name:"value",label:d.ZP.get("值"),rules:[{required:!0,message:d.ZP.get("请输入环境变量值"),whitespace:!0}],children:(0,P.jsx)(g.Z.TextArea,{autoSize:{minRows:1,maxRows:8},placeholder:d.ZP.get("请输入环境变量值")})}),(0,P.jsx)(p.Z.Item,{name:"remarks",label:d.ZP.get("备注"),children:(0,P.jsx)(g.Z,{placeholder:d.ZP.get("请输入备注")})})]})})}}}]);
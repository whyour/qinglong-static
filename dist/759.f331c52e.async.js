"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[759],{18845:function(ue,y,e){var Z=e(82878),B=(0,Z.Z)({scriptUrl:["//at.alicdn.com/t/c/font_3354854_ob5y15ewlyq.js"]});y.Z=B},66778:function(ue,y,e){e.r(y);var Z=e(12342),B=e.n(Z),J=e(25359),P=e.n(J),Q=e(57213),d=e.n(Q),X=e(49811),q=e.n(X),M=e(54306),k=e.n(M),I=e(63313),me=e.n(I),u=e(91692),v=e(57179),ee=e(24550),$=e(38626),z=e(21728),T=e(33682),F=e(96786),ne=e(45277),G=e(28786),Y=e(3567),te=e(18845),n=e(11527),_e=["key","name"],ae=["key","name"],i=[{name:"\u547D\u4EE4",value:"command"},{name:"\u540D\u79F0",value:"name"},{name:"\u5B9A\u65F6\u89C4\u5219",value:"schedule"},{name:"\u72B6\u6001",value:"status"},{name:"\u6807\u7B7E",value:"labels"}],re={Reg:"",NotReg:"",In:"select",Nin:"select"},oe=[{name:"\u5305\u542B",value:"Reg"},{name:"\u4E0D\u5305\u542B",value:"NotReg"},{name:"\u5C5E\u4E8E",value:"In",type:"select"},{name:"\u4E0D\u5C5E\u4E8E",value:"Nin",type:"select"}],H=[{name:"\u987A\u5E8F",value:"ASC"},{name:"\u5012\u5E8F",value:"DESC"}],le={status:[{name:"\u8FD0\u884C\u4E2D",value:0},{name:"\u7A7A\u95F2\u4E2D",value:1},{name:"\u5DF2\u7981\u7528",value:2}]},W;(function(c){c.and="\u4E14",c.or="\u6216"})(W||(W={}));var se=function(h){var g=h.view,L=h.handleCancel,C=h.visible,S=u.Z.useForm(),U=k()(S,1),D=U[0],p=(0,I.useState)(!1),f=k()(p,2),w=f[0],j=f[1],V=(0,I.useState)("and"),R=k()(V,2),b=R[0],K=R[1],x=u.Z.useWatch("filters",D),O=function(){var m=q()(P()().mark(function t(_){var a,o,r,E;return P()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return j(!0),_.filterRelation=b,a=g?"put":"post",s.prev=3,s.next=6,F.W[a]("".concat(ne.Z.apiPrefix,"crons/views"),{data:g?d()(d()({},_),{},{id:g.id}):_});case 6:o=s.sent,r=o.code,E=o.data,r===200&&L(E),j(!1),s.next=16;break;case 13:s.prev=13,s.t0=s.catch(3),j(!1);case 16:case"end":return s.stop()}},t,null,[[3,13]])}));return function(_){return m.apply(this,arguments)}}();(0,I.useEffect)(function(){g||D.resetFields(),D.setFieldsValue(g||{filters:[{property:"command",operation:"Reg"}]})},[g,C]);var N=(0,n.jsx)(v.Z,{style:{width:80},children:oe.map(function(m){return(0,n.jsx)(v.Z.Option,{value:m.value,children:m.name},m.name)})}),A=function(t){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,n.jsx)(v.Z,{style:_,children:t.map(function(a){return(0,n.jsx)(v.Z.Option,{value:a.value,children:a.name},a.name)})})},ie=(0,n.jsx)(v.Z,{style:{width:80},children:H.map(function(m){return(0,n.jsx)(v.Z.Option,{value:m.value,children:m.name},m.name)})}),de=function(t){var _;return(0,n.jsx)(v.Z,{mode:"tags",allowClear:!0,placeholder:"\u8F93\u5165\u540E\u56DE\u8F66\u589E\u52A0\u81EA\u5B9A\u4E49\u9009\u9879",children:(_=le[t])===null||_===void 0?void 0:_.map(function(a){return(0,n.jsx)(v.Z.Option,{value:a.value,children:a.name},a.name)})})};return(0,n.jsx)(ee.Z,{title:g?"\u7F16\u8F91\u89C6\u56FE":"\u65B0\u5EFA\u89C6\u56FE",open:C,forceRender:!0,width:580,centered:!0,maskClosable:!1,onOk:function(){D.validateFields().then(function(t){O(t)}).catch(function(t){console.log("Validate Failed:",t)})},onCancel:function(){return L()},confirmLoading:w,children:(0,n.jsxs)(u.Z,{form:D,layout:"vertical",name:"env_modal",children:[(0,n.jsx)(u.Z.Item,{name:"name",label:"\u89C6\u56FE\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"}],children:(0,n.jsx)($.Z,{placeholder:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"})}),(0,n.jsx)(u.Z.List,{name:"filters",children:function(t,_){var a=_.add,o=_.remove;return(0,n.jsxs)("div",{style:{position:"relative"},className:"view-filters-container ".concat(t.length>1?"active":""),children:[t.length>1&&(0,n.jsx)("div",{style:{position:"absolute",width:50,borderRadius:10,border:"1px solid rgb(190, 220, 255)",borderRight:"none",height:56*(t.length-1),top:46,left:15},children:(0,n.jsx)(z.Z,{type:"primary",size:"small",style:{position:"absolute",top:"50%",translate:"-50% -50%",padding:"0 3px",cursor:"pointer"},onClick:function(){K(b==="and"?"or":"and")},children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:W[b]}),(0,n.jsx)(te.Z,{type:"ql-icon-d-caret"})]})})}),(0,n.jsxs)("div",{children:[t.map(function(r){var E=r.key,l=r.name,s=B()(r,_e);return(0,n.jsx)(u.Z.Item,{label:l===0?"\u7B5B\u9009\u6761\u4EF6":"",style:{marginBottom:0},required:!0,className:"filter-item",children:(0,n.jsxs)(T.Z,{className:"view-create-modal-filters",align:"baseline",children:[(0,n.jsx)(u.Z.Item,d()(d()({},s),{},{name:[l,"property"],rules:[{required:!0}],children:A(i,{width:90})})),(0,n.jsx)(u.Z.Item,d()(d()({},s),{},{name:[l,"operation"],rules:[{required:!0}],children:N})),(0,n.jsx)(u.Z.Item,d()(d()({},s),{},{name:[l,"value"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9"}],children:re[x[l].operation]==="select"?de(x[l].property):(0,n.jsx)($.Z,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"})})),l!==0&&(0,n.jsx)(G.Z,{onClick:function(){return o(l)}})]})},E)}),(0,n.jsx)(u.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return a({property:"command",operation:"Reg"})},children:[(0,n.jsx)(Y.Z,{}),"\u65B0\u589E\u7B5B\u9009\u6761\u4EF6"]})})]})]})}}),(0,n.jsx)(u.Z.List,{name:"sorts",children:function(t,_){var a=_.add,o=_.remove;return(0,n.jsxs)("div",{style:{position:"relative"},className:"view-filters-container ".concat(t.length>1?"active":""),children:[t.length>1&&(0,n.jsx)("div",{style:{position:"absolute",width:50,borderRadius:10,border:"1px solid rgb(190, 220, 255)",borderRight:"none",height:56*(t.length-1),top:46,left:15},children:(0,n.jsx)(z.Z,{type:"primary",size:"small",style:{position:"absolute",top:"50%",translate:"-50% -50%",padding:"0 3px",cursor:"pointer"},children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("span",{children:W[b]})})})}),(0,n.jsxs)("div",{children:[t.map(function(r){var E=r.key,l=r.name,s=B()(r,ae);return(0,n.jsx)(u.Z.Item,{label:l===0?"\u6392\u5E8F\u65B9\u5F0F":"",style:{marginBottom:0},className:"filter-item",children:(0,n.jsxs)(T.Z,{className:"view-create-modal-sorts",align:"baseline",children:[(0,n.jsx)(u.Z.Item,d()(d()({},s),{},{name:[l,"property"],rules:[{required:!0}],children:A(i)})),(0,n.jsx)(u.Z.Item,d()(d()({},s),{},{name:[l,"type"],rules:[{required:!0}],children:ie})),(0,n.jsx)(G.Z,{onClick:function(){return o(l)}})]})},E)}),(0,n.jsx)(u.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return a({property:"command",type:"ASC"})},children:[(0,n.jsx)(Y.Z,{}),"\u65B0\u589E\u6392\u5E8F\u65B9\u5F0F"]})})]})]})}})]})})};y.default=se},70759:function(ue,y,e){e.r(y);var Z=e(93525),B=e.n(Z),J=e(57213),P=e.n(J),Q=e(54306),d=e.n(Q),X=e(12342),q=e.n(X),M=e(63313),k=e.n(M),I=e(10816),me=e(16672),u=e(33682),v=e(24550),ee=e(32049),$=e(21728),z=e(31625),T=e(96786),F=e(45277),ne=e(97947),G=e(5962),Y=e(12927),te=e(56833),n=e(94701),_e=e(66255),ae=e(66778),i=e(11527),re=["index","moveRow","className","style"],oe=I.Z.Text,H="DragableBodyRow",le=function(c){var h=c.index,g=c.moveRow,L=c.className,C=c.style,S=q()(c,re),U=(0,M.useRef)(),D=(0,Y.L)({accept:H,collect:function(O){var N=O.getItem()||{},A=N.index;return A===h?{}:{isOver:O.isOver(),dropClassName:A<h?" drop-over-downward":" drop-over-upward"}},drop:function(O){g(O.index,h)}}),p=d()(D,2),f=p[0],w=f.isOver,j=f.dropClassName,V=p[1],R=(0,te.c)({type:H,item:{index:h},collect:function(O){return{isDragging:O.isDragging()}}}),b=d()(R,2),K=b[1];return V(K(U)),(0,i.jsx)("tr",P()({ref:U,className:"".concat(L).concat(w?j:""),style:P()({cursor:"move"},C)},S))},W=function(c){var h=c.cronViews,g=c.handleCancel,L=c.visible,C=c.cronViewChange,S=[{title:"\u540D\u79F0",dataIndex:"name",key:"name"},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",render:function(_){return _===1?"\u7CFB\u7EDF":"\u4E2A\u4EBA"}},{title:"\u663E\u793A",key:"isDisabled",dataIndex:"isDisabled",width:100,render:function(_,a,o){return(0,i.jsx)(me.Z,{checked:!a.isDisabled,onChange:function(E){return ie(E,a,o)}})}},{title:"\u64CD\u4F5C",key:"action",width:100,render:function(_,a,o){return a.type!==1?(0,i.jsxs)(u.Z,{size:"middle",children:[(0,i.jsx)("a",{onClick:function(){return N(a,o)},children:(0,i.jsx)(ne.Z,{})}),(0,i.jsx)("a",{onClick:function(){return A(a,o)},children:(0,i.jsx)(G.Z,{})})]}):"-"}}],U=(0,M.useState)([]),D=d()(U,2),p=D[0],f=D[1],w=(0,M.useState)(!1),j=d()(w,2),V=j[0],R=j[1],b=(0,M.useState)(null),K=d()(b,2),x=K[0],O=K[1],N=function(_,a){O(_),R(!0)},A=function(_,a){v.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,i.jsxs)(i.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u89C6\u56FE"," ",(0,i.jsx)(oe,{style:{wordBreak:"break-all"},type:"warning",children:_.name})," ","\u5417"]}),onOk:function(){T.W.delete("".concat(F.Z.apiPrefix,"crons/views"),{data:[_.id]}).then(function(r){var E=r.code,l=r.data;E===200&&(ee.ZP.success("\u5220\u9664\u6210\u529F"),C())})},onCancel:function(){console.log("Cancel")}})},ie=function(_,a,o){T.W.put("".concat(F.Z.apiPrefix,"crons/views/").concat(_?"enable":"disable"),{data:[a.id]}).then(function(r){var E=r.code,l=r.data;if(E===200){var s=B()(p);s.splice(o,1,P()(P()({},p[o]),{},{isDisabled:!_})),f(s),C()}})},de={body:{row:le}},m=(0,M.useCallback)(function(t,_){if(t!==_){var a=p[t];T.W.put("".concat(F.Z.apiPrefix,"crons/views/move"),{data:{fromIndex:t,toIndex:_,id:a.id}}).then(function(o){var r=o.code,E=o.data;if(r===200){var l=B()(p);l.splice(t,1),l.splice(_,0,P()(P()({},a),E)),f(l),C()}})}},[p]);return(0,M.useEffect)(function(){f(h)},[h]),(0,i.jsxs)(v.Z,{title:"\u89C6\u56FE\u7BA1\u7406",open:L,centered:!0,width:620,onCancel:function(){return g()},className:"view-manage-modal",forceRender:!0,footer:!1,maskClosable:!1,children:[(0,i.jsx)(u.Z,{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:(0,i.jsx)($.Z,{type:"primary",onClick:function(){O(null),R(!0)},children:"\u65B0\u5EFA\u89C6\u56FE"},"2")}),(0,i.jsx)(n.W,{backend:_e.PD,children:(0,i.jsx)(z.Z,{bordered:!0,columns:S,pagination:!1,dataSource:p,rowKey:"id",size:"middle",style:{marginBottom:20},components:de,onRow:function(_,a){return{index:a,moveRow:m}}})}),(0,i.jsx)(ae.default,{view:x,visible:V,handleCancel:function(_){R(!1),C(_)}})]})};y.default=W}}]);

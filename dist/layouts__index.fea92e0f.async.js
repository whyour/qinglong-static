"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1717],{2850:function(Q,E,e){var T=e(82878),i=(0,T.Z)({scriptUrl:["//at.alicdn.com/t/c/font_3354854_ob5y15ewlyq.js"]});E.Z=i},96526:function(Q,E,e){e.r(E),e.d(E,{default:function(){return me}});var T=e(30279),i=e.n(T),f=e(46686),j=e.n(f),r=e(63313),P=e(7098),U=e(94080),A=e(71571),Z=e(95752),l=e(2850),t=e(11527),x={route:{routes:[{name:"\u767B\u5F55",path:"/login",hideInMenu:!0,component:"@/pages/login/index"},{name:"\u521D\u59CB\u5316",path:"/initialization",hideInMenu:!0,component:"@/pages/initialization/index"},{name:"\u9519\u8BEF",path:"/error",hideInMenu:!0,component:"@/pages/error/index"},{path:"/crontab",name:"\u5B9A\u65F6\u4EFB\u52A1",icon:(0,t.jsx)(l.Z,{type:"ql-icon-crontab"}),component:"@/pages/crontab/index"},{path:"/subscription",name:"\u8BA2\u9605\u7BA1\u7406",icon:(0,t.jsx)(l.Z,{type:"ql-icon-subs"}),component:"@/pages/subscription/index"},{path:"/env",name:"\u73AF\u5883\u53D8\u91CF",icon:(0,t.jsx)(l.Z,{type:"ql-icon-env"}),component:"@/pages/env/index"},{path:"/config",name:"\u914D\u7F6E\u6587\u4EF6",icon:(0,t.jsx)(l.Z,{type:"ql-icon-config"}),component:"@/pages/config/index"},{path:"/script",name:"\u811A\u672C\u7BA1\u7406",icon:(0,t.jsx)(l.Z,{type:"ql-icon-script"}),component:"@/pages/script/index"},{path:"/dependence",name:"\u4F9D\u8D56\u7BA1\u7406",icon:(0,t.jsx)(l.Z,{type:"ql-icon-dependence"}),component:"@/pages/dependence/index"},{path:"/log",name:"\u65E5\u5FD7\u7BA1\u7406",icon:(0,t.jsx)(l.Z,{type:"ql-icon-log"}),component:"@/pages/log/index"},{path:"/diff",name:"\u5BF9\u6BD4\u5DE5\u5177",icon:(0,t.jsx)(l.Z,{type:"ql-icon-diff"}),component:"@/pages/diff/index"},{path:"/setting",name:"\u7CFB\u7EDF\u8BBE\u7F6E",icon:(0,t.jsx)(Z.Z,{}),component:"@/pages/password/index"}]},navTheme:"light",fixSiderbar:!0,contentWidth:"Fixed",splitMenus:!1,siderWidth:180},c=e(65731),m=e(86107),g=e(4084),S=e(58410),y=e(82639),v=e(41601),C=e(73835),D=e(86563),z=e.n(D),F=e(86754),W=e(15051),R=e(72696),K=e(61135),N=e(8508),G=e(22999),H=e(15336),oe=e(78078),se=e.n(oe),re=e(51628),ie=e(80233),le=e(72842),ue=e(57333),ce=e(6266),de=e(57223);function fe(p){le.S({dsn:"https://3406424fb1dc4813a62d39e844a9d0ac@o1098464.ingest.sentry.io/6122818",integrations:[new ue.jK.gE({shouldCreateSpanForRequest:function(h){return!h.includes("/api/ws")&&!h.includes("/api/static")}})],release:p,tracesSampleRate:.1,beforeBreadcrumb:function(h,I){if(h.data&&h.data.url){var O=h.data.url.replace(/token=.*/,"");h.data.url=O}return h}}),ce._m.config({monaco:de,"vs/nls":{availableLanguages:{"*":"zh-cn"}}})}var Be=e(10280),Ue=e(16581),ze=e(66161);function me(){var p=(0,c.TH)(),M=(0,F.e)(),h=(0,F.F)(),I=h.theme,O=h.reloadTheme,ge=(0,r.useState)({}),J=j()(ge,2),d=J[0],he=J[1],ve=(0,r.useState)(!0),V=j()(ve,2),b=V[0],X=V[1],pe=(0,r.useState)(),Y=j()(pe,2),o=Y[0],xe=Y[1],B=(0,r.useRef)(null),Se=(0,r.useState)(),$=j()(Se,2),ye=$[0],je=$[1],Ce=(0,r.useState)(!1),w=j()(Ce,2),Ee=w[0],q=w[1],Me=(0,r.useState)(!0),_=j()(Me,2),Te=_[0],Ze=_[1],L=A||{},Fe=L.enable,ee=L.disable,We=L.exportGeneratedCSS,Ie=L.setFetchMethod,Le=L.auto,Pe=function(){C.W.post("".concat(v.Z.apiPrefix,"user/logout")).then(function(){localStorage.removeItem(v.Z.authKey),c.m8.push("/login")})},Ae=function(){C.W.get("".concat(v.Z.apiPrefix,"system")).then(function(n){var s=n.code,u=n.data;s===200&&(xe(u),u.isInitialized?(fe(u.version),k()):c.m8.push("/initialization"))}).catch(function(n){console.log(n)}).finally(function(){return Ze(!1)})},k=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n&&X(!0),C.W.get("".concat(v.Z.apiPrefix,"user")).then(function(s){var u=s.code,ae=s.data;u===200&&ae.username&&(he(ae),p.pathname==="/"&&c.m8.push("/crontab")),n&&X(!1)}).catch(function(s){console.log(s)})},te=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;k(n)};if((0,r.useEffect)(function(){o&&o.isInitialized&&!d&&k()},[p.pathname]),(0,r.useEffect)(function(){o||Ae()},[o]),(0,r.useEffect)(function(){I==="vs-dark"?document.body.setAttribute("data-dark","true"):document.body.setAttribute("data-dark","false")},[I]),(0,r.useEffect)(function(){z()();var a=localStorage.getItem("qinglong_dark_theme")||"auto";if(typeof window!="undefined"&&typeof window.matchMedia!="undefined")return A?(Ie(fetch),a==="dark"?Fe({}):a==="light"?ee():Le({}),function(){ee()}):function(){return null}},[]),(0,r.useEffect)(function(){if(!(!d||!d.username)){B.current=new(se())("".concat(window.location.origin,"/api/ws?token=").concat(localStorage.getItem(v.Z.authKey))),B.current.onmessage=function(n){try{var s=JSON.parse(n.data);s.type==="ping"&&(s&&s.message==="hanhh"?console.log("WS connection succeeded !!!"):console.log("WS connection Failed !!!",n)),je(s)}catch(u){console.log("websocket\u8FDE\u63A5\u5931\u8D25",n)}};var a=B.current;return function(){a.close()}}},[d]),(0,r.useEffect)(function(){window.onload=function(){var a=performance.timing;console.log("\u767D\u5C4F\u65F6\u95F4: ".concat(a.responseStart-a.navigationStart)),console.log("\u8BF7\u6C42\u5B8C\u6BD5\u81F3DOM\u52A0\u8F7D: ".concat(a.domInteractive-a.responseEnd)),console.log("\u89E3\u91CAdom\u6811\u8017\u65F6: ".concat(a.domComplete-a.domInteractive)),console.log("\u4ECE\u5F00\u59CB\u81F3load\u603B\u8017\u65F6: ".concat(a.loadEventEnd-a.navigationStart)),re.uT("\u767D\u5C4F\u65F6\u95F4 ".concat(a.responseStart-a.navigationStart))}},[]),Te)return(0,t.jsx)(P.Z,{});if(["/login","/initialization","/error"].includes(p.pathname)&&(document.title="".concat(v.Z.documentTitleMap[p.pathname]," - \u63A7\u5236\u9762\u677F"),o!=null&&o.isInitialized&&p.pathname==="/initialization"&&c.m8.push("/crontab"),o||p.pathname==="/error"))return(0,t.jsx)(c.j3,{context:i()(i()({},M),{},{theme:I,user:d,reloadUser:te,reloadTheme:O,ws:B.current})});var De=navigator.userAgent.includes("Firefox"),Re=navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"),Oe=navigator.userAgent.includes("QQBrowser"),ne=(0,t.jsx)(W.Z,{className:"side-menu-user-drop-menu",items:[{label:"\u9000\u51FA\u767B\u5F55",key:"logout",icon:(0,t.jsx)(m.Z,{})}],onClick:Pe});return b?(0,t.jsx)(P.Z,{}):(0,t.jsx)(U.ZP,i()(i()({selectedKeys:[p.pathname],loading:b,ErrorBoundary:ie.SV,logo:(0,t.jsx)(R.Z,{preview:!1,src:"https://qn.whyour.cn/logo.png"}),title:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{style:{fontSize:16},children:"\u63A7\u5236\u9762\u677F"}),(0,t.jsx)("a",{href:o==null?void 0:o.changeLogLink,target:"_blank",rel:"noopener noreferrer",onClick:function(n){n.stopPropagation()},children:(0,t.jsx)(K.Z,{title:(o==null?void 0:o.branch)==="develop"?"\u5F00\u53D1\u7248":"\u6B63\u5F0F\u7248",children:(0,t.jsx)(N.Z,{size:"small",dot:(o==null?void 0:o.branch)==="develop",children:(0,t.jsxs)("span",{style:{fontSize:De?9:12,color:"#666",marginLeft:2,zoom:Re?.66:.8,letterSpacing:Oe?-2:0},children:["v",o==null?void 0:o.version]})})})})]}),menuItemRender:function(n,s){return n.isUrl||!n.path||p.pathname===n.path?s:(0,t.jsx)(c.rU,{to:n.path,children:s})},pageTitleRender:function(n,s,u){return u&&typeof u.pageName=="string"?"".concat(u.pageName," - \u63A7\u5236\u9762\u677F"):"\u63A7\u5236\u9762\u677F"},onCollapse:q,collapsed:Ee,rightContentRender:function(){return M.isPhone&&(0,t.jsx)(G.Z,{overlay:ne,placement:"bottomRight",trigger:["click"],children:(0,t.jsxs)("span",{className:"side-menu-user-wrapper",children:[(0,t.jsx)(H.C,{shape:"square",size:"small",icon:(0,t.jsx)(g.Z,{}),src:d.avatar?"/api/static/".concat(d.avatar):""}),(0,t.jsx)("span",{style:{marginLeft:5},children:d.username})]})})},collapsedButtonRender:function(n){return(0,t.jsxs)("span",{className:"side-menu-container",onClick:function(u){u.preventDefault(),u.stopPropagation()},children:[!n&&!M.isPhone&&(0,t.jsx)(G.Z,{overlay:ne,placement:"topLeft",trigger:["hover"],children:(0,t.jsxs)("span",{className:"side-menu-user-wrapper",children:[(0,t.jsx)(H.C,{shape:"square",size:"small",icon:(0,t.jsx)(g.Z,{}),src:d.avatar?"/api/static/".concat(d.avatar):""}),(0,t.jsx)("span",{style:{marginLeft:5},children:d.username})]})}),(0,t.jsx)("span",{className:"side-menu-collapse-button",onClick:function(){return q(!n)},children:n?(0,t.jsx)(S.Z,{}):(0,t.jsx)(y.Z,{})})]})}},x),{},{children:(0,t.jsx)(c.j3,{context:i()(i()({},M),{},{theme:I,user:d,reloadUser:te,reloadTheme:O,socketMessage:ye,systemInfo:o})})}))}},86754:function(Q,E,e){e.d(E,{F:function(){return U},e:function(){return P}});var T=e(46686),i=e.n(T),f=e(63313),j=e.n(f),r=e(48388),P=function(){var Z=(0,f.useState)("100%"),l=i()(Z,2),t=l[0],x=l[1],c=(0,f.useState)(0),m=i()(c,2),g=m[0],S=m[1],y=(0,f.useState)(-72),v=i()(y,2),C=v[0],D=v[1],z=(0,f.useState)(!1),F=i()(z,2),W=F[0],R=F[1],K=(0,f.useMemo)(function(){return(0,r.ZP)()},[]),N=K.platform;return(0,f.useEffect)(function(){N==="mobile"&&document.body.offsetWidth<768?(x("auto"),S(0),D(0),R(!0)):(x("100%"),S(0),D(-72),R(!1))},[]),{headerStyle:{padding:"4px 16px 4px 15px",position:"sticky",top:0,left:0,zIndex:20,marginTop:C,width:t,marginLeft:g},isPhone:W}},U=function(){var Z=(0,f.useState)(),l=i()(Z,2),t=l[0],x=l[1],c=function(){var g=window.matchMedia("(prefers-color-scheme: dark)"),S=localStorage.getItem("qinglong_dark_theme"),y=g.matches&&S!=="light"||S==="dark";x(y?"vs-dark":"vs")};return(0,f.useEffect)(function(){var m=window.matchMedia("(prefers-color-scheme: dark)"),g=localStorage.getItem("qinglong_dark_theme"),S=m.matches&&g!=="light"||g==="dark";x(S?"vs-dark":"vs");var y=function(C){(g==="auto"||!g)&&(C.matches?x("vs-dark"):x("vs"))};typeof m.addEventListener=="function"?m.addEventListener("change",y):typeof m.addListener=="function"&&m.addListener(y)},[]),{theme:t,reloadTheme:c}}}}]);

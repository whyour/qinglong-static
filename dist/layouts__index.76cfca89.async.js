"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1717],{86755:function(Q,P,e){var M=e(55258),u=(0,M.Z)({scriptUrl:["//at.alicdn.com/t/c/font_3354854_ob5y15ewlyq.js"]});P.Z=u},10966:function(Q,P,e){e.r(P),e.d(P,{default:function(){return fe}});var M=e(57213),u=e.n(M),f=e(54306),y=e.n(f),s=e(88265),l=e(63313),D=e(91796),z=e(40221),C=e(71571),Z=e(68834),c=e(86755),t=e(11527),T={route:{routes:[{name:s.ZP.get("\u767B\u5F55"),path:"/login",hideInMenu:!0,component:"@/pages/login/index"},{name:s.ZP.get("\u521D\u59CB\u5316"),path:"/initialization",hideInMenu:!0,component:"@/pages/initialization/index"},{name:s.ZP.get("\u9519\u8BEF"),path:"/error",hideInMenu:!0,component:"@/pages/error/index"},{path:"/crontab",name:s.ZP.get("\u5B9A\u65F6\u4EFB\u52A1"),icon:(0,t.jsx)(c.Z,{type:"ql-icon-crontab"}),component:"@/pages/crontab/index"},{path:"/subscription",name:s.ZP.get("\u8BA2\u9605\u7BA1\u7406"),icon:(0,t.jsx)(c.Z,{type:"ql-icon-subs"}),component:"@/pages/subscription/index"},{path:"/env",name:s.ZP.get("\u73AF\u5883\u53D8\u91CF"),icon:(0,t.jsx)(c.Z,{type:"ql-icon-env"}),component:"@/pages/env/index"},{path:"/config",name:s.ZP.get("\u914D\u7F6E\u6587\u4EF6"),icon:(0,t.jsx)(c.Z,{type:"ql-icon-config"}),component:"@/pages/config/index"},{path:"/script",name:s.ZP.get("\u811A\u672C\u7BA1\u7406"),icon:(0,t.jsx)(c.Z,{type:"ql-icon-script"}),component:"@/pages/script/index"},{path:"/dependence",name:s.ZP.get("\u4F9D\u8D56\u7BA1\u7406"),icon:(0,t.jsx)(c.Z,{type:"ql-icon-dependence"}),component:"@/pages/dependence/index"},{path:"/log",name:s.ZP.get("\u65E5\u5FD7\u7BA1\u7406"),icon:(0,t.jsx)(c.Z,{type:"ql-icon-log"}),component:"@/pages/log/index"},{path:"/diff",name:s.ZP.get("\u5BF9\u6BD4\u5DE5\u5177"),icon:(0,t.jsx)(c.Z,{type:"ql-icon-diff"}),component:"@/pages/diff/index"},{path:"/setting",name:s.ZP.get("\u7CFB\u7EDF\u8BBE\u7F6E"),icon:(0,t.jsx)(Z.Z,{}),component:"@/pages/password/index"}]},navTheme:"light",fixSiderbar:!0,contentWidth:"Fixed",splitMenus:!1,siderWidth:180},i=e(98074),h=e(50988),v=e(3513),S=e(63386),L=e(85153),g=e(5558),j=e(95176),K=e(86563),O=e.n(K),A=e(62753),R=e(12094),N=e(15367),k=e(13217),H=e(34133),G=e(83535),oe=e(78078),se=e.n(oe),ie=e(45638),re=e(79516),le=e(42078),ue=e(25940),ce=e(82755);function de(p){le.S({dsn:"https://3406424fb1dc4813a62d39e844a9d0ac@o1098464.ingest.sentry.io/6122818",integrations:[new ue.jK.BrowserTracing({shouldCreateSpanForRequest:function(m){return!m.includes("/api/ws")&&!m.includes("/api/static")}})],release:p,tracesSampleRate:.1,beforeBreadcrumb:function(m,I){if(m.data&&m.data.url){var B=m.data.url.replace(/token=.*/,"");m.data.url=B}return m}}),ce._m.config({paths:{vs:"https://cdn.staticfile.org/monaco-editor/0.33.0/min/vs"},"vs/nls":{availableLanguages:{"*":"zh-cn"}}})}var Be=e(23836),Ue=e(34637),We=e(85797);function fe(){var p=(0,i.useLocation)(),E=(0,A.e)(),m=(0,A.F)(),I=m.theme,B=m.reloadTheme,ge=(0,l.useState)({}),J=y()(ge,2),d=J[0],me=J[1],he=(0,l.useState)(!0),V=y()(he,2),$=V[0],X=V[1],ve=(0,l.useState)(),Y=y()(ve,2),r=Y[0],pe=Y[1],U=(0,l.useRef)(null),xe=(0,l.useState)(),w=y()(xe,2),Se=w[0],ye=w[1],Ze=(0,l.useState)(!1),q=y()(Ze,2),je=q[0],_=q[1],Pe=(0,l.useState)(!0),ee=y()(Pe,2),Ce=ee[0],Ee=ee[1],F=C||{},Me=F.enable,te=F.disable,ze=F.exportGeneratedCSS,Te=F.setFetchMethod,Le=F.auto,Ie=function(){j.W.post("".concat(g.Z.apiPrefix,"user/logout")).then(function(){localStorage.removeItem(g.Z.authKey),i.history.push("/login")})},Fe=function(){j.W.get("".concat(g.Z.apiPrefix,"system")).then(function(n){var o=n.code,x=n.data;o===200&&(pe(x),x.isInitialized?(de(x.version),b()):i.history.push("/initialization"))}).catch(function(n){console.log(n)})},b=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n&&X(!0),j.W.get("".concat(g.Z.apiPrefix,"user")).then(function(o){var x=o.code,W=o.data;x===200&&W.username&&(me(W),p.pathname==="/"&&i.history.push("/crontab")),n&&X(!1)}).catch(function(o){console.log(o)})},De=function(){j.W.get("".concat(g.Z.apiPrefix,"public/health")).then(function(n){var o;(n==null||(o=n.data)===null||o===void 0?void 0:o.status)===1?Fe():i.history.push("/error")}).catch(function(n){i.history.push("/error")}).finally(function(){return Ee(!1)})},ne=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;b(n)};if((0,l.useEffect)(function(){r&&r.isInitialized&&!d&&b()},[p.pathname]),(0,l.useEffect)(function(){De()},[]),(0,l.useEffect)(function(){I==="vs-dark"?document.body.setAttribute("data-dark","true"):document.body.setAttribute("data-dark","false")},[I]),(0,l.useEffect)(function(){O()();var a=localStorage.getItem("qinglong_dark_theme")||"auto";if(typeof window!="undefined"&&typeof window.matchMedia!="undefined")return C?(Te(fetch),a==="dark"?Me({}):a==="light"?te():Le({}),function(){te()}):function(){return null}},[]),(0,l.useEffect)(function(){if(!(!d||!d.username)){U.current=new(se())("".concat(window.location.origin,"/api/ws?token=").concat(localStorage.getItem(g.Z.authKey))),U.current.onmessage=function(n){try{var o=JSON.parse(n.data);o.type==="ping"&&(o&&o.message==="hanhh"?console.log("WS connection succeeded !!!"):console.log("WS connection Failed !!!",n)),ye(o)}catch(x){console.log("websocket\u8FDE\u63A5\u5931\u8D25",n)}};var a=U.current;return function(){a.close()}}},[d]),(0,l.useEffect)(function(){window.onload=function(){var a=performance.timing;console.log("\u767D\u5C4F\u65F6\u95F4: ".concat(a.responseStart-a.navigationStart)),console.log("\u8BF7\u6C42\u5B8C\u6BD5\u81F3DOM\u52A0\u8F7D: ".concat(a.domInteractive-a.responseEnd)),console.log("\u89E3\u91CAdom\u6811\u8017\u65F6: ".concat(a.domComplete-a.domInteractive)),console.log("\u4ECE\u5F00\u59CB\u81F3load\u603B\u8017\u65F6: ".concat(a.loadEventEnd-a.navigationStart)),ie.uT("\u767D\u5C4F\u65F6\u95F4 ".concat(a.responseStart-a.navigationStart))}},[]),Ce)return(0,t.jsx)(D.Z,{});if(["/login","/initialization","/error"].includes(p.pathname)&&(r!=null&&r.isInitialized&&p.pathname==="/initialization"&&i.history.push("/crontab"),r||p.pathname==="/error"))return(0,t.jsx)(i.Outlet,{context:u()(u()({},E),{},{theme:I,user:d,reloadUser:ne,reloadTheme:B,ws:U.current})});var Oe=navigator.userAgent.includes("Firefox"),Ae=navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"),Re=navigator.userAgent.includes("QQBrowser"),ae={items:[{label:s.ZP.get("\u9000\u51FA\u767B\u5F55"),className:"side-menu-user-drop-menu",onClick:Ie,key:"logout",icon:(0,t.jsx)(h.Z,{})}]};return $?(0,t.jsx)(D.Z,{}):(0,t.jsx)(z.ZP,u()(u()({selectedKeys:[p.pathname],loading:$,ErrorBoundary:re.SV,logo:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(R.Z,{preview:!1,src:"https://qn.whyour.cn/logo.png"}),(0,t.jsxs)("div",{className:"title",children:[(0,t.jsx)("span",{className:"title",children:s.ZP.get("\u9752\u9F99")}),(0,t.jsx)("a",{href:r==null?void 0:r.changeLogLink,target:"_blank",rel:"noopener noreferrer",onClick:function(n){n.stopPropagation()},children:(0,t.jsx)(N.Z,{title:(r==null?void 0:r.branch)==="develop"?s.ZP.get("\u5F00\u53D1\u7248"):s.ZP.get("\u6B63\u5F0F\u7248"),children:(0,t.jsx)(k.Z,{size:"small",dot:(r==null?void 0:r.branch)==="develop",children:(0,t.jsxs)("span",{style:{fontSize:Oe?9:12,color:"#666",marginLeft:2,zoom:Ae?.66:.8,letterSpacing:Re?-2:0},children:["v",r==null?void 0:r.version]})})})})]})]}),title:!1,menuItemRender:function(n,o){return n.isUrl||!n.path||p.pathname===n.path?o:(0,t.jsx)(i.Link,{to:n.path,children:o})},pageTitleRender:function(n,o,x){var W=g.Z.documentTitleMap[p.pathname]||s.ZP.get("\u672A\u627E\u5230");return"".concat(W," - ").concat(s.ZP.get("\u9752\u9F99"))},onCollapse:_,collapsed:je,rightContentRender:function(){return E.isPhone&&(0,t.jsx)(H.Z,{menu:ae,placement:"bottomRight",trigger:["click"],children:(0,t.jsxs)("span",{className:"side-menu-user-wrapper",children:[(0,t.jsx)(G.C,{shape:"square",size:"small",icon:(0,t.jsx)(v.Z,{}),src:d.avatar?"/api/static/".concat(d.avatar):""}),(0,t.jsx)("span",{style:{marginLeft:5},children:d.username})]})})},collapsedButtonRender:function(n){return(0,t.jsxs)("span",{className:"side-menu-container",onClick:function(x){x.preventDefault(),x.stopPropagation()},children:[!n&&!E.isPhone&&(0,t.jsx)(H.Z,{menu:ae,placement:"topLeft",trigger:["hover"],children:(0,t.jsxs)("span",{className:"side-menu-user-wrapper",children:[(0,t.jsx)(G.C,{shape:"square",size:"small",icon:(0,t.jsx)(v.Z,{}),src:d.avatar?"/api/static/".concat(d.avatar):""}),(0,t.jsx)("span",{style:{marginLeft:5},children:d.username})]})}),(0,t.jsx)("span",{className:"side-menu-collapse-button",onClick:function(){return _(!n)},children:n?(0,t.jsx)(S.Z,{}):(0,t.jsx)(L.Z,{})})]})}},T),{},{children:(0,t.jsx)(i.Outlet,{context:u()(u()({},E),{},{theme:I,user:d,reloadUser:ne,reloadTheme:B,socketMessage:Se,systemInfo:r})})}))}},62753:function(Q,P,e){e.d(P,{F:function(){return D},e:function(){return l}});var M=e(54306),u=e.n(M),f=e(63313),y=e.n(f),s=e(82428),l=function(){var C=(0,f.useState)("100%"),Z=u()(C,2),c=Z[0],t=Z[1],T=(0,f.useState)(0),i=u()(T,2),h=i[0],v=i[1],S=(0,f.useState)(-48),L=u()(S,2),g=L[0],j=L[1],K=(0,f.useState)(!1),O=u()(K,2),A=O[0],R=O[1],N=(0,f.useMemo)(function(){return(0,s.ZP)()},[]),k=N.platform;return(0,f.useEffect)(function(){k==="mobile"&&document.body.offsetWidth<768?(t("auto"),v(0),j(0),R(!0),document.body.setAttribute("data-mode","phone")):(t("100%"),v(0),j(-48),R(!1),document.body.setAttribute("data-mode","desktop"))},[]),{headerStyle:{padding:"4px 16px 4px 15px",position:"sticky",top:0,left:0,zIndex:20,marginTop:g,width:c,marginLeft:h},isPhone:A}},D=function(){var C=(0,f.useState)(),Z=u()(C,2),c=Z[0],t=Z[1],T=function(){var h=window.matchMedia("(prefers-color-scheme: dark)"),v=localStorage.getItem("qinglong_dark_theme"),S=h.matches&&v!=="light"||v==="dark";t(S?"vs-dark":"vs")};return(0,f.useEffect)(function(){var i=window.matchMedia("(prefers-color-scheme: dark)"),h=localStorage.getItem("qinglong_dark_theme"),v=i.matches&&h!=="light"||h==="dark";t(v?"vs-dark":"vs");var S=function(g){(h==="auto"||!h)&&(g.matches?t("vs-dark"):t("vs"))};typeof i.addEventListener=="function"?i.addEventListener("change",S):typeof i.addListener=="function"&&i.addListener(S)},[]),{theme:c,reloadTheme:T}}}}]);

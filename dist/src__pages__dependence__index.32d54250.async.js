(self.webpackChunk=self.webpackChunk||[]).push([[9914],{20209:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(14797),r=n(63313),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},c=n(46420),s=function(e,t){return r.createElement(c.Z,(0,i.Z)((0,i.Z)({},e),{},{ref:t,icon:a}))};s.displayName="ClockCircleOutlined";var o=r.forwardRef(s)},13740:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(14797),r=n(63313),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},c=n(46420),s=function(e,t){return r.createElement(c.Z,(0,i.Z)((0,i.Z)({},e),{},{ref:t,icon:a}))};s.displayName="DeleteOutlined";var o=r.forwardRef(s)},66150:function(e,t,n){"use strict";var i=n(54306),r=n.n(i),a=n(63313),c=n(61761),s=n(82428);t.Z=function(e,t){var n=(0,a.useState)(0),i=r()(n,2),o=i[0],u=i[1];return(0,c.Z)(e,(function(e){var n=e.target;n.classList.contains("ant-table-wrapper")||(n=e.target.querySelector(".ant-table-wrapper")),u((0,s.W9)({extraHeight:t,target:n}))})),o}},16648:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ee}});var i=n(93525),r=n.n(i),a=n(54306),c=n.n(a),s=n(57213),o=n.n(s),u=n(88265),l=n(63313),d=n(92260),f=n(22159),h=n(2947),g=n(51704),p=n(15367),m=n(84163),v=n(24378),Z=n(86986),x=n(94674),y=n(14797),$={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},j=n(46420),w=function(e,t){return l.createElement(j.Z,(0,y.Z)((0,y.Z)({},e),{},{ref:t,icon:$}))};w.displayName="SyncOutlined";var S=l.forwardRef(w),P=n(38101),M=n(76657),k=n(20209),D={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},C=function(e,t){return l.createElement(j.Z,(0,y.Z)((0,y.Z)({},e),{},{ref:t,icon:D}))};C.displayName="FileTextOutlined";var b=l.forwardRef(C),H={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1a184.31 184.31 0 00-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9a184.31 184.31 0 00-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8a63 63 0 01-63 63H232a63 63 0 01-63-63c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5.2 13 .7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7a273 273 0 0022.7 49c24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2a281.38 281.38 0 00123.2-149.5A120 120 0 01836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7.4-6.4.7-12.8.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3C584 874.3 548.8 884 512 884s-72-9.7-102.9-27.8c-30.3-17.7-55.6-43-73.3-73.3A202.75 202.75 0 01308 680V412h408v268z"}}]},name:"bug",theme:"outlined"},O=function(e,t){return l.createElement(j.Z,(0,y.Z)((0,y.Z)({},e),{},{ref:t,icon:H}))};O.displayName="BugOutlined";var z=l.forwardRef(O),I=n(13740),W={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 256H736v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zm-200 0H360v-72h304v72z"}}]},name:"delete",theme:"filled"},Y=function(e,t){return l.createElement(j.Z,(0,y.Z)((0,y.Z)({},e),{},{ref:t,icon:W}))};Y.displayName="DeleteFilled";var L=l.forwardRef(Y),_=n(5558),A=n(78969),T=n(95176),F=n(52739),B=n(33328),N=n(66255),E=n(47549),V=n(98074),R=n(66150),q=n(52053),J=n.n(q),U=n(11527),K=d.Z.Text,G=f.Z.Search,Q=function(e){return e[e["安装中"]=0]="安装中",e[e["已安装"]=1]="已安装",e[e["安装失败"]=2]="安装失败",e[e["删除中"]=3]="删除中",e[e["已删除"]=4]="已删除",e[e["删除失败"]=5]="删除失败",e[e["队列中"]=6]="队列中",e}(Q||{}),X={0:{icon:(0,U.jsx)(S,{spin:!0}),color:"processing"},1:{icon:(0,U.jsx)(P.Z,{}),color:"success"},2:{icon:(0,U.jsx)(M.Z,{}),color:"error"},3:{icon:(0,U.jsx)(S,{spin:!0}),color:"processing"},4:{icon:(0,U.jsx)(P.Z,{}),color:"success"},5:{icon:(0,U.jsx)(M.Z,{}),color:"error"},6:{icon:(0,U.jsx)(k.Z,{}),color:"default"}},ee=function(){var e=(0,V.useOutletContext)(),t=e.headerStyle,n=e.isPhone,i=e.socketMessage,a=[{title:u.ZP.get("序号"),width:80,render:function(e,t,n){return(0,U.jsxs)("span",{style:{cursor:"text"},children:[n+1," "]})}},{title:u.ZP.get("名称"),dataIndex:"name",width:120,key:"name"},{title:u.ZP.get("状态"),key:"status",width:120,dataIndex:"status",render:function(e,t,n){return(0,U.jsx)(h.Z,{size:"middle",style:{cursor:"text"},children:(0,U.jsx)(g.Z,{color:X[t.status].color,icon:X[t.status].icon,style:{marginRight:0},children:u.ZP.get(Q[t.status])})})}},{title:u.ZP.get("备注"),dataIndex:"remark",width:120,key:"remark"},{title:u.ZP.get("更新时间"),key:"updatedAt",dataIndex:"updatedAt",width:150,render:function(e){return(0,U.jsx)("span",{children:J()(e).format("YYYY-MM-DD HH:mm:ss")})}},{title:u.ZP.get("创建时间"),key:"createdAt",dataIndex:"createdAt",width:150,render:function(e){return(0,U.jsx)("span",{children:J()(e).format("YYYY-MM-DD HH:mm:ss")})}},{title:u.ZP.get("操作"),key:"action",width:150,render:function(e,t,i){var r=!n;return(0,U.jsxs)(h.Z,{size:"middle",children:[(0,U.jsx)(p.Z,{title:r?u.ZP.get("日志"):"",children:(0,U.jsx)("a",{onClick:function(){ue(o()(o()({},t),{},{timestamp:Date.now()}))},children:(0,U.jsx)(b,{})})}),t.status!==Q.安装中&&t.status!==Q.删除中&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(p.Z,{title:r?u.ZP.get("重新安装"):"",children:(0,U.jsx)("a",{onClick:function(){return je(t,i)},children:(0,U.jsx)(z,{})})}),(0,U.jsx)(p.Z,{title:r?u.ZP.get("删除"):"",children:(0,U.jsx)("a",{onClick:function(){return $e(t,i)},children:(0,U.jsx)(I.Z,{})})}),(0,U.jsx)(p.Z,{title:r?u.ZP.get("强制删除"):"",children:(0,U.jsx)("a",{onClick:function(){return $e(t,i,!0)},children:(0,U.jsx)(L,{})})})]})]})}}],s=(0,l.useState)([]),d=c()(s,2),f=d[0],y=d[1],$=(0,l.useState)(!0),j=c()($,2),w=j[0],S=j[1],P=(0,l.useState)(!1),M=c()(P,2),k=M[0],D=M[1],C=(0,l.useState)(),H=c()(C,2),O=H[0],W=H[1],Y=(0,l.useState)([]),q=c()(Y,2),ee=q[0],te=q[1],ne=(0,l.useState)(""),ie=c()(ne,2),re=ie[0],ae=ie[1],ce=(0,l.useState)(),se=c()(ce,2),oe=se[0],ue=se[1],le=(0,l.useState)(!1),de=c()(le,2),fe=de[0],he=de[1],ge=(0,l.useState)("nodejs"),pe=c()(ge,2),me=pe[0],ve=pe[1],Ze=(0,l.useRef)(null),xe=(0,R.Z)(Ze,59),ye=function(){S(!0),T.W.get("".concat(_.Z.apiPrefix,"dependencies?searchValue=").concat(re,"&type=").concat(me)).then((function(e){var t=e.code,n=e.data;200===t&&y(n)})).finally((function(){return S(!1)}))},$e=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];m.Z.confirm({title:u.ZP.get("确认删除"),content:(0,U.jsxs)(U.Fragment,{children:[u.ZP.get("确认删除依赖")," ",(0,U.jsx)(K,{style:{wordBreak:"break-all"},type:"warning",children:e.name})," ",u.ZP.get("吗")]}),onOk:function(){T.W.delete("".concat(_.Z.apiPrefix,"dependencies").concat(n?"/force":""),{data:[e.id]}).then((function(e){var t=e.code,i=e.data;if(200===t&&n){var a=f.findIndex((function(e){return e.id===i[0].id}));if(-1!==a){var c=r()(f);c.splice(a,1),y(c)}}}))},onCancel:function(){console.log("Cancel")}})},je=function(e,t){m.Z.confirm({title:u.ZP.get("确认重新安装"),content:(0,U.jsxs)(U.Fragment,{children:[u.ZP.get("确认重新安装")," ",(0,U.jsx)(K,{style:{wordBreak:"break-all"},type:"warning",children:e.name})," ",u.ZP.get("吗")]}),onOk:function(){T.W.put("".concat(_.Z.apiPrefix,"dependencies/reinstall"),[e.id]).then((function(e){var t=e.code,n=e.data;200===t&&we(n[0])}))},onCancel:function(){console.log("Cancel")}})},we=function(e){var t=r()(f);if(Array.isArray(e))t.unshift.apply(t,r()(e));else{var n=f.findIndex((function(t){return t.id===e.id}));-1!==n&&t.splice(n,1,o()({},e))}y(t)},Se={selectedRowKeys:ee,onChange:function(e){te(e)}},Pe=function(e){var t=e?"/force":"";m.Z.confirm({title:u.ZP.get("确认删除"),content:(0,U.jsx)(U.Fragment,{children:u.ZP.get("确认删除选中的依赖吗")}),onOk:function(){T.W.delete("".concat(_.Z.apiPrefix,"dependencies").concat(t),{data:ee}).then((function(e){var t=e.code;e.data;200===t&&(te([]),ye())}))},onCancel:function(){console.log("Cancel")}})};(0,l.useEffect)((function(){ye()}),[re,me]),(0,l.useEffect)((function(){oe&&(localStorage.setItem("logDependence",oe.id),he(!0))}),[oe]),(0,l.useEffect)((function(){if(i){var e=i.type,t=i.message,n=i.references;if("installDependence"===e&&t.includes("开始时间")&&n.length>0){for(var a=r()(f),c=function(e){var i=f.findIndex((function(t){return t.id===n[e]}));-1!==i&&a.splice(i,1,o()(o()({},f[i]),{},{status:t.includes("安装")?Q.安装中:Q.删除中}))},s=0;s<n.length;s++)c(s);y(a)}if("installDependence"===e&&t.includes("结束时间")&&n.length>0){var u;u=t.includes("安装")?t.includes("成功")?Q.已安装:Q.安装失败:t.includes("成功")?Q.已删除:Q.删除失败;for(var l=r()(f),d=function(e){var t=f.findIndex((function(t){return t.id===n[e]}));-1!==t&&l.splice(t,1,o()(o()({},f[t]),{},{status:u}))},h=0;h<n.length;h++)d(h);y(l),u===Q.已删除&&setTimeout((function(){for(var e=r()(f),t=function(t){var i=f.findIndex((function(e){return e.id===n[t]}));-1!==i&&e.splice(i,1)},i=0;i<n.length;i++)t(i);y(e)}),5e3)}}}),[i]);return(0,U.jsxs)(A.ZP,{className:"ql-container-wrapper dependence-wrapper ql-container-wrapper-has-tab",title:u.ZP.get("依赖管理"),extra:[(0,U.jsx)(G,{placeholder:u.ZP.get("请输入名称"),style:{width:"auto"},enterButton:!0,loading:w,onSearch:function(e){ae(e.trim())}}),(0,U.jsx)(v.Z,{type:"primary",onClick:function(){return W(null),void D(!0)},children:u.ZP.get("创建依赖")},"2")],header:{style:t},children:[(0,U.jsx)(Z.Z,{defaultActiveKey:"nodejs",size:"small",tabPosition:"top",onChange:function(e){te([]),ve(e)},items:[{key:"nodejs",label:"NodeJs"},{key:"python3",label:"Python3"},{key:"linux",label:"Linux"}]}),(0,U.jsxs)("div",{ref:Ze,children:[ee.length>0&&(0,U.jsxs)("div",{style:{marginBottom:16},children:[(0,U.jsx)(v.Z,{type:"primary",style:{marginBottom:5,marginLeft:8},onClick:function(){m.Z.confirm({title:u.ZP.get("确认重新安装"),content:(0,U.jsx)(U.Fragment,{children:u.ZP.get("确认重新安装选中的依赖吗")}),onOk:function(){T.W.put("".concat(_.Z.apiPrefix,"dependencies/reinstall"),ee).then((function(e){var t=e.code;e.data,200===t&&(te([]),ye())}))},onCancel:function(){console.log("Cancel")}})},children:u.ZP.get("批量安装")}),(0,U.jsx)(v.Z,{type:"primary",style:{marginBottom:5,marginLeft:8},onClick:function(){return Pe(!1)},children:u.ZP.get("批量删除")}),(0,U.jsx)(v.Z,{type:"primary",style:{marginBottom:5,marginLeft:8},onClick:function(){return Pe(!0)},children:u.ZP.get("批量强制删除")}),(0,U.jsxs)("span",{style:{marginLeft:8},children:[u.ZP.get("已选择"),(0,U.jsx)("a",{children:null==ee?void 0:ee.length}),u.ZP.get("项")]})]}),(0,U.jsx)(B.W,{backend:N.PD,children:(0,U.jsx)(x.Z,{columns:a,rowSelection:Se,pagination:!1,dataSource:f,rowKey:"id",size:"middle",scroll:{x:768,y:xe},loading:w})})]}),(0,U.jsx)(F.default,{visible:k,handleCancel:function(e){D(!1),e&&we(e)},dependence:O,defaultType:me}),(0,U.jsx)(E.default,{visible:fe,handleCancel:function(e){if(he(!1),e){var t=f.findIndex((function(e){return e.id===oe.id})),n=r()(f);-1!==t&&(n.splice(t,1),y(n))}else r()(f).map((function(e){return e.id})).includes(oe.id)&&function(e){T.W.get("".concat(_.Z.apiPrefix,"dependencies/").concat(e.id)).then((function(t){var n=t.code,i=t.data;if(200===n){var a=f.findIndex((function(t){return t.id===e.id})),c=r()(f);-1!==a&&(c.splice(a,1,o()(o()({},e),i)),y(c))}})).finally((function(){return S(!1)}))}(oe)},socketMessage:i,dependence:oe})]})}},47549:function(e,t,n){"use strict";n.r(t);var i=n(54306),r=n.n(i),a=n(88265),c=n(63313),s=n(84163),o=n(24378),u=n(95176),l=n(5558),d=n(65601),f=n(38101),h=n(91796),g=n(99120),p=n.n(g),m=n(11527);t.default=function(e){var t=e.dependence,n=e.handleCancel,i=e.visible,g=e.socketMessage,v=(0,c.useState)(""),Z=r()(v,2),x=Z[0],y=Z[1],$=(0,c.useState)(!0),j=r()($,2),w=j[0],S=j[1],P=(0,c.useState)(!1),M=r()(P,2),k=M[0],D=M[1],C=(0,c.useState)(!0),b=r()(C,2),H=b[0],O=b[1],z=(0,c.useState)(!1),I=r()(z,2),W=I[0],Y=I[1],L=(0,c.useState)(!1),_=r()(L,2),A=_[0],T=_[1],F=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];localStorage.removeItem("logDependence"),n(e)};return(0,c.useEffect)((function(){t&&(O(!0),u.W.get("".concat(l.Z.apiPrefix,"dependencies/").concat(t.id)).then((function(e){var n=e.code,i=e.data;if(200===n&&localStorage.getItem("logDependence")===String(t.id)){var r=(i.log||[]).join("");y(r),S(!r.includes("结束时间")),Y(r.includes("删除失败"))}})).finally((function(){O(!1)})))}),[t]),(0,c.useEffect)((function(){if(g&&t){var e=g.type,n=g.message,i=g.references;"installDependence"===e&&i.length>0&&i.includes(t.id)&&(n.includes("结束时间")&&(S(!1),Y(n.includes("删除失败"))),y("".concat(x).concat(n)))}}),[g]),(0,c.useEffect)((function(){D(document.body.clientWidth<768)}),[]),(0,m.jsx)(s.Z,{title:(0,m.jsxs)(m.Fragment,{children:[w&&(0,m.jsx)(d.Z,{spin:!0}),!w&&(0,m.jsx)(f.Z,{}),(0,m.jsxs)("span",{style:{marginLeft:5},children:[a.ZP.get("日志 -")," ",t&&t.name]})," "]}),open:i,centered:!0,className:"log-modal",forceRender:!0,onOk:function(){return F()},onCancel:function(){return F()},footer:[(0,m.jsx)(o.Z,{type:"primary",onClick:function(){W?(T(!0),u.W.delete("".concat(l.Z.apiPrefix,"dependencies/force"),{data:[t.id]}).then((function(e){var t=e.code;e.data,200===t&&F(!0)})).finally((function(){T(!1)}))):F()},loading:A,children:W?a.ZP.get("强制删除"):a.ZP.get("知道了")})],children:(0,m.jsx)("div",{className:"log-container",children:H?(0,m.jsx)(h.Z,{}):(0,m.jsx)("pre",{style:k?{fontFamily:"Source Code Pro",zoom:.83}:{},children:(0,m.jsx)(p(),{children:x})})})})}},52739:function(e,t,n){"use strict";n.r(t);var i=n(25359),r=n.n(i),a=n(57213),c=n.n(a),s=n(49811),o=n.n(s),u=n(54306),l=n.n(u),d=n(88265),f=n(63313),h=n(28756),g=n(67393),p=n(84163),m=n(84468),v=n(22159),Z=n(95176),x=n(5558),y=n(11527),$=h.Z.Option,j=function(e){return e[e.nodejs=0]="nodejs",e[e.python3=1]="python3",e[e.linux=2]="linux",e}(j||{});t.default=function(e){var t=e.dependence,n=e.handleCancel,i=e.visible,a=e.defaultType,s=g.Z.useForm(),u=l()(s,1)[0],w=(0,f.useState)(!1),S=l()(w,2),P=S[0],M=S[1],k=function(){var e=o()(r()().mark((function e(i){var a,s,o,u,l,d,f,h,g,p;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M(!0),a=i.name,s=i.split,o=i.type,u=i.remark,l=t?"put":"post",t?d=c()(c()({},i),{},{id:t.id}):"1"===s?(f=a.includes("&")?"&":"\n",d=a.split(f).map((function(e){return{name:e,type:o,remark:u}}))):d=[{name:a,type:o,remark:u}],e.prev=4,e.next=7,Z.W[l]("".concat(x.Z.apiPrefix,"dependencies"),d);case 7:h=e.sent,g=h.code,p=h.data,200===g&&n(p),M(!1),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),M(!1);case 17:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}();return(0,f.useEffect)((function(){u.resetFields()}),[t,i]),(0,y.jsx)(p.Z,{title:t?d.ZP.get("编辑依赖"):d.ZP.get("创建依赖"),open:i,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){u.validateFields().then((function(e){k(e)})).catch((function(e){console.log("Validate Failed:",e)}))},onCancel:function(){return n()},confirmLoading:P,children:(0,y.jsxs)(g.Z,{form:u,layout:"vertical",name:"dependence_modal",initialValues:t,children:[(0,y.jsx)(g.Z.Item,{name:"type",label:d.ZP.get("依赖类型"),initialValue:j[a],children:(0,y.jsx)(h.Z,{children:x.Z.dependenceTypes.map((function(e,t){return(0,y.jsx)($,{value:t,children:e},t)}))})}),!t&&(0,y.jsx)(g.Z.Item,{name:"split",label:d.ZP.get("自动拆分"),initialValue:"0",tooltip:d.ZP.get("多个依赖是否换行分割"),children:(0,y.jsxs)(m.ZP.Group,{children:[(0,y.jsx)(m.ZP,{value:"1",children:d.ZP.get("是")}),(0,y.jsx)(m.ZP,{value:"0",children:d.ZP.get("否")})]})}),(0,y.jsx)(g.Z.Item,{name:"name",label:d.ZP.get("名称"),rules:[{required:!0,message:d.ZP.get("请输入依赖名称，支持指定版本"),whitespace:!0}],children:(0,y.jsx)(v.Z.TextArea,{rows:4,autoSize:{minRows:1,maxRows:5},placeholder:d.ZP.get("请输入依赖名称")})}),(0,y.jsx)(g.Z.Item,{name:"remark",label:d.ZP.get("备注"),children:(0,y.jsx)(v.Z,{placeholder:d.ZP.get("请输入备注")})})]})})}},52053:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,i="millisecond",r="second",a="minute",c="hour",s="day",o="week",u="month",l="quarter",d="year",f="date",h="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},v=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},Z={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),i=Math.floor(n/60),r=n%60;return(t<=0?"+":"-")+v(i,2,"0")+":"+v(r,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var i=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(i,u),a=n-r<0,c=t.clone().add(i+(a?-1:1),u);return+(-(i+(n-r)/(a?r-c:c-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:d,w:o,d:s,D:f,h:c,m:a,s:r,ms:i,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},x="en",y={};y[x]=m;var $=function(e){return e instanceof P},j=function e(t,n,i){var r;if(!t)return x;if("string"==typeof t){var a=t.toLowerCase();y[a]&&(r=a),n&&(y[a]=n,r=a);var c=t.split("-");if(!r&&c.length>1)return e(c[0])}else{var s=t.name;y[s]=t,r=s}return!i&&r&&(x=r),r||!i&&x},w=function(e,t){if($(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new P(n)},S=Z;S.l=j,S.i=$,S.w=function(e,t){return w(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var P=function(){function m(e){this.$L=j(e.locale,null,!0),this.parse(e)}var v=m.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(S.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(g);if(i){var r=i[2]-1||0,a=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,a)):new Date(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,a)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return S},v.isValid=function(){return!(this.$d.toString()===h)},v.isSame=function(e,t){var n=w(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return w(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<w(e)},v.$g=function(e,t,n){return S.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,i=!!S.u(t)||t,l=S.p(e),h=function(e,t){var r=S.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return i?r:r.endOf(s)},g=function(e,t){return S.w(n.toDate()[e].apply(n.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},p=this.$W,m=this.$M,v=this.$D,Z="set"+(this.$u?"UTC":"");switch(l){case d:return i?h(1,0):h(31,11);case u:return i?h(1,m):h(0,m+1);case o:var x=this.$locale().weekStart||0,y=(p<x?p+7:p)-x;return h(i?v-y:v+(6-y),m);case s:case f:return g(Z+"Hours",0);case c:return g(Z+"Minutes",1);case a:return g(Z+"Seconds",2);case r:return g(Z+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,o=S.p(e),l="set"+(this.$u?"UTC":""),h=(n={},n[s]=l+"Date",n[f]=l+"Date",n[u]=l+"Month",n[d]=l+"FullYear",n[c]=l+"Hours",n[a]=l+"Minutes",n[r]=l+"Seconds",n[i]=l+"Milliseconds",n)[o],g=o===s?this.$D+(t-this.$W):t;if(o===u||o===d){var p=this.clone().set(f,1);p.$d[h](g),p.init(),this.$d=p.set(f,Math.min(this.$D,p.daysInMonth())).$d}else h&&this.$d[h](g);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[S.p(e)]()},v.add=function(i,l){var f,h=this;i=Number(i);var g=S.p(l),p=function(e){var t=w(h);return S.w(t.date(t.date()+Math.round(e*i)),h)};if(g===u)return this.set(u,this.$M+i);if(g===d)return this.set(d,this.$y+i);if(g===s)return p(1);if(g===o)return p(7);var m=(f={},f[a]=t,f[c]=n,f[r]=e,f)[g]||1,v=this.$d.getTime()+i*m;return S.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var i=e||"YYYY-MM-DDTHH:mm:ssZ",r=S.z(this),a=this.$H,c=this.$m,s=this.$M,o=n.weekdays,u=n.months,l=function(e,n,r,a){return e&&(e[n]||e(t,i))||r[n].slice(0,a)},d=function(e){return S.s(a%12||12,e,"0")},f=n.meridiem||function(e,t,n){var i=e<12?"AM":"PM";return n?i.toLowerCase():i},g={YY:String(this.$y).slice(-2),YYYY:S.s(this.$y,4,"0"),M:s+1,MM:S.s(s+1,2,"0"),MMM:l(n.monthsShort,s,u,3),MMMM:l(u,s),D:this.$D,DD:S.s(this.$D,2,"0"),d:String(this.$W),dd:l(n.weekdaysMin,this.$W,o,2),ddd:l(n.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(a),HH:S.s(a,2,"0"),h:d(1),hh:d(2),a:f(a,c,!0),A:f(a,c,!1),m:String(c),mm:S.s(c,2,"0"),s:String(this.$s),ss:S.s(this.$s,2,"0"),SSS:S.s(this.$ms,3,"0"),Z:r};return i.replace(p,(function(e,t){return t||g[e]||r.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(i,f,h){var g,p=S.p(f),m=w(i),v=(m.utcOffset()-this.utcOffset())*t,Z=this-m,x=S.m(this,m);return x=(g={},g[d]=x/12,g[u]=x,g[l]=x/3,g[o]=(Z-v)/6048e5,g[s]=(Z-v)/864e5,g[c]=Z/n,g[a]=Z/t,g[r]=Z/e,g)[p]||Z,h?x:S.a(x)},v.daysInMonth=function(){return this.endOf(u).$D},v.$locale=function(){return y[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),i=j(e,t,!0);return i&&(n.$L=i),n},v.clone=function(){return S.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},m}(),M=P.prototype;return w.prototype=M,[["$ms",i],["$s",r],["$m",a],["$H",c],["$W",s],["$M",u],["$y",d],["$D",f]].forEach((function(e){M[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),w.extend=function(e,t){return e.$i||(e(t,P,w),e.$i=!0),w},w.locale=j,w.isDayjs=$,w.unix=function(e){return w(1e3*e)},w.en=y[x],w.Ls=y,w.p={},w}()}}]);
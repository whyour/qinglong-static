"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1717],{44639:function(Q,E,e){var T=e(55258),r=(0,T.Z)({scriptUrl:["//at.alicdn.com/t/c/font_3354854_ob5y15ewlyq.js"]});E.Z=r},29170:function(Q,E,e){e.r(E),e.d(E,{default:function(){return ce}});var T=e(57213),r=e.n(T),c=e(54306),C=e.n(c),i=e(63313),P=e(55974),z=e(21588),D=e(71571),Z=e(68834),l=e(44639),t=e(11527),x={route:{routes:[{name:"\u767B\u5F55",path:"/login",hideInMenu:!0,component:"@/pages/login/index"},{name:"\u521D\u59CB\u5316",path:"/initialization",hideInMenu:!0,component:"@/pages/initialization/index"},{name:"\u9519\u8BEF",path:"/error",hideInMenu:!0,component:"@/pages/error/index"},{path:"/crontab",name:"\u5B9A\u65F6\u4EFB\u52A1",icon:(0,t.jsx)(l.Z,{type:"ql-icon-crontab"}),component:"@/pages/crontab/index"},{path:"/subscription",name:"\u8BA2\u9605\u7BA1\u7406",icon:(0,t.jsx)(l.Z,{type:"ql-icon-subs"}),component:"@/pages/subscription/index"},{path:"/env",name:"\u73AF\u5883\u53D8\u91CF",icon:(0,t.jsx)(l.Z,{type:"ql-icon-env"}),component:"@/pages/env/index"},{path:"/config",name:"\u914D\u7F6E\u6587\u4EF6",icon:(0,t.jsx)(l.Z,{type:"ql-icon-config"}),component:"@/pages/config/index"},{path:"/script",name:"\u811A\u672C\u7BA1\u7406",icon:(0,t.jsx)(l.Z,{type:"ql-icon-script"}),component:"@/pages/script/index"},{path:"/dependence",name:"\u4F9D\u8D56\u7BA1\u7406",icon:(0,t.jsx)(l.Z,{type:"ql-icon-dependence"}),component:"@/pages/dependence/index"},{path:"/log",name:"\u65E5\u5FD7\u7BA1\u7406",icon:(0,t.jsx)(l.Z,{type:"ql-icon-log"}),component:"@/pages/log/index"},{path:"/diff",name:"\u5BF9\u6BD4\u5DE5\u5177",icon:(0,t.jsx)(l.Z,{type:"ql-icon-diff"}),component:"@/pages/diff/index"},{path:"/setting",name:"\u7CFB\u7EDF\u8BBE\u7F6E",icon:(0,t.jsx)(Z.Z,{}),component:"@/pages/password/index"}]},navTheme:"light",fixSiderbar:!0,contentWidth:"Fixed",splitMenus:!1,siderWidth:180},u=e(40440),f=e(50988),m=e(3513),S=e(63386),y=e(85153),h=e(90717),j=e(35911),O=e(86563),K=e.n(O),L=e(74445),k=e(12094),A=e(15367),N=e(13217),R=e(34133),H=e(83535),ae=e(78078),oe=e.n(ae),se=e(45638),ie=e(79516),re=e(42078),le=e(25940),ue=e(82755);function de(v){re.S({dsn:"https://3406424fb1dc4813a62d39e844a9d0ac@o1098464.ingest.sentry.io/6122818",integrations:[new le.jK.BrowserTracing({shouldCreateSpanForRequest:function(g){return!g.includes("/api/ws")&&!g.includes("/api/static")}})],release:v,tracesSampleRate:.1,beforeBreadcrumb:function(g,F){if(g.data&&g.data.url){var B=g.data.url.replace(/token=.*/,"");g.data.url=B}return g}}),ue._m.config({paths:{vs:"https://cdn.staticfile.org/monaco-editor/0.33.0/min/vs"},"vs/nls":{availableLanguages:{"*":"zh-cn"}}})}var Re=e(23836),Be=e(34637),Ue=e(85797);function ce(){var v=(0,u.useLocation)(),M=(0,L.e)(),g=(0,L.F)(),F=g.theme,B=g.reloadTheme,fe=(0,i.useState)({}),G=C()(fe,2),d=G[0],me=G[1],he=(0,i.useState)(!0),J=C()(he,2),V=J[0],$=J[1],ge=(0,i.useState)(),X=C()(ge,2),s=X[0],ve=X[1],U=(0,i.useRef)(null),pe=(0,i.useState)(),Y=C()(pe,2),xe=Y[0],Se=Y[1],ye=(0,i.useState)(!1),w=C()(ye,2),je=w[0],q=w[1],Ce=(0,i.useState)(!0),_=C()(Ce,2),Ee=_[0],Me=_[1],I=D||{},Te=I.enable,ee=I.disable,We=I.exportGeneratedCSS,Ze=I.setFetchMethod,Le=I.auto,Fe=function(){j.W.post("".concat(h.Z.apiPrefix,"user/logout")).then(function(){localStorage.removeItem(h.Z.authKey),u.history.push("/login")})},Ie=function(){j.W.get("".concat(h.Z.apiPrefix,"system")).then(function(n){var o=n.code,p=n.data;o===200&&(ve(p),p.isInitialized?(de(p.version),b()):u.history.push("/initialization"))}).catch(function(n){console.log(n)})},b=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n&&$(!0),j.W.get("".concat(h.Z.apiPrefix,"user")).then(function(o){var p=o.code,W=o.data;p===200&&W.username&&(me(W),v.pathname==="/"&&u.history.push("/crontab")),n&&$(!1)}).catch(function(o){console.log(o)})},Pe=function(){j.W.get("".concat(h.Z.apiPrefix,"public/health")).then(function(n){var o;(n==null||(o=n.data)===null||o===void 0?void 0:o.status)===1?Ie():u.history.push("/error")}).catch(function(n){u.history.push("/error")}).finally(function(){return Me(!1)})},te=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;b(n)};if((0,i.useEffect)(function(){s&&s.isInitialized&&!d&&b()},[v.pathname]),(0,i.useEffect)(function(){Pe()},[]),(0,i.useEffect)(function(){F==="vs-dark"?document.body.setAttribute("data-dark","true"):document.body.setAttribute("data-dark","false")},[F]),(0,i.useEffect)(function(){K()();var a=localStorage.getItem("qinglong_dark_theme")||"auto";if(typeof window!="undefined"&&typeof window.matchMedia!="undefined")return D?(Ze(fetch),a==="dark"?Te({}):a==="light"?ee():Le({}),function(){ee()}):function(){return null}},[]),(0,i.useEffect)(function(){if(!(!d||!d.username)){U.current=new(oe())("".concat(window.location.origin,"/api/ws?token=").concat(localStorage.getItem(h.Z.authKey))),U.current.onmessage=function(n){try{var o=JSON.parse(n.data);o.type==="ping"&&(o&&o.message==="hanhh"?console.log("WS connection succeeded !!!"):console.log("WS connection Failed !!!",n)),Se(o)}catch(p){console.log("websocket\u8FDE\u63A5\u5931\u8D25",n)}};var a=U.current;return function(){a.close()}}},[d]),(0,i.useEffect)(function(){window.onload=function(){var a=performance.timing;console.log("\u767D\u5C4F\u65F6\u95F4: ".concat(a.responseStart-a.navigationStart)),console.log("\u8BF7\u6C42\u5B8C\u6BD5\u81F3DOM\u52A0\u8F7D: ".concat(a.domInteractive-a.responseEnd)),console.log("\u89E3\u91CAdom\u6811\u8017\u65F6: ".concat(a.domComplete-a.domInteractive)),console.log("\u4ECE\u5F00\u59CB\u81F3load\u603B\u8017\u65F6: ".concat(a.loadEventEnd-a.navigationStart)),se.uT("\u767D\u5C4F\u65F6\u95F4 ".concat(a.responseStart-a.navigationStart))}},[]),Ee)return(0,t.jsx)(P.Z,{});if(["/login","/initialization","/error"].includes(v.pathname)&&(s!=null&&s.isInitialized&&v.pathname==="/initialization"&&u.history.push("/crontab"),s||v.pathname==="/error"))return(0,t.jsx)(u.Outlet,{context:r()(r()({},M),{},{theme:F,user:d,reloadUser:te,reloadTheme:B,ws:U.current})});var De=navigator.userAgent.includes("Firefox"),Oe=navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome"),Ae=navigator.userAgent.includes("QQBrowser"),ne={items:[{label:"\u9000\u51FA\u767B\u5F55",className:"side-menu-user-drop-menu",onClick:Fe,key:"logout",icon:(0,t.jsx)(f.Z,{})}]};return V?(0,t.jsx)(P.Z,{}):(0,t.jsx)(z.ZP,r()(r()({selectedKeys:[v.pathname],loading:V,ErrorBoundary:ie.SV,logo:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.Z,{preview:!1,src:"https://qn.whyour.cn/logo.png"}),(0,t.jsxs)("div",{className:"title",children:[(0,t.jsx)("span",{className:"title",children:"\u9752\u9F99"}),(0,t.jsx)("a",{href:s==null?void 0:s.changeLogLink,target:"_blank",rel:"noopener noreferrer",onClick:function(n){n.stopPropagation()},children:(0,t.jsx)(A.Z,{title:(s==null?void 0:s.branch)==="develop"?"\u5F00\u53D1\u7248":"\u6B63\u5F0F\u7248",children:(0,t.jsx)(N.Z,{size:"small",dot:(s==null?void 0:s.branch)==="develop",children:(0,t.jsxs)("span",{style:{fontSize:De?9:12,color:"#666",marginLeft:2,zoom:Oe?.66:.8,letterSpacing:Ae?-2:0},children:["v",s==null?void 0:s.version]})})})})]})]}),title:!1,menuItemRender:function(n,o){return n.isUrl||!n.path||v.pathname===n.path?o:(0,t.jsx)(u.Link,{to:n.path,children:o})},pageTitleRender:function(n,o,p){var W=h.Z.documentTitleMap[v.pathname]||"\u672A\u627E\u5230";return"".concat(W," - \u9752\u9F99")},onCollapse:q,collapsed:je,rightContentRender:function(){return M.isPhone&&(0,t.jsx)(R.Z,{menu:ne,placement:"bottomRight",trigger:["click"],children:(0,t.jsxs)("span",{className:"side-menu-user-wrapper",children:[(0,t.jsx)(H.C,{shape:"square",size:"small",icon:(0,t.jsx)(m.Z,{}),src:d.avatar?"/api/static/".concat(d.avatar):""}),(0,t.jsx)("span",{style:{marginLeft:5},children:d.username})]})})},collapsedButtonRender:function(n){return(0,t.jsxs)("span",{className:"side-menu-container",onClick:function(p){p.preventDefault(),p.stopPropagation()},children:[!n&&!M.isPhone&&(0,t.jsx)(R.Z,{menu:ne,placement:"topLeft",trigger:["hover"],children:(0,t.jsxs)("span",{className:"side-menu-user-wrapper",children:[(0,t.jsx)(H.C,{shape:"square",size:"small",icon:(0,t.jsx)(m.Z,{}),src:d.avatar?"/api/static/".concat(d.avatar):""}),(0,t.jsx)("span",{style:{marginLeft:5},children:d.username})]})}),(0,t.jsx)("span",{className:"side-menu-collapse-button",onClick:function(){return q(!n)},children:n?(0,t.jsx)(S.Z,{}):(0,t.jsx)(y.Z,{})})]})}},x),{},{children:(0,t.jsx)(u.Outlet,{context:r()(r()({},M),{},{theme:F,user:d,reloadUser:te,reloadTheme:B,socketMessage:xe,systemInfo:s})})}))}},74445:function(Q,E,e){e.d(E,{F:function(){return z},e:function(){return P}});var T=e(54306),r=e.n(T),c=e(63313),C=e.n(c),i=e(60001),P=function(){var Z=(0,c.useState)("100%"),l=r()(Z,2),t=l[0],x=l[1],u=(0,c.useState)(0),f=r()(u,2),m=f[0],S=f[1],y=(0,c.useState)(-48),h=r()(y,2),j=h[0],O=h[1],K=(0,c.useState)(!1),L=r()(K,2),k=L[0],A=L[1],N=(0,c.useMemo)(function(){return(0,i.ZP)()},[]),R=N.platform;return(0,c.useEffect)(function(){R==="mobile"&&document.body.offsetWidth<768?(x("auto"),S(0),O(0),A(!0),document.body.setAttribute("data-mode","phone")):(x("100%"),S(0),O(-48),A(!1),document.body.setAttribute("data-mode","desktop"))},[]),{headerStyle:{padding:"4px 16px 4px 15px",position:"sticky",top:0,left:0,zIndex:20,marginTop:j,width:t,marginLeft:m},isPhone:k}},z=function(){var Z=(0,c.useState)(),l=r()(Z,2),t=l[0],x=l[1],u=function(){var m=window.matchMedia("(prefers-color-scheme: dark)"),S=localStorage.getItem("qinglong_dark_theme"),y=m.matches&&S!=="light"||S==="dark";x(y?"vs-dark":"vs")};return(0,c.useEffect)(function(){var f=window.matchMedia("(prefers-color-scheme: dark)"),m=localStorage.getItem("qinglong_dark_theme"),S=f.matches&&m!=="light"||m==="dark";x(S?"vs-dark":"vs");var y=function(j){(m==="auto"||!m)&&(j.matches?x("vs-dark"):x("vs"))};typeof f.addEventListener=="function"?f.addEventListener("change",y):typeof f.addListener=="function"&&f.addListener(y)},[]),{theme:t,reloadTheme:u}}}}]);

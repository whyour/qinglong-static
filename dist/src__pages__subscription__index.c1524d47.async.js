(self.webpackChunk=self.webpackChunk||[]).push([[7953,578],{56996:function(v,f,e){"use strict";e.d(f,{Z:function(){return o}});var d=e(56453),r=e(63313),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},h=s,D=e(17536),l=function(c,O){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:O,icon:h}))};l.displayName="ClockCircleOutlined";var o=r.forwardRef(l)},5962:function(v,f,e){"use strict";e.d(f,{Z:function(){return o}});var d=e(56453),r=e(63313),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},h=s,D=e(17536),l=function(c,O){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:O,icon:h}))};l.displayName="DeleteOutlined";var o=r.forwardRef(l)},62198:function(v,f,e){"use strict";e.d(f,{Z:function(){return o}});var d=e(56453),r=e(63313),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},h=s,D=e(17536),l=function(c,O){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:O,icon:h}))};l.displayName="FileTextOutlined";var o=r.forwardRef(l)},35316:function(v,f,e){"use strict";e.d(f,{Z:function(){return o}});var d=e(56453),r=e(63313),s={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"}}]},name:"loading-3-quarters",theme:"outlined"},h=s,D=e(17536),l=function(c,O){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:O,icon:h}))};l.displayName="Loading3QuartersOutlined";var o=r.forwardRef(l)},22932:function(v,f,e){"use strict";e.d(f,{Z:function(){return o}});var d=e(56453),r=e(63313),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372zm-88-532h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8zm224 0h-48c-4.4 0-8 3.6-8 8v304c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V360c0-4.4-3.6-8-8-8z"}}]},name:"pause-circle",theme:"outlined"},h=s,D=e(17536),l=function(c,O){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:O,icon:h}))};l.displayName="PauseCircleOutlined";var o=r.forwardRef(l)},66260:function(v,f,e){"use strict";e.d(f,{Z:function(){return o}});var d=e(56453),r=e(63313),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},h=s,D=e(17536),l=function(c,O){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:O,icon:h}))};l.displayName="PlayCircleOutlined";var o=r.forwardRef(l)},85451:function(v,f,e){"use strict";e.d(f,{Z:function(){return o}});var d=e(56453),r=e(63313),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372 0-89 31.3-170.8 83.5-234.8l523.3 523.3C682.8 852.7 601 884 512 884zm288.5-137.2L277.2 223.5C341.2 171.3 423 140 512 140c205.4 0 372 166.6 372 372 0 89-31.3 170.8-83.5 234.8z"}}]},name:"stop",theme:"outlined"},h=s,D=e(17536),l=function(c,O){return r.createElement(D.Z,(0,d.Z)((0,d.Z)({},c),{},{ref:O,icon:h}))};l.displayName="StopOutlined";var o=r.forwardRef(l)},99071:function(v,f,e){"use strict";var d=e(46686),r=e.n(d),s=e(63313),h=e.n(s),D=e(61761),l=e(48388);f.Z=function(o,S){var c=(0,s.useState)(),O=r()(c,2),ee=O[0],p=O[1];return(0,D.Z)(o,function(A){var F=A.target;F.classList.contains("ant-table-wrapper")||(F=A.target.querySelector(".ant-table-wrapper")),p((0,l.W9)({extraHeight:S,target:F}))}),ee}},32479:function(v,f,e){"use strict";e.r(f),e.d(f,{IntervalSchedule:function(){return K},SubscriptionStatus:function(){return x},SubscriptionType:function(){return Y},default:function(){return oe}});var d=e(94434),r=e.n(d),s=e(46686),h=e.n(s),D=e(30279),l=e.n(D),o=e(63313),S=e(59440),c=e(30314),O=e(96384),ee=e(65646),p=e(61135),A=e(4352),F=e(63533),De=e(22999),Q=e(15051),b=e(59225),ge=e(61685),ae=e(56996),le=e(35316),ce=e(74761),n=e(66260),G=e(22932),ve=e(62198),re=e(97947),Ce=e(9734),Ee=e(85451),J=e(5962),y=e(59140),z=e(41601),X=e(11168),V=e(73835),xe=e(62531),Z=e(65731),fe=e(21305),he=e(99071),a=e(11527),H=S.Z.Text,ie=S.Z.Paragraph,pe=c.Z.Search,x;(function(E){E[E.running=0]="running",E[E.idle=1]="idle",E[E.disabled=2]="disabled",E[E.queued=3]="queued"})(x||(x={}));var K;(function(E){E.days="\u5929",E.hours="\u65F6",E.minutes="\u5206",E.seconds="\u79D2"})(K||(K={}));var Y;(function(E){E["private-repo"]="\u79C1\u6709\u4ED3\u5E93",E["public-repo"]="\u516C\u5F00\u4ED3\u5E93",E.file="\u5355\u6587\u4EF6"})(Y||(Y={}));var me=function(){var _e=(0,Z.bx)(),Oe=_e.headerStyle,Pe=_e.isPhone,te=_e.socketMessage,Te=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",width:150,align:"center",sorter:{compare:function(t,u){return t.name.localeCompare(u.name)},multiple:2}},{title:"\u94FE\u63A5",dataIndex:"url",key:"url",align:"center",sorter:{compare:function(t,u){return t.name.localeCompare(u.name)},multiple:2},render:function(t,u){return(0,a.jsx)(ie,{style:{wordBreak:"break-all",marginBottom:0,textAlign:"left"},ellipsis:{tooltip:t,rows:2},children:t})}},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",width:130,align:"center",render:function(t,u){return Y[u.type]}},{title:"\u5206\u652F",dataIndex:"branch",key:"branch",width:130,align:"center",render:function(t,u){return u.branch||"-"}},{title:"\u5B9A\u65F6\u89C4\u5219",width:180,align:"center",render:function(t,u){if(u.schedule_type==="interval"){var m=u.interval_schedule,P=m.type,B=m.value;return"\u6BCF".concat(B).concat(K[P])}return u.schedule}},{title:"\u72B6\u6001",key:"status",dataIndex:"status",align:"center",width:110,filters:[{text:"\u8FD0\u884C\u4E2D",value:0},{text:"\u7A7A\u95F2\u4E2D",value:1},{text:"\u5DF2\u7981\u7528",value:2}],onFilter:function(t,u){return u.is_disabled&&u.status!==0?t===2:u.status===t},render:function(t,u){return(0,a.jsxs)(a.Fragment,{children:[(!u.is_disabled||u.status!==x.idle)&&(0,a.jsxs)(a.Fragment,{children:[u.status===x.idle&&(0,a.jsx)(O.Z,{icon:(0,a.jsx)(ae.Z,{}),color:"default",children:"\u7A7A\u95F2\u4E2D"}),u.status===x.running&&(0,a.jsx)(O.Z,{icon:(0,a.jsx)(le.Z,{spin:!0}),color:"processing",children:"\u8FD0\u884C\u4E2D"})]}),u.is_disabled===1&&u.status===x.idle&&(0,a.jsx)(O.Z,{icon:(0,a.jsx)(ce.Z,{}),color:"error",children:"\u5DF2\u7981\u7528"})]})}},{title:"\u64CD\u4F5C",key:"action",align:"center",width:130,render:function(t,u,m){var P=!Pe;return(0,a.jsxs)(ee.Z,{size:"middle",children:[u.status===x.idle&&(0,a.jsx)(p.Z,{title:P?"\u8FD0\u884C":"",children:(0,a.jsx)("a",{onClick:function(U){U.stopPropagation(),$e(u,m)},children:(0,a.jsx)(n.Z,{})})}),u.status!==x.idle&&(0,a.jsx)(p.Z,{title:P?"\u505C\u6B62":"",children:(0,a.jsx)("a",{onClick:function(U){U.stopPropagation(),qe(u,m)},children:(0,a.jsx)(G.Z,{})})}),(0,a.jsx)(p.Z,{title:P?"\u65E5\u5FD7":"",children:(0,a.jsx)("a",{onClick:function(U){U.stopPropagation(),Xe(l()(l()({},u),{},{timestamp:Date.now()}))},children:(0,a.jsx)(ve.Z,{})})}),(0,a.jsx)(lt,{record:u,index:m},"more")]})}}],Ie=(0,o.useState)([]),Se=h()(Ie,2),W=Se[0],N=Se[1],Be=(0,o.useState)(!0),se=h()(Be,2),be=se[0],Ae=se[1],ye=(0,o.useState)(!1),je=h()(ye,2),j=je[0],i=je[1],_=(0,o.useState)(),g=h()(_,2),I=g[0],R=g[1],$=(0,o.useState)(""),w=h()($,2),de=w[0],M=w[1],ne=(0,o.useState)(1),ue=h()(ne,2),Fe=ue[0],Ze=ue[1],Re=(0,o.useState)(20),q=h()(Re,2),He=q[0],Le=q[1],Ne=(0,o.useState)(""),We=h()(Ne,2),we=We[0],ke=We[1],Qe=(0,o.useState)(!1),Ue=h()(Qe,2),Ge=Ue[0],Ke=Ue[1],Je=(0,o.useState)(),ze=h()(Je,2),Me=ze[0],Xe=ze[1],Ve=(0,o.useRef)(),Ye=(0,he.Z)(Ve),$e=function(t,u){A.Z.confirm({title:"\u786E\u8BA4\u8FD0\u884C",content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4\u8FD0\u884C\u5B9A\u65F6\u4EFB\u52A1"," ",(0,a.jsx)(H,{style:{wordBreak:"break-all"},type:"warning",children:t.name})," ","\u5417"]}),onOk:function(){V.W.put("".concat(z.Z.apiPrefix,"subscriptions/run"),{data:[t.id]}).then(function(P){var B=P.code,U=P.data;if(B===200){var T=r()(W),L=T.findIndex(function(k){return k.id===t.id});L!==-1&&(T.splice(L,1,l()(l()({},t),{},{status:x.running})),N(T))}})},onCancel:function(){console.log("Cancel")}})},qe=function(t,u){A.Z.confirm({title:"\u786E\u8BA4\u505C\u6B62",content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4\u505C\u6B62\u5B9A\u65F6\u4EFB\u52A1"," ",(0,a.jsx)(H,{style:{wordBreak:"break-all"},type:"warning",children:t.name})," ","\u5417"]}),onOk:function(){V.W.put("".concat(z.Z.apiPrefix,"subscriptions/stop"),{data:[t.id]}).then(function(P){var B=P.code,U=P.data;if(B===200){var T=r()(W),L=T.findIndex(function(k){return k.id===t.id});L!==-1&&(T.splice(L,1,l()(l()({},t),{},{pid:null,status:x.idle})),N(T))}})},onCancel:function(){console.log("Cancel")}})},et=function(){Ae(!0),V.W.get("".concat(z.Z.apiPrefix,"subscriptions?searchValue=").concat(de)).then(function(t){var u=t.code,m=t.data;u===200&&(N(m),Ze(1))}).finally(function(){return Ae(!1)})},tt=function(){R(null),i(!0)},nt=function(t,u){R(t),i(!0)},ut=function(t,u){A.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u5B9A\u65F6\u8BA2\u9605"," ",(0,a.jsx)(H,{style:{wordBreak:"break-all"},type:"warning",children:t.name})," ","\u5417"]}),onOk:function(){V.W.delete("".concat(z.Z.apiPrefix,"subscriptions"),{data:[t.id]}).then(function(P){var B=P.code,U=P.data;if(B===200){F.ZP.success("\u5220\u9664\u6210\u529F");var T=r()(W),L=T.findIndex(function(k){return k.id===t.id});L!==-1&&(T.splice(L,1),N(T))}})},onCancel:function(){console.log("Cancel")}})},at=function(t,u){A.Z.confirm({title:"\u786E\u8BA4".concat(t.is_disabled===1?"\u542F\u7528":"\u7981\u7528"),content:(0,a.jsxs)(a.Fragment,{children:["\u786E\u8BA4",t.is_disabled===1?"\u542F\u7528":"\u7981\u7528","\u5B9A\u65F6\u8BA2\u9605"," ",(0,a.jsx)(H,{style:{wordBreak:"break-all"},type:"warning",children:t.name})," ","\u5417"]}),onOk:function(){V.W.put("".concat(z.Z.apiPrefix,"subscriptions/").concat(t.is_disabled===1?"enable":"disable"),{data:[t.id]}).then(function(P){var B=P.code,U=P.data;if(B===200){var T=t.is_disabled===1?0:1,L=r()(W),k=L.findIndex(function(vt){return vt.id===t.id});k!==-1&&(L.splice(k,1,l()(l()({},t),{},{is_disabled:T})),N(L))}})},onCancel:function(){console.log("Cancel")}})},lt=function(t){var u=t.record,m=t.index;return(0,a.jsx)(De.Z,{arrow:{pointAtCenter:!0},placement:"bottomRight",trigger:["click"],overlay:(0,a.jsx)(Q.Z,{items:[{label:"\u7F16\u8F91",key:"edit",icon:(0,a.jsx)(re.Z,{})},{label:u.is_disabled===1?"\u542F\u7528":"\u7981\u7528",key:"enableOrDisable",icon:u.is_disabled===1?(0,a.jsx)(Ce.Z,{}):(0,a.jsx)(Ee.Z,{})},{label:"\u5220\u9664",key:"delete",icon:(0,a.jsx)(J.Z,{})}],onClick:function(B){var U=B.key,T=B.domEvent;T.stopPropagation(),rt(U,u,m)}}),children:(0,a.jsx)("a",{onClick:function(B){return B.stopPropagation()},children:(0,a.jsx)(y.Z,{})})})},rt=function(t,u,m){switch(t){case"edit":nt(u,m);break;case"enableOrDisable":at(u,m);break;case"delete":ut(u,m);break;default:break}},it=function(t){i(!1),t&&st(t)},ot=function(t){M(t.trim())},st=function(t){var u=W.findIndex(function(P){return P.id===t.id}),m=r()(W);u===-1?m.unshift(t):m.splice(u,1,l()({},t)),N(m)},dt=function(t,u){Ze(t),Le(u),localStorage.setItem("pageSize",u+"")},ct=function(t,u){return t.isPinned?"pinned-subscription subscription":"subscription"};return(0,o.useEffect)(function(){if(!!te){var C=te.type,t=te.message,u=te.references;if(C==="runSubscriptionEnd"&&u.length>0){for(var m=r()(W),P=function(T){var L=W.findIndex(function(k){return k.id===u[T]});L!==-1&&m.splice(L,1,l()(l()({},W[L]),{},{status:x.idle}))},B=0;B<u.length;B++)P(B);N(m)}}},[te]),(0,o.useEffect)(function(){Me&&(localStorage.setItem("logSubscription",Me.id),Ke(!0))},[Me]),(0,o.useEffect)(function(){et()},[de]),(0,o.useEffect)(function(){Le(parseInt(localStorage.getItem("pageSize")||"20"))},[]),(0,a.jsxs)(X.ZP,{className:"ql-container-wrapper subscriptiontab-wrapper",title:"\u8BA2\u9605\u7BA1\u7406",extra:[(0,a.jsx)(pe,{placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0\u6216\u8005\u5173\u952E\u8BCD",style:{width:"auto"},enterButton:!0,allowClear:!0,loading:be,value:we,onChange:function(t){return ke(t.target.value)},onSearch:ot}),(0,a.jsx)(b.Z,{type:"primary",onClick:function(){return tt()},children:"\u65B0\u5EFA\u8BA2\u9605"},"2")],header:{style:Oe},children:[(0,a.jsx)(ge.Z,{ref:Ve,columns:Te,pagination:{current:Fe,onChange:dt,pageSize:He,showSizeChanger:!0,simple:Pe,defaultPageSize:20,showTotal:function(t,u){return"\u7B2C ".concat(u[0],"-").concat(u[1]," \u6761/\u603B\u5171 ").concat(t," \u6761")},pageSizeOptions:[20,100,500,1e3]},dataSource:W,rowKey:"id",size:"middle",scroll:{x:1e3,y:Ye},loading:be,rowClassName:ct}),(0,a.jsx)(xe.default,{visible:j,handleCancel:it,subscription:I}),(0,a.jsx)(fe.default,{visible:Ge,handleCancel:function(){Ke(!1)},subscription:Me})]})},oe=me},21305:function(v,f,e){"use strict";e.r(f);var d=e(46686),r=e.n(d),s=e(63313),h=e.n(s),D=e(4352),l=e(59225),o=e(73835),S=e(41601),c=e(35316),O=e(9734),ee=e(7098),p=e(48388),A=e(11527),F=function(Q){var b=Q.subscription,ge=Q.handleCancel,ae=Q.visible,le=Q.data,ce=Q.logUrl,n=(0,s.useState)("\u542F\u52A8\u4E2D..."),G=r()(n,2),ve=G[0],re=G[1],Ce=(0,s.useState)(!0),Ee=r()(Ce,2),J=Ee[0],y=Ee[1],z=(0,s.useState)(!0),X=r()(z,2),V=X[0],xe=X[1],Z=(0,s.useState)(!1),fe=r()(Z,2),he=fe[0],a=fe[1],H=function x(K){K&&y(!0),o.W.get(ce||"".concat(S.Z.apiPrefix,"subscriptions/").concat(b.id,"/log")).then(function(Y){var me=Y.code,oe=Y.data;if(me===200&&localStorage.getItem("logSubscription")===String(b.id)){var E=oe;re(E||"\u6682\u65E0\u65E5\u5FD7"),xe(E&&!(0,p.x$)(E)),E&&!(0,p.x$)(E)&&setTimeout(function(){x()},2e3)}}).finally(function(){K&&y(!1)})},ie=function(){localStorage.removeItem("logSubscription"),ge()},pe=function(){return(0,A.jsxs)(A.Fragment,{children:[(V||J)&&(0,A.jsx)(c.Z,{spin:!0}),!V&&!J&&(0,A.jsx)(O.Z,{}),(0,A.jsx)("span",{style:{marginLeft:5},children:b&&b.name})]})};return(0,s.useEffect)(function(){b&&b.id&&ae&&H(!0)},[b,ae]),(0,s.useEffect)(function(){le&&re(le)},[le]),(0,s.useEffect)(function(){a(document.body.clientWidth<768)},[]),(0,A.jsx)(D.Z,{title:pe(),open:ae,centered:!0,className:"log-modal",bodyStyle:{minHeight:"300px"},forceRender:!0,onOk:function(){return ie()},onCancel:function(){return ie()},footer:[(0,A.jsx)(l.Z,{type:"primary",onClick:function(){return ie()},children:"\u77E5\u9053\u4E86"})],children:J?(0,A.jsx)(ee.Z,{}):(0,A.jsx)("pre",{style:he?{fontFamily:"Source Code Pro",width:375,zoom:.83}:{},children:ve})})};f.default=F},62531:function(v,f,e){"use strict";e.r(f);var d=e(35290),r=e.n(d),s=e(30279),h=e.n(s),D=e(411),l=e.n(D),o=e(46686),S=e.n(o),c=e(63313),O=e.n(c),ee=e(61839),p=e(71976),A=e(63533),F=e(30314),De=e(50499),Q=e(4352),b=e(28666),ge=e(73835),ae=e(41601),le=e(73183),ce=e.n(le),n=e(11527),G=ee.Z.Option,ve=/[^\/\:]+\/[^\/]+(?=\.git)/,re=/[^\/\:]+\/[^\/]+$/,Ce=function(J){var y=J.subscription,z=J.handleCancel,X=J.visible,V=p.Z.useForm(),xe=S()(V,1),Z=xe[0],fe=(0,c.useState)(!1),he=S()(fe,2),a=he[0],H=he[1],ie=(0,c.useState)("public-repo"),pe=S()(ie,2),x=pe[0],K=pe[1],Y=(0,c.useState)("crontab"),me=S()(Y,2),oe=me[0],E=me[1],_e=(0,c.useState)("ssh-key"),Oe=S()(_e,2),Pe=Oe[0],te=Oe[1],Te=function(){var j=l()(r()().mark(function i(_){var g,I,R,$,w;return r()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return H(!0),g=y?"put":"post",I=h()({},_),y&&(I.id=y.id),M.prev=4,M.next=7,ge.W[g]("".concat(ae.Z.apiPrefix,"subscriptions"),{data:I});case 7:R=M.sent,$=R.code,w=R.data,$===200&&(A.ZP.success(y?"\u66F4\u65B0\u8BA2\u9605\u6210\u529F":"\u65B0\u5EFA\u8BA2\u9605\u6210\u529F"),z(w)),H(!1),M.next=17;break;case 14:M.prev=14,M.t0=M.catch(4),H(!1);case 17:case"end":return M.stop()}},i,null,[[4,14]])}));return function(_){return j.apply(this,arguments)}}(),Ie=function(i){K(i.target.value);var _=Z.getFieldValue("url"),g=Z.getFieldValue("branch");Z.setFieldsValue({alias:se(_,g,i.target.value)}),_&&Z.validateFields(["url"])},Se=function(i){E(i.target.value),Z.setFieldsValue({schedule:""})},W=function(i){te(i.target.value)},N=function(i){var _=Z.getFieldValue("branch");Z.setFieldsValue({alias:se(i.target.value,_)})},Be=function(i){var _=Z.getFieldValue("url");Z.setFieldsValue({alias:se(_,i.target.value)})},se=function(i,_){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x,I="",R=g==="file"?re:ve;return R.test(i)&&(I=i.match(R)[0].replaceAll("/","_").replaceAll(".","_")),_&&(I=I+"_"+_),I},be=function(i){var _=i.value,g=i.onChange,I=(0,c.useState)("days"),R=S()(I,2),$=R[0],w=R[1],de=(0,c.useState)(),M=S()(de,2),ne=M[0],ue=M[1],Fe=function(q){w(q),ne&&ne>0&&(g==null||g({type:q,value:ne}))},Ze=function(q){ue(q),q?g==null||g({type:$,value:q}):g==null||g(null)};return(0,c.useEffect)(function(){_&&(w(_.type),ue(_.value))},[_]),(0,n.jsxs)(F.Z.Group,{compact:!0,children:[(0,n.jsx)(De.Z,{addonBefore:"\u6BCF",precision:0,min:1,value:ne,style:{width:"calc(100% - 58px)"},onChange:Ze}),(0,n.jsxs)(ee.Z,{value:$,onChange:Fe,children:[(0,n.jsx)(G,{value:"days",children:"\u5929"}),(0,n.jsx)(G,{value:"hours",children:"\u65F6"}),(0,n.jsx)(G,{value:"minutes",children:"\u5206"}),(0,n.jsx)(G,{value:"seconds",children:"\u79D2"})]})]})},Ae=function(i){var _=i.value,g=i.onChange,I=i.type;return I==="ssh-key"?(0,n.jsx)(p.Z.Item,{name:["pull_option","private_key"],label:"\u79C1\u94A5",rules:[{required:!0}],children:(0,n.jsx)(F.Z.TextArea,{rows:4,autoSize:{minRows:1,maxRows:6},placeholder:"\u8BF7\u8F93\u5165\u79C1\u94A5"})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z.Item,{name:["pull_option","username"],label:"\u7528\u6237\u540D",rules:[{required:!0}],children:(0,n.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165\u8BA4\u8BC1\u7528\u6237\u540D"})}),(0,n.jsx)(p.Z.Item,{name:["pull_option","password"],tooltip:"Github\u5DF2\u4E0D\u652F\u6301\u5BC6\u7801\u8BA4\u8BC1\uFF0C\u8BF7\u4F7F\u7528Token\u65B9\u5F0F",label:"\u5BC6\u7801/Token",rules:[{required:!0}],children:(0,n.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801\u6216\u8005Token"})})]})},ye=(0,c.useCallback)(function(j){var i=j.clipboardData.getData("text");if(i.startsWith("ql ")){var _=i.split(" ").map(function(Fe){return Fe.trim().replace(/\"/g,"").replace(/\'/,"")}),g=S()(_,8),I=g[1],R=g[2],$=g[3],w=g[4],de=g[5],M=g[6],ne=g[7],ue=I==="raw"?"file":R.startsWith("http")?"public-repo":"private-repo";Z.setFieldsValue({type:ue,url:R,whitelist:$,blacklist:w,dependences:de,branch:M,extensions:ne,alias:se(R,M)}),K(ue)}},[]),je=(0,c.useCallback)(function(j){var i=j.clipboardData.getData("text");i.startsWith("ql ")&&j.preventDefault()},[]);return(0,c.useEffect)(function(){X?window.addEventListener("paste",ye):window.removeEventListener("paste",ye)},[X]),(0,c.useEffect)(function(){Z.setFieldsValue(y||{}),K(y&&y.type||"public-repo"),E(y&&y.schedule_type||"crontab"),te(y&&y.pull_type||"ssh-key"),y||Z.resetFields()},[y,X]),(0,n.jsx)(Q.Z,{title:y?"\u7F16\u8F91\u8BA2\u9605":"\u65B0\u5EFA\u8BA2\u9605",open:X,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){Z.validateFields().then(function(i){Te(i)}).catch(function(i){console.log("Validate Failed:",i)})},onCancel:function(){return z()},confirmLoading:a,children:(0,n.jsxs)(p.Z,{form:Z,name:"form_in_modal",layout:"vertical",children:[(0,n.jsx)(p.Z.Item,{name:"name",label:"\u540D\u79F0",children:(0,n.jsx)(F.Z,{placeholder:"\u652F\u6301\u62F7\u8D1Dql repo/raw\u547D\u4EE4\uFF0C\u7C98\u8D34\u5BFC\u5165",onPaste:je})}),(0,n.jsx)(p.Z.Item,{name:"type",label:"\u7C7B\u578B",rules:[{required:!0}],initialValue:"public-repo",children:(0,n.jsxs)(b.ZP.Group,{onChange:Ie,children:[(0,n.jsx)(b.ZP,{value:"public-repo",children:"\u516C\u5F00\u4ED3\u5E93"}),(0,n.jsx)(b.ZP,{value:"private-repo",children:"\u79C1\u6709\u4ED3\u5E93"}),(0,n.jsx)(b.ZP,{value:"file",children:"\u5355\u6587\u4EF6"})]})}),(0,n.jsx)(p.Z.Item,{name:"url",label:"\u94FE\u63A5",rules:[{required:!0},{pattern:x==="file"?re:ve}],children:(0,n.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8BA2\u9605\u94FE\u63A5",onPaste:N,onChange:N})}),x!=="file"&&(0,n.jsx)(p.Z.Item,{name:"branch",label:"\u5206\u652F",children:(0,n.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165\u5206\u652F",onPaste:Be,onChange:Be})}),(0,n.jsx)(p.Z.Item,{name:"alias",label:"\u552F\u4E00\u503C",rules:[{required:!0,message:""}],tooltip:"\u552F\u4E00\u503C\u7528\u4E8E\u65E5\u5FD7\u76EE\u5F55\u548C\u79C1\u94A5\u522B\u540D",children:(0,n.jsx)(F.Z,{placeholder:"\u81EA\u52A8\u751F\u6210",disabled:!0})}),x==="private-repo"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z.Item,{name:"pull_type",label:"\u62C9\u53D6\u65B9\u5F0F",initialValue:"ssh-key",rules:[{required:!0}],children:(0,n.jsxs)(b.ZP.Group,{onChange:W,children:[(0,n.jsx)(b.ZP,{value:"ssh-key",children:"\u79C1\u94A5"}),(0,n.jsx)(b.ZP,{value:"user-pwd",children:"\u7528\u6237\u540D\u5BC6\u7801/Token"})]})}),(0,n.jsx)(Ae,{type:Pe})]}),(0,n.jsx)(p.Z.Item,{name:"schedule_type",label:"\u5B9A\u65F6\u7C7B\u578B",initialValue:"crontab",rules:[{required:!0}],children:(0,n.jsxs)(b.ZP.Group,{onChange:Se,children:[(0,n.jsx)(b.ZP,{value:"crontab",children:"crontab"}),(0,n.jsx)(b.ZP,{value:"interval",children:"interval"})]})}),(0,n.jsx)(p.Z.Item,{name:oe==="crontab"?"schedule":"interval_schedule",label:"\u5B9A\u65F6\u89C4\u5219",rules:[{required:!0},{validator:function(i,_){return oe==="interval"||!_||ce().parseExpression(_).hasNext()?Promise.resolve():Promise.reject("Subscription\u8868\u8FBE\u5F0F\u683C\u5F0F\u6709\u8BEF")}}],children:oe==="interval"?(0,n.jsx)(be,{}):(0,n.jsx)(F.Z,{placeholder:"\u79D2(\u53EF\u9009) \u5206 \u65F6 \u5929 \u6708 \u5468"})}),x!=="file"&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z.Item,{name:"whitelist",label:"\u767D\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,n.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u767D\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,n.jsx)(p.Z.Item,{name:"blacklist",label:"\u9ED1\u540D\u5355",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,n.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u9ED1\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,n.jsx)(p.Z.Item,{name:"dependences",label:"\u4F9D\u8D56\u6587\u4EF6",tooltip:"\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F",children:(0,n.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u811A\u672C\u4F9D\u8D56\u6587\u4EF6\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272"})}),(0,n.jsx)(p.Z.Item,{name:"extensions",label:"\u6587\u4EF6\u540E\u7F00",tooltip:"\u4ED3\u5E93\u9700\u8981\u62C9\u53D6\u7684\u6587\u4EF6\u540E\u7F00\uFF0C\u591A\u4E2A\u540E\u7F00\u7A7A\u683C\u5206\u9694\uFF0C\u9ED8\u8BA4\u4F7F\u7528\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684RepoFileExtensions",children:(0,n.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540E\u7F00"})}),(0,n.jsx)(p.Z.Item,{name:"sub_before",label:"\u6267\u884C\u524D",tooltip:"\u8FD0\u884C\u8BA2\u9605\u524D\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,n.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u524D\u8981\u6267\u884C\u7684\u547D\u4EE4"})}),(0,n.jsx)(p.Z.Item,{name:"sub_after",label:"\u6267\u884C\u540E",tooltip:"\u8FD0\u884C\u8BA2\u9605\u540E\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js",children:(0,n.jsx)(F.Z.TextArea,{rows:4,autoSize:!0,placeholder:"\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u540E\u8981\u6267\u884C\u7684\u547D\u4EE4"})})]}),(0,n.jsx)(p.Z.Item,{name:"proxy",label:"\u4EE3\u7406",tooltip:"\u516C\u5F00\u4ED3\u5E93\u652F\u6301HTTP/SOCK5\u4EE3\u7406\uFF0C\u79C1\u6709\u4ED3\u5E93\u652F\u6301SOCK5\u4EE3\u7406",children:(0,n.jsx)(F.Z,{placeholder:x==="private-repo"?"SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 IP:PORT":"HTTP/SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 http://127.0.0.1:1080"})})]})})};f.default=Ce},35167:function(){},13989:function(v,f,e){var d=e(33737);function r(s){if(Array.isArray(s))return d(s)}v.exports=r,v.exports.__esModule=!0,v.exports.default=v.exports},56037:function(v){function f(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}v.exports=f,v.exports.__esModule=!0,v.exports.default=v.exports},90623:function(v){function f(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}v.exports=f,v.exports.__esModule=!0,v.exports.default=v.exports},94434:function(v,f,e){var d=e(13989),r=e(56037),s=e(94945),h=e(90623);function D(l){return d(l)||r(l)||s(l)||h()}v.exports=D,v.exports.__esModule=!0,v.exports.default=v.exports}}]);

(self.webpackChunk_whyour_qinglong=self.webpackChunk_whyour_qinglong||[]).push([[9818],{30769:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var i=n(2053),r=n(75271),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M624 706.3h-74.1V464c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v242.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.7a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-download",theme:"outlined"},a=n(48881),c=function(e,t){return r.createElement(a.Z,(0,i.Z)({},e,{ref:t,icon:o}))};var l=r.forwardRef(c)},88939:function(e,t,n){"use strict";var i=n(2053),r=n(75271),o=n(19579),a=n(48881),c=function(e,t){return r.createElement(a.Z,(0,i.Z)({},e,{ref:t,icon:o.Z}))},l=r.forwardRef(c);t.Z=l},82802:function(e,t,n){"use strict";var i=n(26068),r=n.n(i),o=n(75271);t.Z=function(e,t,n){var i=n.treeNodeFilterProp;return(0,o.useMemo)((function(){var n=[];if(!t)return{treeData:e,keys:n};var o=t.toUpperCase();function a(e,t){var n=t[i];return String(n).toUpperCase().includes(o)}return{treeData:function e(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.map((function(t){var o=t.children,c=i||a(0,t),l=e(o||[],c);return c||l.length?(l.length&&n.push(t.key),r()(r()({},t),{},{children:l})):null})).filter((function(e){return e}))}(e),keys:n}}),[e,t,i])}},85565:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return A}});var i=n(15558),r=n.n(i),o=n(48305),a=n.n(o),c=n(82802),l=n(48916),s=n(3475),u=n(16314),f=n(30769),d=n(88939),p=n(47508),g=n(83383),h=n(71742),v=n(98783),m=n(50691),y=n(45520),b=n(61508),x=n(88142),w=n(59816),Z=n(93481),k=n(17082),j=n(13107),P=n(98705),E=n(87105),S=n(66292),B=n.n(S),M=n(4363),C=n.n(M),L=n(79514),T=n(75271),_=n(72317),R=n(43382),N={"left-tree-container":"left-tree-container___zHanw","left-tree-scroller":"left-tree-scroller___PInUN","log-container":"log-container___ba9Tr"},D=n(52676),F=m.Z.Text,A=function(){var e=(0,v.useOutletContext)(),t=e.headerStyle,n=e.isPhone,i=e.theme,o=(0,T.useState)(_.ZP.get("请选择日志文件")),m=a()(o,2),S=m[0],M=m[1],A=(0,T.useState)(_.ZP.get("请选择日志文件")),O=a()(A,2),U=O[0],H=O[1],z=(0,T.useState)([]),I=a()(z,2),G=I[0],q=I[1],W=(0,T.useState)(!1),Y=a()(W,2),$=Y[0],K=Y[1],X=(0,T.useState)(),V=a()(X,2),J=V[0],Q=V[1],ee=(0,T.useRef)(),te=(0,T.useState)([]),ne=a()(te,2),ie=ne[0],re=ne[1],oe=(0,T.useState)(),ae=a()(oe,2),ce=ae[0],le=ae[1],se=(0,T.useState)(""),ue=a()(se,2),fe=ue[0],de=ue[1],pe=function(e,t){t.key!==U&&e&&(le(t),H(e),"directory"!==t.type?(M(_.ZP.get("加载中...")),function(e){u.W.get("".concat(s.Z.apiPrefix,"logs/detail?file=").concat(e.title,"&path=").concat(e.parent||"")).then((function(e){var t=e.code,n=e.data;200===t&&M(n)}))}(t)):M(_.ZP.get("请选择日志文件")))},ge=(0,T.useCallback)((function(e,t){pe(e[0],t.node)}),[]),he=(0,T.useCallback)((function(e){var t=e.target.value;ve(t)}),[G]),ve=(0,T.useCallback)(B()((function(e){de(e)}),300),[G]),me=(0,c.Z)(G,fe,{treeNodeFilterProp:"title"}),ye=me.treeData,be=me.keys;(0,T.useEffect)((function(){re(C()([].concat(r()(ie),r()(be))))}),[be]);var xe=function(){H(""),le(null),M(_.ZP.get("请选择脚本文件"))};return(0,T.useEffect)((function(){K(!0),u.W.get("".concat(s.Z.apiPrefix,"logs")).then((function(e){var t=e.code,n=e.data;200===t&&q(n)})).finally((function(){return K(!1)}))}),[]),(0,T.useEffect)((function(){ee.current&&Q(ee.current.clientHeight)}),[ee.current,G]),(0,D.jsx)(p.ZP,{className:"ql-container-wrapper log-wrapper",title:(0,D.jsxs)(D.Fragment,{children:[U,"file"===(null==ce?void 0:ce.type)&&(0,D.jsx)("span",{style:{marginLeft:6,fontSize:12,color:"#999",display:"inline-block",height:14},children:(0,L.Z)(ce.size)})]}),loading:$,extra:n?[(0,D.jsx)(x.Z,{treeExpandAction:"click",className:"log-select",value:U,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:G,placeholder:_.ZP.get("请选择日志"),fieldNames:{value:"key"},treeNodeFilterProp:"title",showSearch:!0,allowClear:!0,onSelect:pe})]:[(0,D.jsx)(w.Z,{title:_.ZP.get("下载"),children:(0,D.jsx)(Z.Z,{disabled:!ce||"directory"===ce.type,type:"primary",onClick:function(){u.W.post("".concat(s.Z.apiPrefix,"logs/download"),{filename:ce.title,path:ce.parent||""},{responseType:"blob"}).then((function(e){(0,E.saveAs)(e,ce.title)}))},icon:(0,D.jsx)(f.Z,{})})}),(0,D.jsx)(w.Z,{title:_.ZP.get("删除"),children:(0,D.jsx)(Z.Z,{type:"primary",disabled:!ce,onClick:function(){y.Z.confirm({title:"确认删除",content:(0,D.jsxs)(D.Fragment,{children:[_.ZP.get("确认删除"),(0,D.jsxs)(F,{style:{wordBreak:"break-all"},type:"warning",children:[" ",U," "]}),_.ZP.get("文件"),"directory"===ce.type?_.ZP.get("夹下所有日志"):"",_.ZP.get("，删除后不可恢复")]}),onOk:function(){u.W.delete("".concat(s.Z.apiPrefix,"logs"),{data:{filename:ce.title,path:ce.parent||"",type:ce.type}}).then((function(e){if(200===e.code){b.ZP.success("删除成功");var t=r()(G);if(ce.parent)t=(0,l.I1)(t,(function(e){return e.key===ce.key}));else{var n=t.findIndex((function(e){return e.key===ce.key}));-1!==n&&t.splice(n,1)}q(t),xe()}}))}})},icon:(0,D.jsx)(d.Z,{})})})],header:{style:t},children:(0,D.jsxs)("div",{className:"".concat(N["log-container"]," log-container"),children:[!n&&(0,D.jsxs)(R.Z,{split:"vertical",size:200,maxSize:-100,children:[(0,D.jsx)("div",{className:N["left-tree-container"],children:G.length>0?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(k.Z.Search,{className:N["left-tree-search"],onChange:he,placeholder:_.ZP.get("请输入日志名"),allowClear:!0}),(0,D.jsx)("div",{className:N["left-tree-scroller"],ref:ee,children:(0,D.jsx)(j.Z,{expandAction:"click",className:N["left-tree"],treeData:ye,showIcon:!0,height:J,selectedKeys:[U],showLine:{showLeafIcon:!0},onSelect:ge,expandedKeys:ie,onExpand:function(e){re(e)}})})]}):(0,D.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,D.jsx)(P.Z,{description:_.ZP.get("暂无日志"),image:P.Z.PRESENTED_IMAGE_SIMPLE})})}),(0,D.jsx)(g.ZP,{language:"shell",theme:i,value:S,options:{readOnly:!0,fontSize:12,minimap:{enabled:!1},lineNumbersMinChars:3,folding:!1,glyphMargin:!1}})]}),n&&(0,D.jsx)(h.ZP,{value:S,readOnly:!0,theme:i.includes("dark")?"dark":"light",onChange:function(e,t){M(e)}})]})})}},87105:function(e,t,n){var i,r,o;r=[],void 0===(o="function"==typeof(i=function(){"use strict";function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function i(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){c(i.response,t,n)},i.onerror=function(){console.error("could not download file")},i.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,c=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype?function(e,t,n){var c=a.URL||a.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?o(l):r(l.href)?i(e,t,n):o(l,l.target="_blank")):(l.href=c.createObjectURL(e),setTimeout((function(){c.revokeObjectURL(l.href)}),4e4),setTimeout((function(){o(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,a),n);else if(r(e))i(e,n,a);else{var c=document.createElement("a");c.href=e,c.target="_blank",setTimeout((function(){o(c)}))}}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof e)return i(e,t,n);var o="application/octet-stream"===e.type,c=/constructor/i.test(a.HTMLElement)||a.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||o&&c)&&"object"==typeof FileReader){var s=new FileReader;s.onloadend=function(){var e=s.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=e:location=e,r=null},s.readAsDataURL(e)}else{var u=a.URL||a.webkitURL,f=u.createObjectURL(e);r?r.location=f:location.href=f,r=null,setTimeout((function(){u.revokeObjectURL(f)}),4e4)}});a.saveAs=c.saveAs=c,e.exports=c})?i.apply(t,r):i)||(e.exports=o)},45170:function(e,t,n){var i=n(13807);e.exports=function(e,t){return!!(null==e?0:e.length)&&i(e,t,0)>-1}},94936:function(e){e.exports=function(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1}},92504:function(e){e.exports=function(e,t,n,i){for(var r=e.length,o=n+(i?1:-1);i?o--:++o<r;)if(t(e[o],o,e))return o;return-1}},13807:function(e,t,n){var i=n(92504),r=n(99940),o=n(3729);e.exports=function(e,t,n){return t==t?o(e,t,n):i(e,r,n)}},99940:function(e){e.exports=function(e){return e!=e}},95453:function(e,t,n){var i=n(78188),r=n(45170),o=n(94936),a=n(29880),c=n(17319),l=n(79967);e.exports=function(e,t,n){var s=-1,u=r,f=e.length,d=!0,p=[],g=p;if(n)d=!1,u=o;else if(f>=200){var h=t?null:c(e);if(h)return l(h);d=!1,u=a,g=new i}else g=t?[]:p;e:for(;++s<f;){var v=e[s],m=t?t(v):v;if(v=n||0!==v?v:0,d&&m==m){for(var y=g.length;y--;)if(g[y]===m)continue e;t&&g.push(m),p.push(v)}else u(g,m,n)||(g!==p&&g.push(m),p.push(v))}return p}},17319:function(e,t,n){var i=n(81956),r=n(43226),o=n(79967),a=i&&1/o(new i([,-0]))[1]==1/0?function(e){return new i(e)}:r;e.exports=a},3729:function(e){e.exports=function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}},43226:function(e){e.exports=function(){}},4363:function(e,t,n){var i=n(95453);e.exports=function(e){return e&&e.length?i(e):[]}},79514:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});const i=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],r=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],o=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],a=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],c=(e,t,n)=>{let i=e;return"string"==typeof t||Array.isArray(t)?i=e.toLocaleString(t,n):!0!==t&&void 0===n||(i=e.toLocaleString(void 0,n)),i};function l(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const n=(t={bits:!1,binary:!1,space:!0,...t}).bits?t.binary?a:o:t.binary?r:i,l=t.space?" ":"";if(t.signed&&0===e)return` 0${l}${n[0]}`;const s=e<0,u=s?"-":t.signed?"+":"";let f;if(s&&(e=-e),void 0!==t.minimumFractionDigits&&(f={minimumFractionDigits:t.minimumFractionDigits}),void 0!==t.maximumFractionDigits&&(f={maximumFractionDigits:t.maximumFractionDigits,...f}),e<1){return u+c(e,t.locale,f)+l+n[0]}const d=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),n.length-1);e/=(t.binary?1024:1e3)**d,f||(e=e.toPrecision(3));return u+c(Number(e),t.locale,f)+l+n[d]}}}]);
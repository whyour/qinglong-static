"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5969],{44639:function(me,R,e){var S=e(55258),b=(0,S.Z)({scriptUrl:["//at.alicdn.com/t/c/font_3354854_ob5y15ewlyq.js"]});R.Z=b},77853:function(me,R,e){e.r(R);var S=e(12342),b=e.n(S),Q=e(25359),M=e.n(Q),X=e(57213),d=e.n(X),q=e(49811),ee=e.n(q),C=e(54306),k=e.n(C),I=e(63313),ce=e.n(I),u=e(67393),g=e(28756),ne=e(84163),$=e(22159),z=e(24378),T=e(2947),V=e(35911),te=e(90717),G=e(32320),Y=e(26839),_e=e(44639),n=e(11527),ae=["key","name"],le=["key","name"],s=[{name:"\u547D\u4EE4",value:"command"},{name:"\u540D\u79F0",value:"name"},{name:"\u5B9A\u65F6\u89C4\u5219",value:"schedule"},{name:"\u72B6\u6001",value:"status"},{name:"\u6807\u7B7E",value:"labels"}],oe={Reg:"",NotReg:"",In:"select",Nin:"select"},re=[{name:"\u5305\u542B",value:"Reg"},{name:"\u4E0D\u5305\u542B",value:"NotReg"},{name:"\u5C5E\u4E8E",value:"In",type:"select"},{name:"\u4E0D\u5C5E\u4E8E",value:"Nin",type:"select"}],H=[{name:"\u987A\u5E8F",value:"ASC"},{name:"\u5012\u5E8F",value:"DESC"}],ie={status:[{name:"\u8FD0\u884C\u4E2D",value:0},{name:"\u7A7A\u95F2\u4E2D",value:1},{name:"\u5DF2\u7981\u7528",value:2}]},W;(function(E){E.and="\u4E14",E.or="\u6216"})(W||(W={}));var se=function(p){var D=p.view,L=p.handleCancel,f=p.visible,U=u.Z.useForm(),K=k()(U,1),j=K[0],y=(0,I.useState)(!1),v=k()(y,2),B=v[0],x=v[1],Z=(0,I.useState)("and"),F=k()(Z,2),O=F[0],N=F[1],h=u.Z.useWatch("filters",j),P=function(){var m=ee()(M()().mark(function r(_){var t,a,l,c;return M()().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return x(!0),_.filterRelation=O,t=D?"put":"post",o.prev=3,o.next=6,V.W[t]("".concat(te.Z.apiPrefix,"crons/views"),{data:D?d()(d()({},_),{},{id:D.id}):_});case 6:a=o.sent,l=a.code,c=a.data,l===200&&L(c),x(!1),o.next=16;break;case 13:o.prev=13,o.t0=o.catch(3),x(!1);case 16:case"end":return o.stop()}},r,null,[[3,13]])}));return function(_){return m.apply(this,arguments)}}();(0,I.useEffect)(function(){D||j.resetFields(),j.setFieldsValue(D||{filters:[{property:"command",operation:"Reg"}]})},[D,f]);var w=(0,n.jsx)(g.Z,{style:{width:80},children:re.map(function(m){return(0,n.jsx)(g.Z.Option,{value:m.value,children:m.name},m.name)})}),A=function(r){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,n.jsx)(g.Z,{style:_,children:r.map(function(t){return(0,n.jsx)(g.Z.Option,{value:t.value,children:t.name},t.name)})})},de=(0,n.jsx)(g.Z,{style:{width:80},children:H.map(function(m){return(0,n.jsx)(g.Z.Option,{value:m.value,children:m.name},m.name)})}),ue=function(r){var _;return(0,n.jsx)(g.Z,{mode:"tags",allowClear:!0,placeholder:"\u8F93\u5165\u540E\u56DE\u8F66\u589E\u52A0\u81EA\u5B9A\u4E49\u9009\u9879",children:(_=ie[r])===null||_===void 0?void 0:_.map(function(t){return(0,n.jsx)(g.Z.Option,{value:t.value,children:t.name},t.name)})})};return(0,n.jsx)(ne.Z,{title:D?"\u7F16\u8F91\u89C6\u56FE":"\u65B0\u5EFA\u89C6\u56FE",open:f,forceRender:!0,width:580,centered:!0,maskClosable:!1,onOk:function(){j.validateFields().then(function(r){P(r)}).catch(function(r){console.log("Validate Failed:",r)})},onCancel:function(){return L()},confirmLoading:B,children:(0,n.jsxs)(u.Z,{form:j,layout:"vertical",name:"env_modal",children:[(0,n.jsx)(u.Z.Item,{name:"name",label:"\u89C6\u56FE\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"}],children:(0,n.jsx)($.Z,{placeholder:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"})}),(0,n.jsx)(u.Z.List,{name:"filters",children:function(r,_){var t=_.add,a=_.remove;return(0,n.jsxs)("div",{style:{position:"relative"},className:"view-filters-container ".concat(r.length>1?"active":""),children:[r.length>1&&(0,n.jsx)("div",{style:{position:"absolute",width:50,borderRadius:10,border:"1px solid rgb(190, 220, 255)",borderRight:"none",height:56*(r.length-1),top:46,left:15},children:(0,n.jsx)(z.Z,{type:"primary",size:"small",style:{position:"absolute",top:"50%",translate:"-50% -50%",padding:"0 3px",cursor:"pointer"},onClick:function(){N(O==="and"?"or":"and")},children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:W[O]}),(0,n.jsx)(_e.Z,{type:"ql-icon-d-caret"})]})})}),(0,n.jsxs)("div",{children:[r.map(function(l){var c=l.key,i=l.name,o=b()(l,ae);return(0,n.jsx)(u.Z.Item,{label:i===0?"\u7B5B\u9009\u6761\u4EF6":"",style:{marginBottom:0},required:!0,className:"filter-item",children:(0,n.jsxs)(T.Z,{className:"view-create-modal-filters",align:"baseline",children:[(0,n.jsx)(u.Z.Item,d()(d()({},o),{},{name:[i,"property"],rules:[{required:!0}],children:A(s,{width:90})})),(0,n.jsx)(u.Z.Item,d()(d()({},o),{},{name:[i,"operation"],rules:[{required:!0}],children:w})),(0,n.jsx)(u.Z.Item,d()(d()({},o),{},{name:[i,"value"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9"}],children:oe[h==null?void 0:h[i].operation]==="select"?ue(h==null?void 0:h[i].property):(0,n.jsx)($.Z,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"})})),i!==0&&(0,n.jsx)(G.Z,{onClick:function(){return a(i)}})]})},c)}),(0,n.jsx)(u.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return t({property:"command",operation:"Reg"})},children:[(0,n.jsx)(Y.Z,{}),"\u65B0\u589E\u7B5B\u9009\u6761\u4EF6"]})})]})]})}}),(0,n.jsx)(u.Z.List,{name:"sorts",children:function(r,_){var t=_.add,a=_.remove;return(0,n.jsxs)("div",{style:{position:"relative"},className:"view-filters-container ".concat(r.length>1?"active":""),children:[r.length>1&&(0,n.jsx)("div",{style:{position:"absolute",width:50,borderRadius:10,border:"1px solid rgb(190, 220, 255)",borderRight:"none",height:56*(r.length-1),top:46,left:15},children:(0,n.jsx)(z.Z,{type:"primary",size:"small",style:{position:"absolute",top:"50%",translate:"-50% -50%",padding:"0 3px",cursor:"pointer"},children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("span",{children:W[O]})})})}),(0,n.jsxs)("div",{children:[r.map(function(l){var c=l.key,i=l.name,o=b()(l,le);return(0,n.jsx)(u.Z.Item,{label:i===0?"\u6392\u5E8F\u65B9\u5F0F":"",style:{marginBottom:0},className:"filter-item",children:(0,n.jsxs)(T.Z,{className:"view-create-modal-sorts",align:"baseline",children:[(0,n.jsx)(u.Z.Item,d()(d()({},o),{},{name:[i,"property"],rules:[{required:!0}],children:A(s)})),(0,n.jsx)(u.Z.Item,d()(d()({},o),{},{name:[i,"type"],rules:[{required:!0}],children:de})),(0,n.jsx)(G.Z,{onClick:function(){return a(i)}})]})},c)}),(0,n.jsx)(u.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return t({property:"command",type:"ASC"})},children:[(0,n.jsx)(Y.Z,{}),"\u65B0\u589E\u6392\u5E8F\u65B9\u5F0F"]})})]})]})}})]})})};R.default=se},15969:function(me,R,e){e.r(R);var S=e(93525),b=e.n(S),Q=e(57213),M=e.n(Q),X=e(54306),d=e.n(X),q=e(12342),ee=e.n(q),C=e(63313),k=e.n(C),I=e(92260),ce=e(16861),u=e(2947),g=e(84163),ne=e(9835),$=e(24378),z=e(60986),T=e(35911),V=e(90717),te=e(32132),G=e(13740),Y=e(17688),_e=e(57627),n=e(70011),ae=e(66255),le=e(77853),s=e(11527),oe=["index","moveRow","className","style"],re=I.Z.Text,H="DragableBodyRow",ie=function(E){var p=E.index,D=E.moveRow,L=E.className,f=E.style,U=ee()(E,oe),K=(0,C.useRef)(),j=(0,Y.L)({accept:H,collect:function(P){var w=P.getItem()||{},A=w.index;return A===p?{}:{isOver:P.isOver(),dropClassName:A<p?" drop-over-downward":" drop-over-upward"}},drop:function(P){D(P.index,p)}}),y=d()(j,2),v=y[0],B=v.isOver,x=v.dropClassName,Z=y[1],F=(0,_e.c)({type:H,item:{index:p},collect:function(P){return{isDragging:P.isDragging()}}}),O=d()(F,2),N=O[1];return Z(N(K)),(0,s.jsx)("tr",M()({ref:K,className:"".concat(L).concat(B?x:""),style:M()({cursor:"move"},f)},U))},W=function(E){var p=E.cronViews,D=E.handleCancel,L=E.visible,f=E.cronViewChange,U=function(t){return v.filter(function(a){return!a.isDisabled}).length<=1&&!t.isDisabled},K=[{title:"\u540D\u79F0",dataIndex:"name",key:"name"},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",render:function(t){return t===1?"\u7CFB\u7EDF":"\u4E2A\u4EBA"}},{title:"\u663E\u793A",key:"isDisabled",dataIndex:"isDisabled",width:100,render:function(t,a,l){return(0,s.jsx)(ce.Z,{disabled:U(a),checked:!a.isDisabled,onChange:function(i){return ue(i,a,l)}})}},{title:"\u64CD\u4F5C",key:"action",width:100,render:function(t,a,l){return a.type!==1?(0,s.jsxs)(u.Z,{size:"middle",children:[(0,s.jsx)("a",{onClick:function(){return A(a,l)},children:(0,s.jsx)(te.Z,{})}),!U(a)&&(0,s.jsx)("a",{onClick:function(){return de(a,l)},children:(0,s.jsx)(G.Z,{})})]}):"-"}}],j=(0,C.useState)([]),y=d()(j,2),v=y[0],B=y[1],x=(0,C.useState)(!1),Z=d()(x,2),F=Z[0],O=Z[1],N=(0,C.useState)(null),h=d()(N,2),P=h[0],w=h[1],A=function(t,a){w(t),O(!0)},de=function(t,a){g.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,s.jsxs)(s.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u89C6\u56FE"," ",(0,s.jsx)(re,{style:{wordBreak:"break-all"},type:"warning",children:t.name})," ","\u5417"]}),onOk:function(){T.W.delete("".concat(V.Z.apiPrefix,"crons/views"),{data:[t.id]}).then(function(c){var i=c.code,o=c.data;i===200&&(ne.ZP.success("\u5220\u9664\u6210\u529F"),f())})},onCancel:function(){console.log("Cancel")}})},ue=function(t,a,l){T.W.put("".concat(V.Z.apiPrefix,"crons/views/").concat(t?"enable":"disable"),{data:[a.id]}).then(function(c){var i=c.code,o=c.data;if(i===200){var J=b()(v);J.splice(l,1,M()(M()({},v[l]),{},{isDisabled:!t})),B(J),f()}})},m={body:{row:ie}},r=(0,C.useCallback)(function(_,t){if(_!==t){var a=v[_];T.W.put("".concat(V.Z.apiPrefix,"crons/views/move"),{data:{fromIndex:_,toIndex:t,id:a.id}}).then(function(l){var c=l.code,i=l.data;if(c===200){var o=b()(v);o.splice(_,1),o.splice(t,0,M()(M()({},a),i)),B(o),f()}})}},[v]);return(0,C.useEffect)(function(){B(p)},[p]),(0,s.jsxs)(g.Z,{title:"\u89C6\u56FE\u7BA1\u7406",open:L,centered:!0,width:620,onCancel:function(){return D()},className:"view-manage-modal",forceRender:!0,footer:!1,maskClosable:!1,children:[(0,s.jsx)(u.Z,{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:(0,s.jsx)($.Z,{type:"primary",onClick:function(){w(null),O(!0)},children:"\u65B0\u5EFA\u89C6\u56FE"},"2")}),(0,s.jsx)(n.W,{backend:ae.PD,children:(0,s.jsx)(z.Z,{bordered:!0,columns:K,pagination:!1,dataSource:v,rowKey:"id",size:"middle",style:{marginBottom:20},components:m,onRow:function(t,a){return{index:a,moveRow:r}}})}),(0,s.jsx)(le.default,{view:P,visible:F,handleCancel:function(t){O(!1),f(t)}})]})};R.default=W}}]);

(self.webpackChunk=self.webpackChunk||[]).push([[9914],{20209:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(14797),r=n(63313),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M686.7 638.6L544.1 535.5V288c0-4.4-3.6-8-8-8H488c-4.4 0-8 3.6-8 8v275.4c0 2.6 1.2 5 3.3 6.5l165.4 120.6c3.6 2.6 8.6 1.8 11.2-1.7l28.6-39c2.6-3.7 1.8-8.7-1.8-11.2z"}}]},name:"clock-circle",theme:"outlined"},a=n(46420),c=function(e,t){return r.createElement(a.Z,(0,i.Z)((0,i.Z)({},e),{},{ref:t,icon:s}))};c.displayName="ClockCircleOutlined";var o=r.forwardRef(c)},13740:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(14797),r=n(63313),s={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},a=n(46420),c=function(e,t){return r.createElement(a.Z,(0,i.Z)((0,i.Z)({},e),{},{ref:t,icon:s}))};c.displayName="DeleteOutlined";var o=r.forwardRef(c)},65601:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var i=n(14797),r=n(63313),s={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"}}]},name:"loading-3-quarters",theme:"outlined"},a=n(46420),c=function(e,t){return r.createElement(a.Z,(0,i.Z)((0,i.Z)({},e),{},{ref:t,icon:s}))};c.displayName="Loading3QuartersOutlined";var o=r.forwardRef(c)},9839:function(e,t,n){"use strict";var i=n(54306),r=n.n(i),s=n(63313),a=n(61761),c=n(40141);t.Z=function(e,t){var n=(0,s.useState)(0),i=r()(n,2),o=i[0],u=i[1];return(0,a.Z)(e,(function(e){var n=e.target;n.classList.contains("ant-table-wrapper")||(n=e.target.querySelector(".ant-table-wrapper")),u((0,c.W9)({extraHeight:t,target:n}))})),o}},39079:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return te}});var i=n(93525),r=n.n(i),s=n(54306),a=n.n(s),c=n(57213),o=n.n(c),u=n(88265),l=n(63313),d=n(92260),f=n(22159),h=n(2947),v=n(51704),p=n(15367),m=n(84163),g=n(24378),y=n(86986),x=n(94674),Z=n(14797),b={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},k=n(46420),w=function(e,t){return l.createElement(k.Z,(0,Z.Z)((0,Z.Z)({},e),{},{ref:t,icon:b}))};w.displayName="SyncOutlined";var $=l.forwardRef(w),j=n(38101),S=n(76657),P=n(20209),M={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},C=function(e,t){return l.createElement(k.Z,(0,Z.Z)((0,Z.Z)({},e),{},{ref:t,icon:M}))};C.displayName="FileTextOutlined";var D=l.forwardRef(C),O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 280h56c4.4 0 8-3.6 8-8 0-28.3 5.9-53.2 17.1-73.5 10.6-19.4 26-34.8 45.4-45.4C450.9 142 475.7 136 504 136h16c28.3 0 53.2 5.9 73.5 17.1 19.4 10.6 34.8 26 45.4 45.4C650 218.9 656 243.7 656 272c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-40-8.8-76.7-25.9-108.1a184.31 184.31 0 00-74-74C596.7 72.8 560 64 520 64h-16c-40 0-76.7 8.8-108.1 25.9a184.31 184.31 0 00-74 74C304.8 195.3 296 232 296 272c0 4.4 3.6 8 8 8z"}},{tag:"path",attrs:{d:"M940 512H792V412c76.8 0 139-62.2 139-139 0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8a63 63 0 01-63 63H232a63 63 0 01-63-63c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 76.8 62.2 139 139 139v100H84c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h148v96c0 6.5.2 13 .7 19.3C164.1 728.6 116 796.7 116 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-44.2 23.9-82.9 59.6-103.7a273 273 0 0022.7 49c24.3 41.5 59 76.2 100.5 100.5S460.5 960 512 960s99.8-13.9 141.3-38.2a281.38 281.38 0 00123.2-149.5A120 120 0 01836 876c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8 0-79.3-48.1-147.4-116.7-176.7.4-6.4.7-12.8.7-19.3v-96h148c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM716 680c0 36.8-9.7 72-27.8 102.9-17.7 30.3-43 55.6-73.3 73.3C584 874.3 548.8 884 512 884s-72-9.7-102.9-27.8c-30.3-17.7-55.6-43-73.3-73.3A202.75 202.75 0 01308 680V412h408v268z"}}]},name:"bug",theme:"outlined"},H=function(e,t){return l.createElement(k.Z,(0,Z.Z)((0,Z.Z)({},e),{},{ref:t,icon:O}))};H.displayName="BugOutlined";var I=l.forwardRef(H),z=n(13740),A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 256H736v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zm-200 0H360v-72h304v72z"}}]},name:"delete",theme:"filled"},T=function(e,t){return l.createElement(k.Z,(0,Z.Z)((0,Z.Z)({},e),{},{ref:t,icon:A}))};T.displayName="DeleteFilled";var L=l.forwardRef(T),E=n(15207),W=n(23435),N=n(57229),Y=n(53261),_=n(12701),F=n(66255),R=n(71467),B=n(14851),V=n(9839),J=n(52053),q=n.n(J),U=n(21758),K=n(11527),Q=d.Z.Text,G=f.Z.Search,X=function(e){return e[e["安装中"]=0]="安装中",e[e["已安装"]=1]="已安装",e[e["安装失败"]=2]="安装失败",e[e["删除中"]=3]="删除中",e[e["已删除"]=4]="已删除",e[e["删除失败"]=5]="删除失败",e[e["队列中"]=6]="队列中",e}(X||{}),ee={0:{icon:(0,K.jsx)($,{spin:!0}),color:"processing"},1:{icon:(0,K.jsx)(j.Z,{}),color:"success"},2:{icon:(0,K.jsx)(S.Z,{}),color:"error"},3:{icon:(0,K.jsx)($,{spin:!0}),color:"processing"},4:{icon:(0,K.jsx)(j.Z,{}),color:"success"},5:{icon:(0,K.jsx)(S.Z,{}),color:"error"},6:{icon:(0,K.jsx)(P.Z,{}),color:"default"}},te=function(){var e=(0,B.useOutletContext)(),t=e.headerStyle,n=e.isPhone,i=[{title:u.ZP.get("序号"),width:90,render:function(e,t,n){return(0,K.jsxs)("span",{style:{cursor:"text"},children:[n+1," "]})}},{title:u.ZP.get("名称"),dataIndex:"name",width:180,key:"name"},{title:u.ZP.get("状态"),key:"status",width:120,dataIndex:"status",render:function(e,t,n){var i,r;return console.log(t.status),(0,K.jsx)(h.Z,{size:"middle",style:{cursor:"text"},children:(0,K.jsx)(v.Z,{color:null===(i=ee[t.status])||void 0===i?void 0:i.color,icon:null===(r=ee[t.status])||void 0===r?void 0:r.icon,style:{marginRight:0},children:u.ZP.get(X[t.status])})})}},{title:u.ZP.get("备注"),dataIndex:"remark",width:100,key:"remark"},{title:u.ZP.get("更新时间"),key:"updatedAt",dataIndex:"updatedAt",width:150,render:function(e){return(0,K.jsx)("span",{children:q()(e).format("YYYY-MM-DD HH:mm:ss")})}},{title:u.ZP.get("创建时间"),key:"createdAt",dataIndex:"createdAt",width:150,render:function(e){return(0,K.jsx)("span",{children:q()(e).format("YYYY-MM-DD HH:mm:ss")})}},{title:u.ZP.get("操作"),key:"action",width:140,render:function(e,t,i){var r=!n;return(0,K.jsxs)(h.Z,{size:"middle",children:[(0,K.jsx)(p.Z,{title:r?u.ZP.get("日志"):"",children:(0,K.jsx)("a",{onClick:function(){ue(o()(o()({},t),{},{timestamp:Date.now()}))},children:(0,K.jsx)(D,{})})}),t.status!==X.安装中&&t.status!==X.删除中&&(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(p.Z,{title:r?u.ZP.get("重新安装"):"",children:(0,K.jsx)("a",{onClick:function(){return ke(t,i)},children:(0,K.jsx)(I,{})})}),(0,K.jsx)(p.Z,{title:r?u.ZP.get("删除"):"",children:(0,K.jsx)("a",{onClick:function(){return be(t,i)},children:(0,K.jsx)(z.Z,{})})}),(0,K.jsx)(p.Z,{title:r?u.ZP.get("强制删除"):"",children:(0,K.jsx)("a",{onClick:function(){return be(t,i,!0)},children:(0,K.jsx)(L,{})})})]})]})}}],s=(0,l.useState)([]),c=a()(s,2),d=c[0],f=c[1],Z=(0,l.useState)(!0),b=a()(Z,2),k=b[0],w=b[1],$=(0,l.useState)(!1),j=a()($,2),S=j[0],P=j[1],M=(0,l.useState)(),C=a()(M,2),O=C[0],H=C[1],A=(0,l.useState)([]),T=a()(A,2),J=T[0],te=T[1],ne=(0,l.useState)(""),ie=a()(ne,2),re=ie[0],se=ie[1],ae=(0,l.useState)(),ce=a()(ae,2),oe=ce[0],ue=ce[1],le=(0,l.useState)(!1),de=a()(le,2),fe=de[0],he=de[1],ve=(0,l.useState)("nodejs"),pe=a()(ve,2),me=pe[0],ge=pe[1],ye=(0,l.useRef)(null),xe=(0,V.Z)(ye,59),Ze=function(){w(!0),N.W.get("".concat(E.Z.apiPrefix,"dependencies?searchValue=").concat(re,"&type=").concat(me)).then((function(e){var t=e.code,n=e.data;200===t&&f(n)})).finally((function(){return w(!1)}))},be=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];m.Z.confirm({title:u.ZP.get("确认删除"),content:(0,K.jsxs)(K.Fragment,{children:[u.ZP.get("确认删除依赖")," ",(0,K.jsx)(Q,{style:{wordBreak:"break-all"},type:"warning",children:e.name})," ",u.ZP.get("吗")]}),onOk:function(){N.W.delete("".concat(E.Z.apiPrefix,"dependencies").concat(n?"/force":""),{data:[e.id]}).then((function(e){var t=e.code,i=e.data;if(200===t&&n){var s=d.findIndex((function(e){return e.id===i[0].id}));if(-1!==s){var a=r()(d);a.splice(s,1),f(a)}}}))},onCancel:function(){console.log("Cancel")}})},ke=function(e,t){m.Z.confirm({title:u.ZP.get("确认重新安装"),content:(0,K.jsxs)(K.Fragment,{children:[u.ZP.get("确认重新安装")," ",(0,K.jsx)(Q,{style:{wordBreak:"break-all"},type:"warning",children:e.name})," ",u.ZP.get("吗")]}),onOk:function(){N.W.put("".concat(E.Z.apiPrefix,"dependencies/reinstall"),[e.id]).then((function(e){var t=e.code,n=e.data;200===t&&we(n[0])}))},onCancel:function(){console.log("Cancel")}})},we=function(e){var t=r()(d);if(Array.isArray(e))t.unshift.apply(t,r()(e));else{var n=d.findIndex((function(t){return t.id===e.id}));-1!==n&&t.splice(n,1,o()({},e))}f(t)},$e={selectedRowKeys:J,onChange:function(e){te(e)}},je=function(e){var t=e?"/force":"";m.Z.confirm({title:u.ZP.get("确认删除"),content:(0,K.jsx)(K.Fragment,{children:u.ZP.get("确认删除选中的依赖吗")}),onOk:function(){N.W.delete("".concat(E.Z.apiPrefix,"dependencies").concat(t),{data:J}).then((function(e){var t=e.code;e.data;200===t&&(te([]),Ze())}))},onCancel:function(){console.log("Cancel")}})};(0,l.useEffect)((function(){Ze()}),[re,me]),(0,l.useEffect)((function(){oe&&(localStorage.setItem("logDependence",oe.id),he(!0))}),[oe]);var Se=(0,l.useCallback)((function(e){var t=e.message,n=e.references,i=void 0;t.includes("开始时间")&&n.length>0&&(i=t.includes("安装")?X.安装中:X.删除中),t.includes("结束时间")&&n.length>0&&(i=t.includes("安装")?t.includes("成功")?X.已安装:X.安装失败:t.includes("成功")?X.已删除:X.删除失败)===X.已删除?setTimeout((function(){f((function(e){for(var t=r()(e),i=function(i){var r=e.findIndex((function(e){return e.id===n[i]}));-1!==r&&t.splice(r,1)},s=0;s<n.length;s++)i(s);return t}))}),5e3):"number"==typeof i&&f((function(e){for(var t=r()(e),s=function(r){var s=e.findIndex((function(e){return e.id===n[r]}));-1!==s&&t.splice(s,1,o()(o()({},e[s]),{},{status:i}))},a=0;a<n.length;a++)s(a);return t}))}),[]);(0,l.useEffect)((function(){var e=U.Z.getInstance();return e.subscribe("installDependence",Se),e.subscribe("uninstallDependence",Se),function(){e.unsubscribe("installDependence",Se),e.unsubscribe("uninstallDependence",Se)}}),[]);return(0,K.jsxs)(W.ZP,{className:"ql-container-wrapper dependence-wrapper ql-container-wrapper-has-tab",title:u.ZP.get("依赖管理"),extra:[(0,K.jsx)(G,{placeholder:u.ZP.get("请输入名称"),style:{width:"auto"},enterButton:!0,loading:k,onSearch:function(e){se(e.trim())}}),(0,K.jsx)(g.Z,{type:"primary",onClick:function(){return H(null),void P(!0)},children:u.ZP.get("创建依赖")},"2")],header:{style:t},children:[(0,K.jsx)(y.Z,{defaultActiveKey:"nodejs",size:"small",tabPosition:"top",onChange:function(e){te([]),ge(e)},items:[{key:"nodejs",label:"NodeJs"},{key:"python3",label:"Python3"},{key:"linux",label:"Linux"}]}),(0,K.jsxs)("div",{ref:ye,children:[J.length>0&&(0,K.jsxs)("div",{style:{marginBottom:16},children:[(0,K.jsx)(g.Z,{type:"primary",style:{marginBottom:5,marginLeft:8},onClick:function(){m.Z.confirm({title:u.ZP.get("确认重新安装"),content:(0,K.jsx)(K.Fragment,{children:u.ZP.get("确认重新安装选中的依赖吗")}),onOk:function(){N.W.put("".concat(E.Z.apiPrefix,"dependencies/reinstall"),J).then((function(e){var t=e.code;e.data,200===t&&(te([]),Ze())}))},onCancel:function(){console.log("Cancel")}})},children:u.ZP.get("批量安装")}),(0,K.jsx)(g.Z,{type:"primary",style:{marginBottom:5,marginLeft:8},onClick:function(){return je(!1)},children:u.ZP.get("批量删除")}),(0,K.jsx)(g.Z,{type:"primary",style:{marginBottom:5,marginLeft:8},onClick:function(){return je(!0)},children:u.ZP.get("批量强制删除")}),(0,K.jsxs)("span",{style:{marginLeft:8},children:[u.ZP.get("已选择"),(0,K.jsx)("a",{children:null==J?void 0:J.length}),u.ZP.get("项")]})]}),(0,K.jsx)(_.W,{backend:F.PD,children:(0,K.jsx)(x.Z,{columns:i,rowSelection:$e,pagination:!1,dataSource:d,rowKey:"id",size:"middle",scroll:{x:768,y:xe},loading:k})})]}),(0,K.jsx)(Y.default,{visible:S,handleCancel:function(e){P(!1),e&&we(e)},dependence:O,defaultType:me}),oe&&(0,K.jsx)(R.default,{visible:fe,handleCancel:function(e){if(he(!1),e){var t=d.findIndex((function(e){return e.id===oe.id})),n=r()(d);-1!==t&&(n.splice(t,1),f(n))}else r()(d).map((function(e){return e.id})).includes(oe.id)&&function(e){N.W.get("".concat(E.Z.apiPrefix,"dependencies/").concat(e.id)).then((function(t){var n=t.code,i=t.data;if(200===n){var s=d.findIndex((function(t){return t.id===e.id})),a=r()(d);-1!==s&&(a.splice(s,1,o()(o()({},e),i)),f(a))}})).finally((function(){return w(!1)}))}(oe)},dependence:oe})]})}},71467:function(e,t,n){"use strict";n.r(t);var i=n(54306),r=n.n(i),s=n(88265),a=n(63313),c=n(84163),o=n(24378),u=n(57229),l=n(15207),d=n(65601),f=n(38101),h=n(4574),v=n(99120),p=n.n(v),m=n(21758),g=n(11527);t.default=function(e){var t=e.dependence,n=e.handleCancel,i=e.visible,v=(0,a.useState)(""),y=r()(v,2),x=y[0],Z=y[1],b=(0,a.useState)(!0),k=r()(b,2),w=k[0],$=k[1],j=(0,a.useState)(!1),S=r()(j,2),P=S[0],M=S[1],C=(0,a.useState)(!0),D=r()(C,2),O=D[0],H=D[1],I=(0,a.useState)(!1),z=r()(I,2),A=z[0],T=z[1],L=(0,a.useState)(!1),E=r()(L,2),W=E[0],N=E[1],Y=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];localStorage.removeItem("logDependence"),n(e)};(0,a.useEffect)((function(){t&&(H(!0),u.W.get("".concat(l.Z.apiPrefix,"dependencies/").concat(t.id)).then((function(e){var n=e.code,i=e.data;if(200===n&&localStorage.getItem("logDependence")===String(t.id)){var r=((null==i?void 0:i.log)||[]).join("");Z(r),$(!r.includes("结束时间")),T(r.includes("删除失败"))}})).finally((function(){H(!1)})))}),[t]);var _=function(e){var n=e.message,i=e.references;i.length>0&&i.includes(t.id)&&(n.includes("结束时间")&&($(!1),T(n.includes("删除失败"))),Z((function(e){return"".concat(e).concat(n)})))};return(0,a.useEffect)((function(){var e=m.Z.getInstance();return e.subscribe("installDependence",_),function(){e.unsubscribe("installDependence",_)}}),[]),(0,a.useEffect)((function(){M(document.body.clientWidth<768)}),[]),(0,g.jsx)(c.Z,{title:(0,g.jsxs)(g.Fragment,{children:[w&&(0,g.jsx)(d.Z,{spin:!0}),!w&&(0,g.jsx)(f.Z,{}),(0,g.jsxs)("span",{style:{marginLeft:5},children:[s.ZP.get("日志 -")," ",t&&t.name]})," "]}),open:i,centered:!0,className:"log-modal",forceRender:!0,onOk:function(){return Y()},onCancel:function(){return Y()},footer:[(0,g.jsx)(o.Z,{type:"primary",onClick:function(){A?(N(!0),u.W.delete("".concat(l.Z.apiPrefix,"dependencies/force"),{data:[t.id]}).then((function(e){var t=e.code;e.data,200===t&&Y(!0)})).finally((function(){N(!1)}))):Y()},loading:W,children:A?s.ZP.get("强制删除"):s.ZP.get("知道了")})],children:(0,g.jsx)("div",{className:"log-container",children:O?(0,g.jsx)(h.Z,{}):(0,g.jsx)("pre",{style:P?{fontFamily:"Source Code Pro",zoom:.83}:{},children:(0,g.jsx)(p(),{children:x})})})})}},53261:function(e,t,n){"use strict";n.r(t);var i=n(25359),r=n.n(i),s=n(57213),a=n.n(s),c=n(49811),o=n.n(c),u=n(54306),l=n.n(u),d=n(88265),f=n(63313),h=n(28756),v=n(67393),p=n(84163),m=n(84468),g=n(22159),y=n(57229),x=n(15207),Z=n(11527),b=h.Z.Option,k=function(e){return e[e.nodejs=0]="nodejs",e[e.python3=1]="python3",e[e.linux=2]="linux",e}(k||{});t.default=function(e){var t=e.dependence,n=e.handleCancel,i=e.visible,s=e.defaultType,c=v.Z.useForm(),u=l()(c,1)[0],w=(0,f.useState)(!1),$=l()(w,2),j=$[0],S=$[1],P=function(){var e=o()(r()().mark((function e(i){var s,c,o,u,l,d,f,h,v,p;return r()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(!0),s=i.name,c=i.split,o=i.type,u=i.remark,l=t?"put":"post",t?d=a()(a()({},i),{},{id:t.id}):"1"===c?(f=s.includes("&")?"&":"\n",d=s.split(f).map((function(e){return{name:e,type:o,remark:u}}))):d=[{name:s,type:o,remark:u}],e.prev=4,e.next=7,y.W[l]("".concat(x.Z.apiPrefix,"dependencies"),d);case 7:h=e.sent,v=h.code,p=h.data,200===v&&n(p),S(!1),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),S(!1);case 17:case"end":return e.stop()}}),e,null,[[4,14]])})));return function(t){return e.apply(this,arguments)}}();return(0,f.useEffect)((function(){u.resetFields()}),[t,i]),(0,Z.jsx)(p.Z,{title:t?d.ZP.get("编辑依赖"):d.ZP.get("创建依赖"),open:i,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){u.validateFields().then((function(e){P(e)})).catch((function(e){console.log("Validate Failed:",e)}))},onCancel:function(){return n()},confirmLoading:j,children:(0,Z.jsxs)(v.Z,{form:u,layout:"vertical",name:"dependence_modal",initialValues:t,children:[(0,Z.jsx)(v.Z.Item,{name:"type",label:d.ZP.get("依赖类型"),initialValue:k[s],children:(0,Z.jsx)(h.Z,{children:x.Z.dependenceTypes.map((function(e,t){return(0,Z.jsx)(b,{value:t,children:e},t)}))})}),!t&&(0,Z.jsx)(v.Z.Item,{name:"split",label:d.ZP.get("自动拆分"),initialValue:"0",tooltip:d.ZP.get("多个依赖是否换行分割"),children:(0,Z.jsxs)(m.ZP.Group,{children:[(0,Z.jsx)(m.ZP,{value:"1",children:d.ZP.get("是")}),(0,Z.jsx)(m.ZP,{value:"0",children:d.ZP.get("否")})]})}),(0,Z.jsx)(v.Z.Item,{name:"name",label:d.ZP.get("名称"),rules:[{required:!0,message:d.ZP.get("请输入依赖名称，支持指定版本"),whitespace:!0}],children:(0,Z.jsx)(g.Z.TextArea,{rows:4,autoSize:{minRows:1,maxRows:5},placeholder:d.ZP.get("请输入依赖名称")})}),(0,Z.jsx)(v.Z.Item,{name:"remark",label:d.ZP.get("备注"),children:(0,Z.jsx)(g.Z,{placeholder:d.ZP.get("请输入备注")})})]})})}},21758:function(e,t,n){"use strict";var i=n(93525),r=n.n(i),s=n(12342),a=n.n(s),c=n(25359),o=n.n(c),u=n(49811),l=n.n(u),d=n(21140),f=n.n(d),h=n(63466),v=n.n(h),p=n(52510),m=n.n(p),g=n(78078),y=n.n(g),x=["type"],Z=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};f()(this,e),m()(this,"url",void 0),m()(this,"socket",null),m()(this,"subscriptions",new Map),m()(this,"options",void 0),m()(this,"reconnectAttempts",0),m()(this,"heartbeatTimeout",null),m()(this,"state","closed"),this.url=t,this.options={maxReconnectAttempts:n.maxReconnectAttempts||5,reconnectInterval:n.reconnectInterval||3e3,heartbeatInterval:n.heartbeatInterval||3e4},this.init()}var t,n;return v()(e,[{key:"init",value:(n=l()(o()().mark((function e(){var t=this;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.state="connecting",this.emit("connecting");case 3:if(!(this.reconnectAttempts<this.options.maxReconnectAttempts)){e.next=16;break}return this.socket=new(y())(this.url),this.setupEventListeners(),this.startHeartbeat(),e.next=9,this.waitForClose();case 9:return this.stopHeartbeat(),this.socket=null,this.reconnectAttempts++,e.next=14,new Promise((function(e){return setTimeout(e,t.options.reconnectInterval)}));case 14:e.next=3;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),this.handleError(e.t0);case 21:case"end":return e.stop()}}),e,this,[[0,18]])}))),function(){return n.apply(this,arguments)})},{key:"setupEventListeners",value:function(){var e=this;this.socket&&(this.socket.onopen=function(){e.state="open",e.emit("open")},this.socket.onmessage=function(t){var n=JSON.parse(t.data);e.dispatchMessage(n)},this.socket.onclose=function(){e.state="closed",e.emit("close")})}},{key:"waitForClose",value:(t=l()(o()().mark((function e(){var t;return o()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(t=this.socket)||void 0===t?void 0:t.readyState)===y().CLOSED){e.next=5;break}return e.next=3,new Promise((function(e){return setTimeout(e,100)}));case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"subscribe",value:function(e,t){var n=this.subscriptions.get(e)||new Set;if(!n.has(t)){n.add(t),this.subscriptions.set(e,n);var i={action:"subscribe",topic:e};this.send(i)}}},{key:"unsubscribe",value:function(e,t){var n=this.subscriptions.get(e)||new Set;if(n.has(t)){n.delete(t);var i={action:"unsubscribe",topic:e};this.send(i)}}},{key:"send",value:function(e){var t;(null===(t=this.socket)||void 0===t?void 0:t.readyState)===y().OPEN&&this.socket.send(JSON.stringify(e))}},{key:"dispatchMessage",value:function(e){var t=e.type,n=a()(e,x),i=this.subscriptions.get(t)||new Set;r()(i).forEach((function(e){return e(n)}))}},{key:"startHeartbeat",value:function(){var e=this;this.heartbeatTimeout=setInterval((function(){var t;(null===(t=e.socket)||void 0===t?void 0:t.readyState)===y().OPEN&&e.socket.send(JSON.stringify({type:"heartbeat"}))}),this.options.heartbeatInterval)}},{key:"stopHeartbeat",value:function(){this.heartbeatTimeout&&clearInterval(this.heartbeatTimeout)}},{key:"close",value:function(){this.socket&&(this.state="closed",this.stopHeartbeat(),this.socket.close(),this.emit("close"))}},{key:"handleError",value:function(e){console.error("WebSocket错误:",e),this.emit("error",e)}},{key:"on",value:function(e,t){}},{key:"emit",value:function(e,t){}}],[{key:"getInstance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;return e.instance||(e.instance=new e(t,n)),e.instance}}]),e}();m()(Z,"instance",null),t.Z=Z},52053:function(e){e.exports=function(){"use strict";var e=1e3,t=6e4,n=36e5,i="millisecond",r="second",s="minute",a="hour",c="day",o="week",u="month",l="quarter",d="year",f="date",h="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,p=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},g=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},y={s:g,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),i=Math.floor(n/60),r=n%60;return(t<=0?"+":"-")+g(i,2,"0")+":"+g(r,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var i=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(i,u),s=n-r<0,a=t.clone().add(i+(s?-1:1),u);return+(-(i+(n-r)/(s?r-a:a-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:u,y:d,w:o,d:c,D:f,h:a,m:s,s:r,ms:i,Q:l}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},x="en",Z={};Z[x]=m;var b=function(e){return e instanceof j},k=function e(t,n,i){var r;if(!t)return x;if("string"==typeof t){var s=t.toLowerCase();Z[s]&&(r=s),n&&(Z[s]=n,r=s);var a=t.split("-");if(!r&&a.length>1)return e(a[0])}else{var c=t.name;Z[c]=t,r=c}return!i&&r&&(x=r),r||!i&&x},w=function(e,t){if(b(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new j(n)},$=y;$.l=k,$.i=b,$.w=function(e,t){return w(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var j=function(){function m(e){this.$L=k(e.locale,null,!0),this.parse(e)}var g=m.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if($.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(v);if(i){var r=i[2]-1||0,s=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)):new Date(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,s)}}return new Date(t)}(e),this.$x=e.x||{},this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return $},g.isValid=function(){return!(this.$d.toString()===h)},g.isSame=function(e,t){var n=w(e);return this.startOf(t)<=n&&n<=this.endOf(t)},g.isAfter=function(e,t){return w(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<w(e)},g.$g=function(e,t,n){return $.u(e)?this[t]:this.set(n,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,t){var n=this,i=!!$.u(t)||t,l=$.p(e),h=function(e,t){var r=$.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return i?r:r.endOf(c)},v=function(e,t){return $.w(n.toDate()[e].apply(n.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},p=this.$W,m=this.$M,g=this.$D,y="set"+(this.$u?"UTC":"");switch(l){case d:return i?h(1,0):h(31,11);case u:return i?h(1,m):h(0,m+1);case o:var x=this.$locale().weekStart||0,Z=(p<x?p+7:p)-x;return h(i?g-Z:g+(6-Z),m);case c:case f:return v(y+"Hours",0);case a:return v(y+"Minutes",1);case s:return v(y+"Seconds",2);case r:return v(y+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(e,t){var n,o=$.p(e),l="set"+(this.$u?"UTC":""),h=(n={},n[c]=l+"Date",n[f]=l+"Date",n[u]=l+"Month",n[d]=l+"FullYear",n[a]=l+"Hours",n[s]=l+"Minutes",n[r]=l+"Seconds",n[i]=l+"Milliseconds",n)[o],v=o===c?this.$D+(t-this.$W):t;if(o===u||o===d){var p=this.clone().set(f,1);p.$d[h](v),p.init(),this.$d=p.set(f,Math.min(this.$D,p.daysInMonth())).$d}else h&&this.$d[h](v);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[$.p(e)]()},g.add=function(i,l){var f,h=this;i=Number(i);var v=$.p(l),p=function(e){var t=w(h);return $.w(t.date(t.date()+Math.round(e*i)),h)};if(v===u)return this.set(u,this.$M+i);if(v===d)return this.set(d,this.$y+i);if(v===c)return p(1);if(v===o)return p(7);var m=(f={},f[s]=t,f[a]=n,f[r]=e,f)[v]||1,g=this.$d.getTime()+i*m;return $.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var i=e||"YYYY-MM-DDTHH:mm:ssZ",r=$.z(this),s=this.$H,a=this.$m,c=this.$M,o=n.weekdays,u=n.months,l=function(e,n,r,s){return e&&(e[n]||e(t,i))||r[n].slice(0,s)},d=function(e){return $.s(s%12||12,e,"0")},f=n.meridiem||function(e,t,n){var i=e<12?"AM":"PM";return n?i.toLowerCase():i},v={YY:String(this.$y).slice(-2),YYYY:$.s(this.$y,4,"0"),M:c+1,MM:$.s(c+1,2,"0"),MMM:l(n.monthsShort,c,u,3),MMMM:l(u,c),D:this.$D,DD:$.s(this.$D,2,"0"),d:String(this.$W),dd:l(n.weekdaysMin,this.$W,o,2),ddd:l(n.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(s),HH:$.s(s,2,"0"),h:d(1),hh:d(2),a:f(s,a,!0),A:f(s,a,!1),m:String(a),mm:$.s(a,2,"0"),s:String(this.$s),ss:$.s(this.$s,2,"0"),SSS:$.s(this.$ms,3,"0"),Z:r};return i.replace(p,(function(e,t){return t||v[e]||r.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(i,f,h){var v,p=$.p(f),m=w(i),g=(m.utcOffset()-this.utcOffset())*t,y=this-m,x=$.m(this,m);return x=(v={},v[d]=x/12,v[u]=x,v[l]=x/3,v[o]=(y-g)/6048e5,v[c]=(y-g)/864e5,v[a]=y/n,v[s]=y/t,v[r]=y/e,v)[p]||y,h?x:$.a(x)},g.daysInMonth=function(){return this.endOf(u).$D},g.$locale=function(){return Z[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),i=k(e,t,!0);return i&&(n.$L=i),n},g.clone=function(){return $.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},m}(),S=j.prototype;return w.prototype=S,[["$ms",i],["$s",r],["$m",s],["$H",a],["$W",c],["$M",u],["$y",d],["$D",f]].forEach((function(e){S[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),w.extend=function(e,t){return e.$i||(e(t,j,w),e.$i=!0),w},w.locale=k,w.isDayjs=b,w.unix=function(e){return w(1e3*e)},w.en=Z[x],w.Ls=Z,w.p={},w}()}}]);
(self.webpackChunk_whyour_qinglong=self.webpackChunk_whyour_qinglong||[]).push([[9818],{88939:function(e,t,n){"use strict";var i=n(2053),r=n(75271),o=n(19579),a=n(48881),c=function(e,t){return r.createElement(a.Z,(0,i.Z)({},e,{ref:t,icon:o.Z}))},l=r.forwardRef(c);t.Z=l},82802:function(e,t,n){"use strict";var i=n(26068),r=n.n(i),o=n(75271);t.Z=function(e,t,n){var i=n.treeNodeFilterProp;return(0,o.useMemo)((function(){var n=[];if(!t)return{treeData:e,keys:n};var o=t.toUpperCase();function a(e,t){var n=t[i];return String(n).toUpperCase().includes(o)}return{treeData:function e(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t.map((function(t){var o=t.children,c=i||a(0,t),l=e(o||[],c);return c||l.length?(l.length&&n.push(t.key),r()(r()({},t),{},{children:l})):null})).filter((function(e){return e}))}(e),keys:n}}),[e,t,i])}},85565:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var i=n(15558),r=n.n(i),o=n(48305),a=n.n(o),c=n(72317),l=n(75271),s=n(50691),u=n(45520),f=n(61508),g=n(88142),h=n(59816),d=n(93481),p=n(17082),m=n(13107),x=n(98705),y=n(3475),v=n(47508),Z=n(83383),b=n(16314),P={"left-tree-container":"left-tree-container___zHanw","left-tree-scroller":"left-tree-scroller___PInUN","log-container":"log-container___ba9Tr"},k=n(71742),w=n(43382),S=n(98783),j=n(88939),B=n(52076),C=n(66292),E=n.n(C),N=n(4363),_=n.n(N),M=n(82802),F=n(79514),D=n(52676),I=s.Z.Text,T=function(){var e=(0,S.useOutletContext)(),t=e.headerStyle,n=e.isPhone,i=e.theme,o=(0,l.useState)(c.ZP.get("请选择日志文件")),s=a()(o,2),C=s[0],N=s[1],T=(0,l.useState)(c.ZP.get("请选择日志文件")),z=a()(T,2),L=z[0],A=z[1],G=(0,l.useState)([]),O=a()(G,2),Y=O[0],$=O[1],q=(0,l.useState)(!1),H=a()(q,2),K=H[0],R=H[1],U=(0,l.useState)(),W=a()(U,2),J=W[0],Q=W[1],V=(0,l.useRef)(),X=(0,l.useState)([]),ee=a()(X,2),te=ee[0],ne=ee[1],ie=(0,l.useState)(),re=a()(ie,2),oe=re[0],ae=re[1],ce=(0,l.useState)(""),le=a()(ce,2),se=le[0],ue=le[1],fe=function(e,t){t.key!==L&&e&&(ae(t),A(e),"directory"!==t.type?(N(c.ZP.get("加载中...")),function(e){b.W.get("".concat(y.Z.apiPrefix,"logs/detail?file=").concat(e.title,"&path=").concat(e.parent||"")).then((function(e){var t=e.code,n=e.data;200===t&&N(n)}))}(t)):N(c.ZP.get("请选择日志文件")))},ge=(0,l.useCallback)((function(e,t){fe(e[0],t.node)}),[]),he=(0,l.useCallback)((function(e){var t=e.target.value;de(t)}),[Y]),de=(0,l.useCallback)(E()((function(e){ue(e)}),300),[Y]),pe=(0,M.Z)(Y,se,{treeNodeFilterProp:"title"}),me=pe.treeData,xe=pe.keys;(0,l.useEffect)((function(){ne(_()([].concat(r()(te),r()(xe))))}),[xe]);var ye=function(){A(""),ae(null),N(c.ZP.get("请选择脚本文件"))};return(0,l.useEffect)((function(){R(!0),b.W.get("".concat(y.Z.apiPrefix,"logs")).then((function(e){var t=e.code,n=e.data;200===t&&$(n)})).finally((function(){return R(!1)}))}),[]),(0,l.useEffect)((function(){V.current&&Q(V.current.clientHeight)}),[V.current,Y]),(0,D.jsx)(v.ZP,{className:"ql-container-wrapper log-wrapper",title:(0,D.jsxs)(D.Fragment,{children:[L,"file"===(null==oe?void 0:oe.type)&&(0,D.jsx)("span",{style:{marginLeft:6,fontSize:12,color:"#999",display:"inline-block",height:14},children:(0,F.Z)(oe.size)})]}),loading:K,extra:n?[(0,D.jsx)(g.Z,{treeExpandAction:"click",className:"log-select",value:L,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:Y,placeholder:c.ZP.get("请选择日志"),fieldNames:{value:"key"},treeNodeFilterProp:"title",showSearch:!0,allowClear:!0,onSelect:fe})]:[(0,D.jsx)(h.Z,{title:c.ZP.get("删除"),children:(0,D.jsx)(d.Z,{type:"primary",disabled:!L,onClick:function(){u.Z.confirm({title:"确认删除",content:(0,D.jsxs)(D.Fragment,{children:[c.ZP.get("确认删除"),(0,D.jsxs)(I,{style:{wordBreak:"break-all"},type:"warning",children:[" ",L," "]}),c.ZP.get("文件"),"directory"===oe.type?c.ZP.get("夹下所有日志"):"",c.ZP.get("，删除后不可恢复")]}),onOk:function(){b.W.delete("".concat(y.Z.apiPrefix,"logs"),{data:{filename:oe.title,path:oe.parent||"",type:oe.type}}).then((function(e){if(200===e.code){f.ZP.success("删除成功");var t=r()(Y);if(oe.parent)t=(0,B.I1)(t,(function(e){return e.key===oe.key}));else{var n=t.findIndex((function(e){return e.key===oe.key}));-1!==n&&t.splice(n,1)}$(t),ye()}}))},onCancel:function(){console.log("Cancel")}})},icon:(0,D.jsx)(j.Z,{})})})],header:{style:t},children:(0,D.jsxs)("div",{className:"".concat(P["log-container"]," log-container"),children:[!n&&(0,D.jsxs)(w.Z,{split:"vertical",size:200,maxSize:-100,children:[(0,D.jsx)("div",{className:P["left-tree-container"],children:Y.length>0?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(p.Z.Search,{className:P["left-tree-search"],onChange:he,placeholder:c.ZP.get("请输入日志名"),allowClear:!0}),(0,D.jsx)("div",{className:P["left-tree-scroller"],ref:V,children:(0,D.jsx)(m.Z,{expandAction:"click",className:P["left-tree"],treeData:me,showIcon:!0,height:J,selectedKeys:[L],showLine:{showLeafIcon:!0},onSelect:ge,expandedKeys:te,onExpand:function(e){ne(e)}})})]}):(0,D.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,D.jsx)(x.Z,{description:c.ZP.get("暂无日志"),image:x.Z.PRESENTED_IMAGE_SIMPLE})})}),(0,D.jsx)(Z.ZP,{language:"shell",theme:i,value:C,options:{readOnly:!0,fontSize:12,minimap:{enabled:!1},lineNumbersMinChars:3,folding:!1,glyphMargin:!1}})]}),n&&(0,D.jsx)(k.ZP,{value:C,readOnly:!0,theme:i.includes("dark")?"dark":"light",onChange:function(e,t){N(e)}})]})})}},45170:function(e,t,n){var i=n(13807);e.exports=function(e,t){return!!(null==e?0:e.length)&&i(e,t,0)>-1}},94936:function(e){e.exports=function(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1}},92504:function(e){e.exports=function(e,t,n,i){for(var r=e.length,o=n+(i?1:-1);i?o--:++o<r;)if(t(e[o],o,e))return o;return-1}},13807:function(e,t,n){var i=n(92504),r=n(99940),o=n(3729);e.exports=function(e,t,n){return t==t?o(e,t,n):i(e,r,n)}},99940:function(e){e.exports=function(e){return e!=e}},95453:function(e,t,n){var i=n(78188),r=n(45170),o=n(94936),a=n(29880),c=n(17319),l=n(79967);e.exports=function(e,t,n){var s=-1,u=r,f=e.length,g=!0,h=[],d=h;if(n)g=!1,u=o;else if(f>=200){var p=t?null:c(e);if(p)return l(p);g=!1,u=a,d=new i}else d=t?[]:h;e:for(;++s<f;){var m=e[s],x=t?t(m):m;if(m=n||0!==m?m:0,g&&x==x){for(var y=d.length;y--;)if(d[y]===x)continue e;t&&d.push(x),h.push(m)}else u(d,x,n)||(d!==h&&d.push(x),h.push(m))}return h}},17319:function(e,t,n){var i=n(81956),r=n(43226),o=n(79967),a=i&&1/o(new i([,-0]))[1]==1/0?function(e){return new i(e)}:r;e.exports=a},3729:function(e){e.exports=function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}},43226:function(e){e.exports=function(){}},4363:function(e,t,n){var i=n(95453);e.exports=function(e){return e&&e.length?i(e):[]}},79514:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});const i=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],r=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],o=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],a=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],c=(e,t,n)=>{let i=e;return"string"==typeof t||Array.isArray(t)?i=e.toLocaleString(t,n):!0!==t&&void 0===n||(i=e.toLocaleString(void 0,n)),i};function l(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const n=(t={bits:!1,binary:!1,space:!0,...t}).bits?t.binary?a:o:t.binary?r:i,l=t.space?" ":"";if(t.signed&&0===e)return` 0${l}${n[0]}`;const s=e<0,u=s?"-":t.signed?"+":"";let f;if(s&&(e=-e),void 0!==t.minimumFractionDigits&&(f={minimumFractionDigits:t.minimumFractionDigits}),void 0!==t.maximumFractionDigits&&(f={maximumFractionDigits:t.maximumFractionDigits,...f}),e<1){return u+c(e,t.locale,f)+l+n[0]}const g=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),n.length-1);e/=(t.binary?1024:1e3)**g,f||(e=e.toPrecision(3));return u+c(Number(e),t.locale,f)+l+n[g]}}}]);
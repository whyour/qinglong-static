"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5586],{30675:function(e,t,n){n.r(t);var a=n(57213),i=n.n(a),o=n(54306),r=n.n(o),c=n(88265),l=n(63313),s=n(28756),u=n(60858),d=n(75310),p=n(24378),f=n(95176),m=n(5558),h=n(36035),g=n(82755),v=n(10726),x=n(77385),Z=n(62753),y=n(82428),b=n(11527),C=s.Z.Option;t.default=function(e){var t=e.treeData,n=e.currentNode,a=e.content,o=e.handleCancel,S=e.visible,j=e.socketMessage,P=(0,l.useState)(""),w=r()(P,2),k=w[0],I=w[1],O=(0,l.useState)("javascript"),E=r()(O,2),F=E[0],_=E[1],N=(0,l.useState)(),M=r()(N,2),R=M[0],H=M[1],L=(0,l.useState)(""),W=r()(L,2),z=W[0],A=W[1],T=(0,l.useState)(!1),D=r()(T,2),q=D[0],V=D[1],B=(0,l.useState)(!1),X=r()(B,2),$=X[0],U=X[1],G=(0,l.useState)(""),J=r()(G,2),K=J[0],Q=J[1],Y=(0,Z.F)().theme,ee=(0,l.useRef)(null),te=(0,l.useState)(!1),ne=r()(te,2),ae=ne[0],ie=ne[1],oe=(0,l.useState)(null),re=r()(oe,2),ce=re[0],le=re[1],se=function(e){f.W.get("".concat(m.Z.apiPrefix,"scripts/").concat(e.title,"?path=").concat(e.parent||"")).then((function(e){var t=e.code,n=e.data;200===t&&I(n)}))},ue=function(){R&&R.title&&ce&&f.W.put("".concat(m.Z.apiPrefix,"scripts/stop"),{filename:R.title,path:R.parent||"",pid:ce}).then((function(e){var t=e.code;e.data;200===t&&ie(!1)}))};return(0,l.useEffect)((function(){if(j){var e=j.type,t=j.message;j.references;"manuallyRunScript"===e&&((0,y.x$)(t)&&setTimeout((function(){ie(!1)}),300),K&&(t="\n".concat(t)),Q("".concat(K).concat(t)))}}),[j]),(0,l.useEffect)((function(){if(Q(""),n){H(n),I(a),A(n.key);var e=(0,y.H$)(n.title);_(e)}}),[a,n]),(0,b.jsxs)(u.Z,{className:"edit-modal",closable:!1,title:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.Z,{treeExpandAction:"click",style:{marginRight:8,width:150},value:z,dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:t,placeholder:c.ZP.get("请选择脚本文件"),fieldNames:{value:"key",label:"title"},showSearch:!0,onSelect:function(e,t){if(t.key!==z&&e&&"directory"!==t.type){var n=(0,y.H$)(e);H(t),_(n),se(t),A(t.key)}}}),(0,b.jsxs)(s.Z,{value:F,style:{width:110,marginRight:8},onChange:function(e){_(e)},children:[(0,b.jsx)(C,{value:"javascript",children:"javascript"}),(0,b.jsx)(C,{value:"typescript",children:"typescript"}),(0,b.jsx)(C,{value:"shell",children:"shell"}),(0,b.jsx)(C,{value:"python",children:"python"})]}),(0,b.jsx)(p.Z,{type:"primary",style:{marginRight:8},onClick:ae?ue:function(){Q("");var e=ee.current.getValue().replace(/\r\n/g,"\n");f.W.put("".concat(m.Z.apiPrefix,"scripts/run"),{filename:R.title,path:R.parent||"",content:e}).then((function(e){var t=e.code,n=e.data;200===t&&(ie(!0),le(n))}))},children:ae?c.ZP.get("停止"):c.ZP.get("运行")}),(0,b.jsx)(p.Z,{type:"primary",style:{marginRight:8},onClick:function(){Q("")},children:c.ZP.get("清空日志")}),(0,b.jsx)(p.Z,{type:"primary",style:{marginRight:8},onClick:function(){V(!0)},children:c.ZP.get("保存")}),(0,b.jsx)(p.Z,{type:"primary",style:{marginRight:8},onClick:function(){ue(),o()},children:c.ZP.get("退出")})]}),width:"100%",headerStyle:{padding:"11px 24px"},onClose:function(){o()},open:S,children:[(0,b.jsxs)(h.Z,{split:"vertical",minSize:200,defaultSize:"50%",style:{height:"calc(100vh - 55px)"},children:[(0,b.jsx)(g.ZP,{language:F,value:k,theme:Y,options:{fontSize:12,minimap:{enabled:!1},lineNumbersMinChars:3,glyphMargin:!1},onMount:function(e){ee.current=e}}),(0,b.jsx)("pre",{style:{height:"100%",padding:"0 15px"},children:K})]}),(0,b.jsx)(v.default,{visible:q,handleCancel:function(){V(!1)},file:i()({content:ee.current&&ee.current.getValue().replace(/\r\n/g,"\n")},R)}),(0,b.jsx)(x.default,{visible:$,handleCancel:function(){U(!1)}})]})}},10726:function(e,t,n){n.r(t);var a=n(25359),i=n.n(a),o=n(57213),r=n.n(o),c=n(49811),l=n.n(c),s=n(54306),u=n.n(s),d=n(88265),p=n(63313),f=n(67393),m=n(9835),h=n(84163),g=n(22159),v=n(95176),x=n(5558),Z=n(11527);t.default=function(e){var t=e.file,n=e.handleCancel,a=e.visible,o=f.Z.useForm(),c=u()(o,1)[0],s=(0,p.useState)(!1),y=u()(s,2),b=y[0],C=y[1],S=function(){var e=l()(i()().mark((function e(a){var o;return i()().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C(!0),o=r()(r()(r()({},t),a),{},{originFilename:t.title}),v.W.post("".concat(x.Z.apiPrefix,"scripts"),o).then((function(e){var t=e.code,a=e.data;200===t&&(m.ZP.success(d.ZP.get("保存文件成功")),n(a)),C(!1)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,p.useEffect)((function(){c.resetFields(),C(!1)}),[t,a]),(0,Z.jsx)(h.Z,{title:d.ZP.get("保存文件"),open:a,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){c.validateFields().then((function(e){S(e)})).catch((function(e){console.log("Validate Failed:",e)}))},onCancel:function(){return n()},confirmLoading:b,children:(0,Z.jsxs)(f.Z,{form:c,layout:"vertical",name:"script_modal",initialValues:{filename:null==t?void 0:t.title,path:(null==t?void 0:t.parent)||""},children:[(0,Z.jsx)(f.Z.Item,{name:"filename",label:d.ZP.get("文件名"),rules:[{required:!0,message:d.ZP.get("请输入文件名")}],children:(0,Z.jsx)(g.Z,{placeholder:d.ZP.get("请输入文件名")})}),(0,Z.jsx)(f.Z.Item,{name:"path",label:d.ZP.get("保存目录"),children:(0,Z.jsx)(g.Z,{placeholder:d.ZP.get("请输入保存目录，默认scripts目录")})})]})})}},77385:function(e,t,n){n.r(t);n(25359),n(57213),n(49811);var a=n(54306),i=n.n(a),o=n(88265),r=n(63313),c=n(67393),l=(n(9835),n(84163)),s=n(22159),u=(n(95176),n(5558),n(11527));t.default=function(e){var t=e.file,n=e.handleCancel,a=e.visible,d=c.Z.useForm(),p=i()(d,1)[0],f=(0,r.useState)(!1),m=i()(f,2),h=(m[0],m[1]);return(0,r.useEffect)((function(){p.resetFields(),h(!1)}),[t,a]),(0,u.jsx)(l.Z,{title:o.ZP.get("运行设置"),open:a,forceRender:!0,centered:!0,onCancel:function(){return n()},children:(0,u.jsx)(c.Z,{form:p,layout:"vertical",name:"setting_modal",initialValues:t,children:(0,u.jsx)(c.Z.Item,{name:"filename",label:o.ZP.get("待开发"),rules:[{required:!0,message:o.ZP.get("待开发")}],children:(0,u.jsx)(s.Z,{placeholder:o.ZP.get("待开发")})})})})}},62753:function(e,t,n){n.d(t,{F:function(){return l},e:function(){return c}});var a=n(54306),i=n.n(a),o=n(63313),r=n(82428),c=function(){var e=(0,o.useState)("100%"),t=i()(e,2),n=t[0],a=t[1],c=(0,o.useState)(0),l=i()(c,2),s=l[0],u=l[1],d=(0,o.useState)(-48),p=i()(d,2),f=p[0],m=p[1],h=(0,o.useState)(!1),g=i()(h,2),v=g[0],x=g[1],Z=(0,o.useMemo)((function(){return(0,r.ZP)()}),[]).platform;return(0,o.useEffect)((function(){"mobile"===Z&&document.body.offsetWidth<768?(a("auto"),u(0),m(0),x(!0),document.body.setAttribute("data-mode","phone")):(a("100%"),u(0),m(-48),x(!1),document.body.setAttribute("data-mode","desktop"))}),[]),{headerStyle:{padding:"4px 16px 4px 15px",position:"sticky",top:0,left:0,zIndex:20,marginTop:f,width:n,marginLeft:s},isPhone:v}},l=function(){var e=(0,o.useState)(),t=i()(e,2),n=t[0],a=t[1];return(0,o.useEffect)((function(){var e=window.matchMedia("(prefers-color-scheme: dark)"),t=localStorage.getItem("qinglong_dark_theme"),n=e.matches&&"light"!==t||"dark"===t;a(n?"vs-dark":"vs");var i=function(e){"auto"!==t&&t||(e.matches?a("vs-dark"):a("vs"))};"function"==typeof e.addEventListener?e.addEventListener("change",i):"function"==typeof e.addListener&&e.addListener(i)}),[]),{theme:n,reloadTheme:function(){var e=window.matchMedia("(prefers-color-scheme: dark)"),t=localStorage.getItem("qinglong_dark_theme"),n=e.matches&&"light"!==t||"dark"===t;a(n?"vs-dark":"vs")}}}},28756:function(e,t,n){var a=n(87807),i=n(60795),o=n(84875),r=n.n(o),c=n(40804),l=n(92976),s=n(63313),u=n(82259),d=n(23474),p=n(7893),f=n(65189),m=n(76737),h=n(16082),g=n(1020),v=n(91967),x=n(60934),Z=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n},y="SECRET_COMBOBOX_MODE_DO_NOT_USE",b=function(e,t){var n,o,b=e.prefixCls,C=e.bordered,S=void 0===C||C,j=e.className,P=e.getPopupContainer,w=e.dropdownClassName,k=e.popupClassName,I=e.listHeight,O=void 0===I?256:I,E=e.placement,F=e.listItemHeight,_=void 0===F?24:F,N=e.size,M=e.disabled,R=e.notFoundContent,H=e.status,L=e.showArrow,W=Z(e,["prefixCls","bordered","className","getPopupContainer","dropdownClassName","popupClassName","listHeight","placement","listItemHeight","size","disabled","notFoundContent","status","showArrow"]),z=s.useContext(u.E_),A=z.getPopupContainer,T=z.getPrefixCls,D=z.renderEmpty,q=z.direction,V=z.virtual,B=z.dropdownMatchSelectWidth,X=s.useContext(f.Z),$=T("select",b),U=T(),G=(0,x.ri)($,q),J=G.compactSize,K=G.compactItemClassnames,Q=s.useMemo((function(){var e=W.mode;if("combobox"!==e)return e===y?"combobox":e}),[W.mode]),Y="multiple"===Q||"tags"===Q,ee=void 0!==L?L:W.loading||!(Y||"combobox"===Q),te=(0,s.useContext)(m.aM),ne=te.status,ae=te.hasFeedback,ie=te.isFormItemInput,oe=te.feedbackIcon,re=(0,g.F)(ne,H);o=void 0!==R?R:"combobox"===Q?null:(D||d.Z)("Select");var ce=(0,v.Z)((0,i.Z)((0,i.Z)({},W),{multiple:Y,hasFeedback:ae,feedbackIcon:oe,showArrow:ee,prefixCls:$})),le=ce.suffixIcon,se=ce.itemIcon,ue=ce.removeIcon,de=ce.clearIcon,pe=(0,l.Z)(W,["suffixIcon","itemIcon"]),fe=r()(k||w,(0,a.Z)({},"".concat($,"-dropdown-").concat(q),"rtl"===q)),me=J||N||X,he=s.useContext(p.Z),ge=null!=M?M:he,ve=r()((n={},(0,a.Z)(n,"".concat($,"-lg"),"large"===me),(0,a.Z)(n,"".concat($,"-sm"),"small"===me),(0,a.Z)(n,"".concat($,"-rtl"),"rtl"===q),(0,a.Z)(n,"".concat($,"-borderless"),!S),(0,a.Z)(n,"".concat($,"-in-form-item"),ie),n),(0,g.Z)($,re,ae),K,j);return s.createElement(c.ZP,(0,i.Z)({ref:t,virtual:V,dropdownMatchSelectWidth:B},pe,{transitionName:(0,h.mL)(U,(0,h.q0)(E),W.transitionName),listHeight:O,listItemHeight:_,mode:Q,prefixCls:$,placement:void 0!==E?E:"rtl"===q?"bottomRight":"bottomLeft",direction:q,inputIcon:le,menuItemSelectedIcon:se,removeIcon:ue,clearIcon:de,notFoundContent:o,className:ve,getPopupContainer:P||A,dropdownClassName:fe,showArrow:ae||L,disabled:ge}))},C=s.forwardRef(b);C.SECRET_COMBOBOX_MODE_DO_NOT_USE=y,C.Option=c.Wx,C.OptGroup=c.Xo,t.Z=C}}]);
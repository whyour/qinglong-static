(self.webpackChunk=self.webpackChunk||[]).push([[3330],{28393:function(Y,B,a){"use strict";a.r(B);var $=a(25359),D=a.n($),q=a(57213),y=a.n(q),z=a(49811),ee=a.n(z),ne=a(54306),u=a.n(ne),n=a(88265),g=a(63313),te=a.n(g),G=a(28756),r=a(67393),ae=a(9835),h=a(22159),le=a(55484),re=a(84163),Z=a(84468),H=a(16861),l=a(95176),b=a(5558),_=a(11186),v=a.n(_),P=a(46207),T=a.n(P),e=a(11527),j=G.Z.Option,I=/([^\/\:]+\/[^\/]+)(?=\.git)/,L=/([^\/\:]+\/[^\/\.]+)\.[a-z]+$/,W=function(O){var d=O.subscription,M=O.handleCancel,S=O.visible,x=r.Z.useForm(),U=u()(x,1),i=U[0],oe=(0,g.useState)(!1),N=u()(oe,2),se=N[0],V=N[1],ie=(0,g.useState)("public-repo"),f=u()(ie,2),E=f[0],A=f[1],pe=(0,g.useState)("crontab"),he=u()(pe,2),de=he[0],ve=he[1],Ze=(0,g.useState)("ssh-key"),_e=u()(Ze,2),fe=_e[0],me=_e[1],Ce=function(){var c=ee()(D()().mark(function t(o){var s,p,C,R,K;return D()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return V(!0),s=d?"put":"post",p=y()(y()({},o),{},{autoAddCron:!!o.autoAddCron,autoDelCron:!!o.autoDelCron}),d&&(p.id=d.id),m.prev=4,m.next=7,l.W[s]("".concat(b.Z.apiPrefix,"subscriptions"),p);case 7:C=m.sent,R=C.code,K=C.data,R===200&&(ae.ZP.success(d?n.ZP.get("\u66F4\u65B0\u8BA2\u9605\u6210\u529F"):n.ZP.get("\u521B\u5EFA\u8BA2\u9605\u6210\u529F")),M(K)),V(!1),m.next=17;break;case 14:m.prev=14,m.t0=m.catch(4),V(!1);case 17:case"end":return m.stop()}},t,null,[[4,14]])}));return function(o){return c.apply(this,arguments)}}(),xe=function(t){A(t.target.value);var o=i.getFieldValue("url"),s=i.getFieldValue("branch");i.setFieldsValue({alias:Q(o,s,t.target.value)}),o&&i.validateFields(["url"])},Ee=function(t){ve(t.target.value),i.setFieldsValue({schedule:""})},je=function(t){me(t.target.value)},ge=function(t){var o=i.getFieldValue("branch");i.setFieldsValue({alias:Q(t.target.value,o)})},Pe=function(t){var o=i.getFieldValue("url");i.setFieldsValue({alias:Q(o,t.target.value)})},Q=function(t,o){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:E,p="",C=s==="file"?L:I;return C.test(t)&&(p=t.match(C)[1].replaceAll("/","_").replaceAll(".","_")),o&&(p=p+"_"+o),p},Oe=function(t){var o=t.value,s=t.onChange,p=(0,g.useState)("days"),C=u()(p,2),R=C[0],K=C[1],X=(0,g.useState)(),m=u()(X,2),F=m[0],k=m[1],ce=function(w){K(w),F&&F>0&&(s==null||s({type:w,value:F}))},Te=function(w){k(w||1),w?s==null||s({type:R,value:w}):s==null||s(null)};return(0,g.useEffect)(function(){o&&(K(o.type),k(o.value))},[o]),(0,e.jsxs)(h.Z.Group,{compact:!0,children:[(0,e.jsx)(le.Z,{addonBefore:n.ZP.get("\u6BCF"),precision:0,min:1,value:F,style:{width:"calc(100% - 58px)"},onChange:Te}),(0,e.jsxs)(G.Z,{value:R,onChange:ce,children:[(0,e.jsx)(j,{value:"days",children:n.ZP.get("\u5929")}),(0,e.jsx)(j,{value:"hours",children:n.ZP.get("\u65F6")}),(0,e.jsx)(j,{value:"minutes",children:n.ZP.get("\u5206")}),(0,e.jsx)(j,{value:"seconds",children:n.ZP.get("\u79D2")})]})]})},De=function(t){var o=t.value,s=t.onChange,p=t.type;return p==="ssh-key"?(0,e.jsx)(r.Z.Item,{name:["pull_option","private_key"],label:n.ZP.get("\u79C1\u94A5"),rules:[{required:!0}],children:(0,e.jsx)(h.Z.TextArea,{rows:4,autoSize:{minRows:1,maxRows:6},placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u79C1\u94A5")})}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r.Z.Item,{name:["pull_option","username"],label:n.ZP.get("\u7528\u6237\u540D"),rules:[{required:!0}],children:(0,e.jsx)(h.Z,{placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u8BA4\u8BC1\u7528\u6237\u540D")})}),(0,e.jsx)(r.Z.Item,{name:["pull_option","password"],tooltip:n.ZP.get("Github\u5DF2\u4E0D\u652F\u6301\u5BC6\u7801\u8BA4\u8BC1\uFF0C\u8BF7\u4F7F\u7528Token\u65B9\u5F0F"),label:n.ZP.get("\u5BC6\u7801/Token"),rules:[{required:!0}],children:(0,e.jsx)(h.Z,{placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u5BC6\u7801\u6216\u8005Token")})})]})},ue=(0,g.useCallback)(function(c){var t=c.clipboardData.getData("text");if(t.startsWith("ql ")){var o=t.split(" ").map(function(ce){return ce.trim().replace(/\"/g,"").replace(/\'/,"")}),s=u()(o,8),p=s[1],C=s[2],R=s[3],K=s[4],X=s[5],m=s[6],F=s[7],k=p==="raw"?"file":C.startsWith("http")?"public-repo":"private-repo";i.setFieldsValue({type:k,url:C,whitelist:R,blacklist:K,dependences:X,branch:m,extensions:F,alias:Q(C,m,k)}),A(k)}},[]),ye=(0,g.useCallback)(function(c){var t=c.clipboardData.getData("text");t.startsWith("ql ")&&c.preventDefault(),ue(c)},[]),be=function(t){return y()(y()({},t),{},{autoAddCron:T()(t==null?void 0:t.autoAddCron)?!0:!!(t!=null&&t.autoAddCron),autoDelCron:T()(t==null?void 0:t.autoDelCron)?!0:!!(t!=null&&t.autoDelCron)})};return(0,g.useEffect)(function(){S?window.addEventListener("paste",ue):window.removeEventListener("paste",ue)},[S]),(0,g.useEffect)(function(){i.setFieldsValue(y()(y()({},d),be(d))||{}),A(d&&d.type||"public-repo"),ve(d&&d.schedule_type||"crontab"),me(d&&d.pull_type||"ssh-key"),d||i.resetFields()},[d,S]),(0,e.jsx)(re.Z,{title:d?n.ZP.get("\u7F16\u8F91\u8BA2\u9605"):n.ZP.get("\u521B\u5EFA\u8BA2\u9605"),open:S,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){i.validateFields().then(function(t){Ce(t)}).catch(function(t){console.log("Validate Failed:",t)})},onCancel:function(){return M()},confirmLoading:se,children:(0,e.jsxs)(r.Z,{form:i,name:"form_in_modal",layout:"vertical",children:[(0,e.jsx)(r.Z.Item,{name:"name",label:n.ZP.get("\u540D\u79F0"),rules:[{required:!0}],children:(0,e.jsx)(h.Z,{placeholder:n.ZP.get("\u652F\u6301\u62F7\u8D1D ql repo/raw \u547D\u4EE4\uFF0C\u7C98\u8D34\u5BFC\u5165"),onPaste:ye})}),(0,e.jsx)(r.Z.Item,{name:"type",label:n.ZP.get("\u7C7B\u578B"),rules:[{required:!0}],initialValue:"public-repo",children:(0,e.jsxs)(Z.ZP.Group,{onChange:xe,children:[(0,e.jsx)(Z.ZP,{value:"public-repo",children:n.ZP.get("\u516C\u5F00\u4ED3\u5E93")}),(0,e.jsx)(Z.ZP,{value:"private-repo",children:n.ZP.get("\u79C1\u6709\u4ED3\u5E93")}),(0,e.jsx)(Z.ZP,{value:"file",children:n.ZP.get("\u5355\u6587\u4EF6")})]})}),(0,e.jsx)(r.Z.Item,{name:"url",label:n.ZP.get("\u94FE\u63A5"),rules:[{required:!0},{pattern:E==="file"?L:I}],children:(0,e.jsx)(h.Z.TextArea,{rows:4,autoSize:!0,placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u8BA2\u9605\u94FE\u63A5"),onPaste:ge,onChange:ge})}),E!=="file"&&(0,e.jsx)(r.Z.Item,{name:"branch",label:n.ZP.get("\u5206\u652F"),children:(0,e.jsx)(h.Z,{placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u5206\u652F"),onPaste:Pe,onChange:Pe})}),(0,e.jsx)(r.Z.Item,{name:"alias",label:n.ZP.get("\u552F\u4E00\u503C"),rules:[{required:!0,message:""}],tooltip:n.ZP.get("\u552F\u4E00\u503C\u7528\u4E8E\u65E5\u5FD7\u76EE\u5F55\u548C\u79C1\u94A5\u522B\u540D"),children:(0,e.jsx)(h.Z,{placeholder:n.ZP.get("\u81EA\u52A8\u751F\u6210"),disabled:!0})}),E==="private-repo"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r.Z.Item,{name:"pull_type",label:n.ZP.get("\u62C9\u53D6\u65B9\u5F0F"),initialValue:"ssh-key",rules:[{required:!0}],children:(0,e.jsxs)(Z.ZP.Group,{onChange:je,children:[(0,e.jsx)(Z.ZP,{value:"ssh-key",children:n.ZP.get("\u79C1\u94A5")}),(0,e.jsx)(Z.ZP,{value:"user-pwd",children:n.ZP.get("\u7528\u6237\u540D\u5BC6\u7801/Token")})]})}),(0,e.jsx)(De,{type:fe})]}),(0,e.jsx)(r.Z.Item,{name:"schedule_type",label:n.ZP.get("\u5B9A\u65F6\u7C7B\u578B"),initialValue:"crontab",rules:[{required:!0}],children:(0,e.jsxs)(Z.ZP.Group,{onChange:Ee,children:[(0,e.jsx)(Z.ZP,{value:"crontab",children:"crontab"}),(0,e.jsx)(Z.ZP,{value:"interval",children:"interval"})]})}),(0,e.jsx)(r.Z.Item,{name:de==="crontab"?"schedule":"interval_schedule",label:n.ZP.get("\u5B9A\u65F6\u89C4\u5219"),rules:[{required:!0},{validator:function(t,o){return de==="interval"||!o||v().parseExpression(o).hasNext()?Promise.resolve():Promise.reject(n.ZP.get("Subscription\u8868\u8FBE\u5F0F\u683C\u5F0F\u6709\u8BEF"))}}],children:de==="interval"?(0,e.jsx)(Oe,{}):(0,e.jsx)(h.Z,{placeholder:n.ZP.get("\u79D2(\u53EF\u9009) \u5206 \u65F6 \u5929 \u6708 \u5468")})}),E!=="file"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(r.Z.Item,{name:"whitelist",label:n.ZP.get("\u767D\u540D\u5355"),tooltip:n.ZP.get("\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F"),children:(0,e.jsx)(h.Z.TextArea,{rows:4,autoSize:!0,placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u767D\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272")})}),(0,e.jsx)(r.Z.Item,{name:"blacklist",label:n.ZP.get("\u9ED1\u540D\u5355"),tooltip:n.ZP.get("\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F"),children:(0,e.jsx)(h.Z.TextArea,{rows:4,autoSize:!0,placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u811A\u672C\u7B5B\u9009\u9ED1\u540D\u5355\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272")})}),(0,e.jsx)(r.Z.Item,{name:"dependences",label:n.ZP.get("\u4F9D\u8D56\u6587\u4EF6"),tooltip:n.ZP.get("\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272\uFF0C\u652F\u6301\u6B63\u5219\u8868\u8FBE\u5F0F"),children:(0,e.jsx)(h.Z.TextArea,{rows:4,autoSize:!0,placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u811A\u672C\u4F9D\u8D56\u6587\u4EF6\u5173\u952E\u8BCD\uFF0C\u591A\u4E2A\u5173\u952E\u8BCD\u7AD6\u7EBF\u5206\u5272")})}),(0,e.jsx)(r.Z.Item,{name:"extensions",label:n.ZP.get("\u6587\u4EF6\u540E\u7F00"),tooltip:n.ZP.get("\u4ED3\u5E93\u9700\u8981\u62C9\u53D6\u7684\u6587\u4EF6\u540E\u7F00\uFF0C\u591A\u4E2A\u540E\u7F00\u7A7A\u683C\u5206\u9694\uFF0C\u9ED8\u8BA4\u4F7F\u7528\u914D\u7F6E\u6587\u4EF6\u4E2D\u7684RepoFileExtensions"),children:(0,e.jsx)(h.Z,{placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u6587\u4EF6\u540E\u7F00")})}),(0,e.jsx)(r.Z.Item,{name:"sub_before",label:n.ZP.get("\u6267\u884C\u524D"),tooltip:n.ZP.get("\u8FD0\u884C\u8BA2\u9605\u524D\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js"),children:(0,e.jsx)(h.Z.TextArea,{rows:4,autoSize:!0,placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u524D\u8981\u6267\u884C\u7684\u547D\u4EE4")})}),(0,e.jsx)(r.Z.Item,{name:"sub_after",label:n.ZP.get("\u6267\u884C\u540E"),tooltip:n.ZP.get("\u8FD0\u884C\u8BA2\u9605\u540E\u6267\u884C\u7684\u547D\u4EE4\uFF0C\u6BD4\u5982 cp/mv/python3 xxx.py/node xxx.js"),children:(0,e.jsx)(h.Z.TextArea,{rows:4,autoSize:!0,placeholder:n.ZP.get("\u8BF7\u8F93\u5165\u8FD0\u884C\u8BA2\u9605\u540E\u8981\u6267\u884C\u7684\u547D\u4EE4")})})]}),(0,e.jsx)(r.Z.Item,{name:"proxy",label:n.ZP.get("\u4EE3\u7406"),tooltip:n.ZP.get("\u516C\u5F00\u4ED3\u5E93\u652F\u6301HTTP/SOCK5\u4EE3\u7406\uFF0C\u79C1\u6709\u4ED3\u5E93\u652F\u6301SOCK5\u4EE3\u7406"),children:(0,e.jsx)(h.Z,{placeholder:E==="private-repo"?"SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 IP:PORT":"HTTP/SOCK5\u4EE3\u7406\uFF0C\u4F8B\u5982 http://127.0.0.1:1080"})}),(0,e.jsxs)(r.Z.Item,{style:{marginBottom:0},className:"inline-form-item",children:[(0,e.jsx)(r.Z.Item,{name:"autoAddCron",label:n.ZP.get("\u81EA\u52A8\u6DFB\u52A0\u4EFB\u52A1"),valuePropName:"checked",initialValue:!0,children:(0,e.jsx)(H.Z,{})}),(0,e.jsx)(r.Z.Item,{name:"autoDelCron",label:n.ZP.get("\u81EA\u52A8\u5220\u9664\u4EFB\u52A1"),valuePropName:"checked",initialValue:!0,children:(0,e.jsx)(H.Z,{})})]})]})})};B.default=W},16861:function(Y,B,a){"use strict";a.d(B,{Z:function(){return H}});var $=a(60795),D=a(87807),q=a(24090),y=a(84875),z=a.n(y),ee=a(17079),ne=a(16803),u=a(63313),n=a(26230),g=a(25641),te=u.forwardRef(function(l,b){var _,v=l.prefixCls,P=v===void 0?"rc-switch":v,T=l.className,e=l.checked,j=l.defaultChecked,I=l.disabled,L=l.loadingIcon,W=l.checkedChildren,J=l.unCheckedChildren,O=l.onClick,d=l.onChange,M=l.onKeyDown,S=(0,ne.Z)(l,["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"]),x=(0,n.Z)(!1,{value:e,defaultValue:j}),U=(0,ee.Z)(x,2),i=U[0],oe=U[1];function N(f,E){var A=i;return I||(A=f,oe(A),d==null||d(A,E)),A}function se(f){f.which===g.Z.LEFT?N(!1,f):f.which===g.Z.RIGHT&&N(!0,f),M==null||M(f)}function V(f){var E=N(!i,f);O==null||O(E,f)}var ie=z()(P,T,(_={},(0,D.Z)(_,"".concat(P,"-checked"),i),(0,D.Z)(_,"".concat(P,"-disabled"),I),_));return u.createElement("button",Object.assign({},S,{type:"button",role:"switch","aria-checked":i,disabled:I,className:ie,ref:b,onKeyDown:se,onClick:V}),L,u.createElement("span",{className:"".concat(P,"-inner")},i?W:J))});te.displayName="Switch";var G=te,r=a(82259),ae=a(7893),h=a(65189),le=a(1570),re=function(l,b){var _={};for(var v in l)Object.prototype.hasOwnProperty.call(l,v)&&b.indexOf(v)<0&&(_[v]=l[v]);if(l!=null&&typeof Object.getOwnPropertySymbols=="function")for(var P=0,v=Object.getOwnPropertySymbols(l);P<v.length;P++)b.indexOf(v[P])<0&&Object.prototype.propertyIsEnumerable.call(l,v[P])&&(_[v[P]]=l[v[P]]);return _},Z=u.forwardRef(function(l,b){var _,v=l.prefixCls,P=l.size,T=l.disabled,e=l.loading,j=l.className,I=j===void 0?"":j,L=re(l,["prefixCls","size","disabled","loading","className"]),W=u.useContext(r.E_),J=W.getPrefixCls,O=W.direction,d=u.useContext(h.Z),M=u.useContext(ae.Z),S=(T!=null?T:M)||e,x=J("switch",v),U=u.createElement("div",{className:"".concat(x,"-handle")},e&&u.createElement(q.Z,{className:"".concat(x,"-loading-icon")})),i=z()((_={},(0,D.Z)(_,"".concat(x,"-small"),(P||d)==="small"),(0,D.Z)(_,"".concat(x,"-loading"),e),(0,D.Z)(_,"".concat(x,"-rtl"),O==="rtl"),_),I);return u.createElement(le.Z,{insertExtraNode:!0},u.createElement(G,(0,$.Z)({},L,{prefixCls:x,className:i,disabled:S,ref:b,loadingIcon:U})))});Z.__ANT_SWITCH=!0;var H=Z},46207:function(Y){function B(a){return a==null}Y.exports=B}}]);

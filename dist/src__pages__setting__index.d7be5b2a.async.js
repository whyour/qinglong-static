"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[2340],{47240:function(_e,y,e){e.r(y);var M=e(25359),p=e.n(M),u=e(57213),h=e.n(u),r=e(49811),g=e.n(r),i=e(54306),a=e.n(i),m=e(88265),A=e(63313),J=e.n(A),D=e(67393),B=e(9835),d=e(84163),Z=e(22159),j=e(28756),q=e(95176),S=e(5558),R=e(11527),K=function(_){var t=_.app,l=_.handleCancel,v=_.visible,G=D.Z.useForm(),f=a()(G,1),L=f[0],b=(0,A.useState)(!1),T=a()(b,2),F=T[0],N=T[1],Y=function(){var W=g()(p()().mark(function x(z){var o,s,O,H,Q;return p()().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return N(!0),o=t?"put":"post",s=h()({},z),t&&(s.id=t.id),C.prev=4,C.next=7,q.W[o]("".concat(S.Z.apiPrefix,"apps"),s);case 7:O=C.sent,H=O.code,Q=O.data,H===200&&(B.ZP.success(t?m.ZP.get("\u66F4\u65B0\u5E94\u7528\u6210\u529F"):m.ZP.get("\u521B\u5EFA\u5E94\u7528\u6210\u529F")),l(Q)),N(!1),C.next=17;break;case 14:C.prev=14,C.t0=C.catch(4),N(!1);case 17:case"end":return C.stop()}},x,null,[[4,14]])}));return function(z){return W.apply(this,arguments)}}();return(0,A.useEffect)(function(){L.resetFields()},[t,v]),(0,R.jsx)(d.Z,{title:t?m.ZP.get("\u7F16\u8F91\u5E94\u7528"):m.ZP.get("\u521B\u5EFA\u5E94\u7528"),open:v,forceRender:!0,centered:!0,maskClosable:!1,onOk:function(){L.validateFields().then(function(x){Y(x)}).catch(function(x){console.log("Validate Failed:",x)})},onCancel:function(){return l()},confirmLoading:F,children:(0,R.jsxs)(D.Z,{form:L,layout:"vertical",name:"form_app_modal",initialValues:t,children:[(0,R.jsx)(D.Z.Item,{name:"name",label:m.ZP.get("\u540D\u79F0"),rules:[{validator:function(x,z){return["system"].includes(z)?Promise.reject(new Error(m.ZP.get("\u540D\u79F0\u4E0D\u80FD\u4E3A\u4FDD\u7559\u5173\u952E\u5B57"))):Promise.resolve()}}],children:(0,R.jsx)(Z.Z,{placeholder:m.ZP.get("\u8BF7\u8F93\u5165\u5E94\u7528\u540D\u79F0")})}),(0,R.jsx)(D.Z.Item,{name:"scopes",label:m.ZP.get("\u6743\u9650"),rules:[{required:!0}],children:(0,R.jsx)(j.Z,{mode:"multiple",placeholder:m.ZP.get("\u8BF7\u9009\u62E9\u6A21\u5757\u6743\u9650"),allowClear:!0,style:{width:"100%"},children:S.Z.scopes.map(function(W){return(0,R.jsx)(j.Z.Option,{value:W.value,children:W.name},W.value)})})})]})})};y.default=K},77207:function(_e,y,e){e.r(y),e.d(y,{default:function(){return Q}});var M=e(57213),p=e.n(M),u=e(93525),h=e.n(u),r=e(54306),g=e.n(r),i=e(88265),a=e(63313),m=e(92260),A=e(51704),J=e(2947),D=e(15367),B=e(84163),d=e(9835),Z=e(24378),j=e(86986),q=e(94674),S=e(5558),R=e(78969),K=e(95176),E=e(47240),_=e(32132),t=e(14797),l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M909.1 209.3l-56.4 44.1C775.8 155.1 656.2 92 521.9 92 290 92 102.3 279.5 102 511.5 101.7 743.7 289.8 932 521.9 932c181.3 0 335.8-115 394.6-276.1 1.5-4.2-.7-8.9-4.9-10.3l-56.7-19.5a8 8 0 00-10.1 4.8c-1.8 5-3.8 10-5.9 14.9-17.3 41-42.1 77.8-73.7 109.4A344.77 344.77 0 01655.9 829c-42.3 17.9-87.4 27-133.8 27-46.5 0-91.5-9.1-133.8-27A341.5 341.5 0 01279 755.2a342.16 342.16 0 01-73.7-109.4c-17.9-42.4-27-87.4-27-133.9s9.1-91.5 27-133.9c17.3-41 42.1-77.8 73.7-109.4 31.6-31.6 68.4-56.4 109.3-73.8 42.3-17.9 87.4-27 133.8-27 46.5 0 91.5 9.1 133.8 27a341.5 341.5 0 01109.3 73.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.6 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c-.1-6.6-7.8-10.3-13-6.2z"}}]},name:"reload",theme:"outlined"},v=l,G=e(46420),f=function(C,ae){return a.createElement(G.Z,(0,t.Z)((0,t.Z)({},C),{},{ref:ae,icon:v}))};f.displayName="ReloadOutlined";var L=a.forwardRef(f),b=e(13740),T=e(17322),F=e(23980),N=e(15257),Y=e(14761),W=e(9532),x=e(98074),z=e(56508),o=e(11527),s=m.Z.Text,O=window.__ENV__DeployEnv==="demo",H=function(){var C=(0,x.useOutletContext)(),ae=C.headerStyle,X=C.isPhone,k=C.user,ce=C.reloadUser,oe=C.reloadTheme,ue=C.socketMessage,te=C.systemInfo,fe=[{title:i.ZP.get("\u540D\u79F0"),dataIndex:"name",key:"name"},{title:"Client ID",dataIndex:"client_id",key:"client_id",render:function(c,I){return(0,o.jsx)(s,{copyable:!0,children:I.client_id})}},{title:"Client Secret",dataIndex:"client_secret",key:"client_secret",render:function(c,I){return(0,o.jsx)(s,{copyable:{text:I.client_secret},children:"*******"})}},{title:i.ZP.get("\u6743\u9650"),dataIndex:"scopes",key:"scopes",width:"40%",render:function(c,I){return I.scopes.map(function(U){return(0,o.jsx)(A.Z,{children:S.Z.scopesMap[U]},U)})}},{title:i.ZP.get("\u64CD\u4F5C"),key:"action",render:function(c,I,U){var ne=!X;return(0,o.jsxs)(J.Z,{size:"middle",style:{paddingLeft:8},children:[(0,o.jsx)(D.Z,{title:ne?i.ZP.get("\u7F16\u8F91"):"",children:(0,o.jsx)("a",{onClick:function(){return be(I,U)},children:(0,o.jsx)(_.Z,{})})}),(0,o.jsx)(D.Z,{title:ne?i.ZP.get("\u91CD\u7F6Esecret"):"",children:(0,o.jsx)("a",{onClick:function(){return Ne(I,U)},children:(0,o.jsx)(L,{})})}),(0,o.jsx)(D.Z,{title:ne?i.ZP.get("\u5220\u9664"):"",children:(0,o.jsx)("a",{onClick:function(){return Fe(I,U)},children:(0,o.jsx)(b.Z,{})})})]})}}],le=(0,a.useState)(!0),ge=g()(le,2),re=ge[0],se=ge[1],ie=(0,a.useState)([]),Pe=g()(ie,2),de=Pe[0],me=Pe[1],Ee=(0,a.useState)(!1),$=g()(Ee,2),n=$[0],P=$[1],V=(0,a.useState)(),ve=g()(V,2),je=ve[0],Oe=ve[1],Te=(0,a.useState)("security"),Ce=g()(Te,2),Ie=Ce[0],Ae=Ce[1],Re=(0,a.useState)([]),Me=g()(Re,2),Le=Me[0],We=Me[1],Be=(0,a.useState)(),pe=g()(Be,2),Se=pe[0],Ue=pe[1],De=function(){se(!0),K.W.get("".concat(S.Z.apiPrefix,"apps")).then(function(c){var I=c.code,U=c.data;I===200&&me(U)}).finally(function(){return se(!1)})},Ke=function(){Oe(null),P(!0)},be=function(c,I){Oe(c),P(!0)},Fe=function(c,I){B.Z.confirm({title:i.ZP.get("\u786E\u8BA4\u5220\u9664"),content:(0,o.jsxs)(o.Fragment,{children:[i.ZP.get("\u786E\u8BA4\u5220\u9664\u5E94\u7528")," ",(0,o.jsx)(s,{style:{wordBreak:"break-all"},type:"warning",children:c.name})," ",i.ZP.get("\u5417")]}),onOk:function(){K.W.delete("".concat(S.Z.apiPrefix,"apps"),{data:[c.id]}).then(function(ne){var he=ne.code,xe=ne.data;if(he===200){d.ZP.success(i.ZP.get("\u5220\u9664\u6210\u529F"));var ye=h()(de);ye.splice(I,1),me(ye)}})},onCancel:function(){console.log("Cancel")}})},Ne=function(c,I){B.Z.confirm({title:i.ZP.get("\u786E\u8BA4\u91CD\u7F6E"),content:(0,o.jsxs)(o.Fragment,{children:[i.ZP.get("\u786E\u8BA4\u91CD\u7F6E\u5E94\u7528")," ",(0,o.jsx)(s,{style:{wordBreak:"break-all"},type:"warning",children:c.name})," ",i.ZP.get("\u7684Secret\u5417"),(0,o.jsx)("br",{}),(0,o.jsx)(s,{type:"secondary",children:i.ZP.get("\u91CD\u7F6ESecret\u4F1A\u8BA9\u5F53\u524D\u5E94\u7528\u6240\u6709token\u5931\u6548")})]}),onOk:function(){K.W.put("".concat(S.Z.apiPrefix,"apps/").concat(c.id,"/reset-secret")).then(function(ne){var he=ne.code,xe=ne.data;he===200&&(d.ZP.success(i.ZP.get("\u91CD\u7F6E\u6210\u529F")),Ze(xe))})},onCancel:function(){console.log("Cancel")}})},ze=function(c){P(!1),c&&Ze(c)},Ze=function(c){var I=de.findIndex(function(ne){return ne.id===c.id}),U=h()(de);I===-1?U.push(c):U.splice(I,1,p()({},c)),me(U)},$e=function(){K.W.get("".concat(S.Z.apiPrefix,"user/login-log")).then(function(c){var I=c.code,U=c.data;I===200&&We(U)}).catch(function(c){console.log(c)})},Ve=function(c){Ae(c),c==="app"?De():c==="login"?$e():c==="notification"&&Ge()},Ge=function(){K.W.get("".concat(S.Z.apiPrefix,"user/notification")).then(function(c){var I=c.code,U=c.data;I===200&&Ue(U)}).catch(function(c){console.log(c)})};return(0,a.useEffect)(function(){O&&De()},[]),(0,o.jsxs)(R.ZP,{className:"ql-container-wrapper ql-container-wrapper-has-tab ql-setting-container",title:i.ZP.get("\u7CFB\u7EDF\u8BBE\u7F6E"),header:{style:ae},extra:Ie==="app"?[(0,o.jsx)(Z.Z,{type:"primary",onClick:function(){return Ke()},children:i.ZP.get("\u521B\u5EFA\u5E94\u7528")},"2")]:[],children:[(0,o.jsx)(j.Z,{defaultActiveKey:"security",size:"small",tabPosition:"top",onChange:Ve,items:[].concat(h()(O?[]:[{key:"security",label:i.ZP.get("\u5B89\u5168\u8BBE\u7F6E"),children:(0,o.jsx)(T.default,{user:k,userChange:ce})}]),[{key:"app",label:i.ZP.get("\u5E94\u7528\u8BBE\u7F6E"),children:(0,o.jsx)(q.Z,{columns:fe,pagination:!1,dataSource:de,rowKey:"id",size:"middle",scroll:{x:768},loading:re})},{key:"notification",label:i.ZP.get("\u901A\u77E5\u8BBE\u7F6E"),children:(0,o.jsx)(N.default,{data:Se})},{key:"login",label:i.ZP.get("\u767B\u5F55\u65E5\u5FD7"),children:(0,o.jsx)(F.default,{data:Le})},{key:"other",label:i.ZP.get("\u5176\u4ED6\u8BBE\u7F6E"),children:(0,o.jsx)(Y.default,{reloadTheme:oe,socketMessage:ue,systemInfo:te})},{key:"about",label:i.ZP.get("\u5173\u4E8E"),children:(0,o.jsx)(W.default,{systemInfo:te})}])}),(0,o.jsx)(E.default,{visible:n,handleCancel:ze,app:je})]})},Q=H},23980:function(_e,y,e){e.r(y);var M=e(88265),p=e(63313),u=e.n(p),h=e(92260),r=e(51704),g=e(94674),i=e(11527),a=h.Z.Text,m=h.Z.Link,A=function(d){return d[d.\u6210\u529F=0]="\u6210\u529F",d[d.\u5931\u8D25=1]="\u5931\u8D25",d}(A||{}),J=function(d){return d[d.success=0]="success",d[d.error=1]="error",d}(J||{}),D=[{title:M.ZP.get("\u5E8F\u53F7"),width:40,render:function(Z,j,q){return q+1}},{title:M.ZP.get("\u767B\u5F55\u65F6\u95F4"),dataIndex:"timestamp",key:"timestamp",width:120,render:function(Z,j){return new Date(j.timestamp).toLocaleString()}},{title:M.ZP.get("\u767B\u5F55\u5730\u5740"),dataIndex:"address",width:120,key:"address"},{title:M.ZP.get("\u767B\u5F55IP"),dataIndex:"ip",width:100,key:"ip"},{title:M.ZP.get("\u767B\u5F55\u8BBE\u5907"),dataIndex:"platform",key:"platform",width:80},{title:M.ZP.get("\u767B\u5F55\u72B6\u6001"),dataIndex:"status",key:"status",width:80,render:function(Z,j){return(0,i.jsx)(r.Z,{color:J[j.status],style:{marginRight:0},children:M.ZP.get(A[j.status])})}}],B=function(Z){var j=Z.data;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(g.Z,{columns:D,pagination:!1,dataSource:j,rowKey:"id",size:"middle",scroll:{x:768},sticky:!0})})};y.default=B},15257:function(_e,y,e){e.r(y);var M=e(57213),p=e.n(M),u=e(54306),h=e.n(u),r=e(88265),g=e(63313),i=e.n(g),a=e(28756),m=e(67393),A=e(9835),J=e(22159),D=e(24378),B=e(95176),d=e(5558),Z=e(11527),j=a.Z.Option,q=function(R){var K=R.data,E=(0,g.useState)(!1),_=h()(E,2),t=_[0],l=_[1],v=(0,g.useState)("closed"),G=h()(v,2),f=G[0],L=G[1],b=(0,g.useState)([]),T=h()(b,2),F=T[0],N=T[1],Y=m.Z.useForm(),W=h()(Y,1),x=W[0],z=function(O){l(!0);var H=O.type;H=="closed"&&(O.type=""),B.W.put("".concat(d.Z.apiPrefix,"user/notification"),O).then(function(Q){var ee=Q.code,C=Q.data;ee===200&&A.ZP.success(O.type?r.ZP.get("\u901A\u77E5\u53D1\u9001\u6210\u529F"):r.ZP.get("\u901A\u77E5\u5173\u95ED\u6210\u529F"))}).catch(function(Q){console.log(Q)}).finally(function(){return l(!1)})},o=function(O){L(O);var H=d.Z.notificationModeMap[O];N(H||[])};return(0,g.useEffect)(function(){K&&K.type&&(o(K.type),x.setFieldsValue(p()({},K)))},[K]),(0,Z.jsx)("div",{children:(0,Z.jsxs)(m.Z,{onFinish:z,form:x,layout:"vertical",children:[(0,Z.jsx)(m.Z.Item,{label:r.ZP.get("\u901A\u77E5\u65B9\u5F0F"),name:"type",rules:[{required:!0}],style:{maxWidth:400},initialValue:f,children:(0,Z.jsx)(a.Z,{onChange:o,disabled:t,children:d.Z.notificationModes.map(function(s){return(0,Z.jsx)(j,{value:s.value,children:s.label},s.value)})})}),F.map(function(s){return(0,Z.jsx)(m.Z.Item,{label:s.label,name:s.label,extra:s.tip,rules:[{required:s.required}],style:{maxWidth:400},children:s.items?(0,Z.jsx)(a.Z,{placeholder:s.placeholder||"\u8BF7\u9009\u62E9".concat(s.label),disabled:t,children:s.items.map(function(O){return(0,Z.jsx)(j,{value:O.value,children:O.label||O.value},O.value)})}):(0,Z.jsx)(J.Z.TextArea,{disabled:t,autoSize:!0,placeholder:s.placeholder||"\u8BF7\u8F93\u5165".concat(s.label)})},s.label)}),(0,Z.jsx)(D.Z,{type:"primary",htmlType:"submit",disabled:t,children:t?r.ZP.get("\u6D4B\u8BD5\u4E2D..."):r.ZP.get("\u4FDD\u5B58")})]})})};y.default=q},14761:function(_e,y,e){e.r(y);var M=e(57213),p=e.n(M),u=e(54306),h=e.n(u),r=e(88265),g=e(63313),i=e.n(g),a=e(67393),m=e(9835),A=e(84163),J=e(84468),D=e(22159),B=e(55484),d=e(24378),Z=e(57679),j=e(71571),q=e.n(j),S=e(5558),R=e(95176),K=e(60819),E=e(11227),_=e.n(E),t=e(56508),l=e(59953),v=e(41422),G=e(54700),f=e(11527),L=[{label:r.ZP.get("\u4EAE\u8272"),value:"light"},{label:r.ZP.get("\u6697\u8272"),value:"dark"},{label:r.ZP.get("\u8DDF\u968F\u7CFB\u7EDF"),value:"auto"}],b=function(F){var N=F.systemInfo,Y=F.socketMessage,W=F.reloadTheme,x=localStorage.getItem("qinglong_dark_theme")||"auto",z=(0,g.useState)(),o=h()(z,2),s=o[0],O=o[1],H=a.Z.useForm(),Q=h()(H,1),ee=Q[0],C=(0,g.useRef)(),ae=(0,g.useState)(!1),X=h()(ae,2),k=X[0],ce=X[1],oe=(0,G.default)(r.ZP.get("\u4E0A\u4F20")),ue=(0,G.default)(r.ZP.get("\u4E0B\u8F7D")),te=j||{},fe=te.enable,le=te.disable,ge=te.exportGeneratedCSS,re=te.setFetchMethod,se=te.auto,ie=function(n){var P=n.target.value;localStorage.setItem("qinglong_dark_theme",n.target.value),re(fetch),P==="dark"?fe({}):P==="light"?le():se({}),W()},Pe=function(){R.W.get("".concat(S.Z.apiPrefix,"system/config")).then(function(n){var P=n.code,V=n.data;P===200&&V.info&&O(V.info)}).catch(function(n){console.log(n)})},de=function(){R.W.put("".concat(S.Z.apiPrefix,"system/config"),s).then(function(n){var P=n.code,V=n.data;P===200&&m.ZP.success(r.ZP.get("\u66F4\u65B0\u6210\u529F"))}).catch(function(n){console.log(n)})},me=function(){ce(!0),R.W.put("".concat(S.Z.apiPrefix,"system/data/export"),{},{responseType:"blob",timeout:864e5,onDownloadProgress:function(P){P.progress&&ue(parseFloat((P.progress*100).toFixed(1)))}}).then(function(n){(0,E.saveAs)(n,"data.tgz")}).catch(function(n){console.log(n)}).finally(function(){return ce(!1)})},Ee=function(){A.Z.confirm({width:600,maskClosable:!1,title:r.ZP.get("\u786E\u8BA4\u91CD\u542F"),centered:!0,content:r.ZP.get("\u5907\u4EFD\u6570\u636E\u4E0A\u4F20\u6210\u529F\uFF0C\u786E\u8BA4\u8986\u76D6\u6570\u636E"),okText:r.ZP.get("\u91CD\u542F"),onOk:function(){R.W.put("".concat(S.Z.apiPrefix,"system/reload"),{type:"data"}).then(function(){m.ZP.success({content:(0,f.jsxs)("span",{children:[r.ZP.get("\u7CFB\u7EDF\u5C06\u5728"),(0,f.jsx)(v.Z,{className:"inline-countdown",format:"ss",value:Date.now()+1e3*30}),r.ZP.get("\u79D2\u540E\u81EA\u52A8\u5237\u65B0")]}),duration:30}),setTimeout(function(){window.location.reload()},3e4)}).catch(function(P){console.log(P)})}})};return(0,g.useEffect)(function(){Pe()},[]),(0,f.jsxs)(a.Z,{layout:"vertical",form:ee,children:[(0,f.jsx)(a.Z.Item,{label:r.ZP.get("\u4E3B\u9898"),name:"theme",initialValue:x,children:(0,f.jsx)(J.ZP.Group,{options:L,onChange:ie,value:x,optionType:"button",buttonStyle:"solid"})}),(0,f.jsx)(a.Z.Item,{label:r.ZP.get("\u65E5\u5FD7\u5220\u9664\u9891\u7387"),name:"frequency",tooltip:r.ZP.get("\u6BCFx\u5929\u81EA\u52A8\u5220\u9664x\u5929\u4EE5\u524D\u7684\u65E5\u5FD7"),children:(0,f.jsxs)(D.Z.Group,{compact:!0,children:[(0,f.jsx)(B.Z,{addonBefore:r.ZP.get("\u6BCF"),addonAfter:r.ZP.get("\u5929"),style:{width:180},min:0,value:s==null?void 0:s.logRemoveFrequency,onChange:function(n){O(p()(p()({},s),{},{logRemoveFrequency:n}))}}),(0,f.jsx)(d.Z,{type:"primary",onClick:de,children:r.ZP.get("\u786E\u8BA4")})]})}),(0,f.jsx)(a.Z.Item,{label:r.ZP.get("\u5B9A\u65F6\u4EFB\u52A1\u5E76\u53D1\u6570"),name:"frequency",children:(0,f.jsxs)(D.Z.Group,{compact:!0,children:[(0,f.jsx)(B.Z,{style:{width:150},min:1,value:s==null?void 0:s.cronConcurrency,onChange:function(n){O(p()(p()({},s),{},{cronConcurrency:n}))}}),(0,f.jsx)(d.Z,{type:"primary",onClick:de,children:r.ZP.get("\u786E\u8BA4")})]})}),(0,f.jsxs)(a.Z.Item,{label:r.ZP.get("\u6570\u636E\u5907\u4EFD\u8FD8\u539F"),name:"frequency",children:[(0,f.jsx)(d.Z,{type:"primary",onClick:me,loading:k,children:k?r.ZP.get("\u751F\u6210\u6570\u636E\u4E2D..."):r.ZP.get("\u5907\u4EFD")}),(0,f.jsx)(Z.Z,{method:"put",showUploadList:!1,maxCount:1,action:"/api/system/data/import",onChange:function(n){var P;if((P=n.event)!==null&&P!==void 0&&P.percent){var V,ve;oe(parseFloat((V=n.event)===null||V===void 0?void 0:V.percent.toFixed(1))),((ve=n.event)===null||ve===void 0?void 0:ve.percent)===100&&Ee()}},name:"data",headers:{Authorization:"Bearer ".concat(localStorage.getItem(S.Z.authKey))},children:(0,f.jsx)(d.Z,{icon:(0,f.jsx)(l.Z,{}),style:{marginLeft:8},children:r.ZP.get("\u8FD8\u539F\u6570\u636E")})})]}),(0,f.jsx)(a.Z.Item,{label:r.ZP.get("\u68C0\u67E5\u66F4\u65B0"),name:"update",children:(0,f.jsx)(K.default,{systemInfo:N,socketMessage:Y})})]})};y.default=b},54700:function(_e,y,e){e.r(y),e.d(y,{default:function(){return g}});var M=e(13800),p=e(84163),u=e(63313),h=e.n(u),r=e(11527);function g(i){var a=(0,u.useRef)(),m=function(D){var B=D.percent;return(0,r.jsx)(M.Z,{style:{display:"flex",justifyContent:"center"},type:"circle",percent:B})},A=function(D){a.current?a.current.update({title:"".concat(i).concat(D>=100?"\u6210\u529F":"\u4E2D..."),content:(0,r.jsx)(m,{percent:D})}):a.current=p.Z.info({width:600,maskClosable:!1,title:"".concat(i).concat(D>=100?"\u6210\u529F":"\u4E2D..."),centered:!0,content:(0,r.jsx)(m,{percent:D})})};return A}},17322:function(_e,y,e){e.r(y);var M=e(54306),p=e.n(M),u=e(88265),h=e(63313),r=e.n(h),g=e(92260),i=e(9835),a=e(22159),m=e(24378),A=e(67393),J=e(83535),D=e(57679),B=e(95176),d=e(5558),Z=e(98074),j=e(48039),q=e.n(j),S=e(91796),R=e(3513),K=e(59953),E=e(24244),_=e(3057),t=e(11527),l=g.Z.Title,v=g.Z.Link,G=function(L){var b=L.user,T=L.userChange,F=(0,h.useState)(!1),N=p()(F,2),Y=N[0],W=N[1],x=(0,h.useState)(),z=p()(x,2),o=z[0],s=z[1],O=(0,h.useState)(!1),H=p()(O,2),Q=H[0],ee=H[1],C=(0,h.useState)(),ae=p()(C,2),X=ae[0],k=ae[1],ce=(0,h.useState)(),oe=p()(ce,2),ue=oe[0],te=oe[1],fe=(0,h.useState)(),le=p()(fe,2),ge=le[0],re=le[1],se=function(n){B.W.put("".concat(d.Z.apiPrefix,"user"),{username:n.username,password:n.password}).then(function(P){var V=P.code,ve=P.data;V===200&&(localStorage.removeItem(d.Z.authKey),Z.history.push("/login"))}).catch(function(P){console.log(P)})},ie=function(){o?Pe():(me(),ee(!0))},Pe=function(){B.W.put("".concat(d.Z.apiPrefix,"user/two-factor/deactive")).then(function(n){var P=n.code,V=n.data;P===200&&V&&(s(!1),T())}).catch(function(n){console.log(n)})},de=function(){W(!0),B.W.put("".concat(d.Z.apiPrefix,"user/two-factor/active"),{code:ue}).then(function(n){var P=n.code,V=n.data;P===200&&(V?(i.ZP.success(u.ZP.get("\u6FC0\u6D3B\u6210\u529F")),ee(!1),s(!0),T()):i.ZP.success(u.ZP.get("\u9A8C\u8BC1\u5931\u8D25")))}).catch(function(n){console.log(n)}).finally(function(){return W(!1)})},me=function(){B.W.get("".concat(d.Z.apiPrefix,"user/two-factor/init")).then(function(n){var P=n.code,V=n.data;P===200&&k(V)}).catch(function(n){console.log(n)})},Ee=function(n){n.file&&n.file.response&&(re("/api/static/".concat(n.file.response.data)),T())};return(0,h.useEffect)(function(){s(b&&b.twoFactorActivated),re(b.avatar&&"/api/static/".concat(b.avatar))},[b]),Q?(0,t.jsx)(t.Fragment,{children:X?(0,t.jsxs)("div",{children:[(0,t.jsx)(l,{level:5,children:u.ZP.get("\u7B2C\u4E00\u6B65")}),u.ZP.get("\u4E0B\u8F7D\u4E24\u6B65\u9A8C\u8BC1\u624B\u673A\u5E94\u7528\uFF0C\u6BD4\u5982 Google Authenticator \u3001"),(0,t.jsx)(v,{href:"https://www.microsoft.com/en-us/security/mobile-authenticator-app",target:"_blank",children:"Microsoft Authenticator"}),"\u3001",(0,t.jsx)(v,{href:"https://authy.com/download/",target:"_blank",children:"Authy"}),"\u3001",(0,t.jsx)(v,{href:"https://support.1password.com/one-time-passwords/",target:"_blank",children:"1Password"}),"\u3001",(0,t.jsx)(v,{href:"https://support.logmeininc.com/lastpass/help/lastpass-authenticator-lp030014",target:"_blank",children:"LastPass Authenticator"}),(0,t.jsx)(l,{style:{marginTop:5},level:5,children:u.ZP.get("\u7B2C\u4E8C\u6B65")}),u.ZP.get("\u4F7F\u7528\u624B\u673A\u5E94\u7528\u626B\u63CF\u4E8C\u7EF4\u7801\uFF0C\u6216\u8005\u8F93\u5165\u79D8\u94A5")," ",X==null?void 0:X.secret,(0,t.jsx)("div",{style:{marginTop:10},children:(0,t.jsx)(q(),{style:{border:"1px solid #21262d",borderRadius:6},includeMargin:!0,size:187,value:X==null?void 0:X.url})}),(0,t.jsx)(l,{style:{marginTop:5},level:5,children:u.ZP.get("\u7B2C\u4E09\u6B65")}),u.ZP.get("\u8F93\u5165\u624B\u673A\u5E94\u7528\u4E0A\u76846\u4F4D\u6570\u5B57"),(0,t.jsx)(a.Z,{style:{margin:"10px 0 10px 0",display:"block",maxWidth:200},value:ue,onChange:function(n){return te(n.target.value)},placeholder:"123456"}),(0,t.jsx)(m.Z,{type:"primary",loading:Y,onClick:de,children:u.ZP.get("\u5B8C\u6210\u8BBE\u7F6E")})]}):(0,t.jsx)(S.Z,{})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{fontSize:18,borderBottom:"1px solid #f0f0f0",marginBottom:8,paddingBottom:4},children:u.ZP.get("\u4FEE\u6539\u7528\u6237\u540D\u5BC6\u7801")}),(0,t.jsxs)(A.Z,{onFinish:se,layout:"vertical",children:[(0,t.jsx)(A.Z.Item,{label:u.ZP.get("\u7528\u6237\u540D"),name:"username",rules:[{required:!0}],hasFeedback:!0,style:{maxWidth:300},children:(0,t.jsx)(a.Z,{placeholder:u.ZP.get("\u7528\u6237\u540D")})}),(0,t.jsx)(A.Z.Item,{label:u.ZP.get("\u5BC6\u7801"),name:"password",rules:[{required:!0},{pattern:/^(?!admin$).*$/,message:u.ZP.get("\u5BC6\u7801\u4E0D\u80FD\u4E3Aadmin")}],hasFeedback:!0,style:{maxWidth:300},children:(0,t.jsx)(a.Z,{type:"password",placeholder:u.ZP.get("\u5BC6\u7801")})}),(0,t.jsx)(m.Z,{type:"primary",htmlType:"submit",children:u.ZP.get("\u4FDD\u5B58")})]}),(0,t.jsx)("div",{style:{fontSize:18,borderBottom:"1px solid #f0f0f0",marginBottom:8,paddingBottom:4,marginTop:16},children:u.ZP.get("\u4E24\u6B65\u9A8C\u8BC1")}),(0,t.jsx)(m.Z,{type:"primary",danger:o,onClick:ie,children:o?u.ZP.get("\u7981\u7528"):u.ZP.get("\u542F\u7528")}),(0,t.jsx)("div",{style:{fontSize:18,borderBottom:"1px solid #f0f0f0",marginBottom:8,paddingBottom:4,marginTop:16},children:u.ZP.get("\u5934\u50CF")}),(0,t.jsx)(J.C,{size:128,shape:"square",icon:(0,t.jsx)(R.Z,{}),src:ge}),(0,t.jsx)(E.Z,{rotationSlider:!0,children:(0,t.jsx)(D.Z,{method:"put",showUploadList:!1,maxCount:1,action:"/api/user/avatar",onChange:Ee,name:"avatar",headers:{Authorization:"Bearer ".concat(localStorage.getItem(d.Z.authKey))},children:(0,t.jsx)(m.Z,{icon:(0,t.jsx)(K.Z,{}),style:{marginLeft:8},children:u.ZP.get("\u66F4\u6362\u5934\u50CF")})})})]})};y.default=G},56508:function(){},51704:function(_e,y,e){e.d(y,{Z:function(){return K}});var M=e(87807),p=e(60795),u=e(17079),h=e(5132),r=e(84875),g=e.n(r),i=e(92976),a=e(63313),m=e(82259),A=e(31124),J=e(1570),D=function(E,_){var t={};for(var l in E)Object.prototype.hasOwnProperty.call(E,l)&&_.indexOf(l)<0&&(t[l]=E[l]);if(E!=null&&typeof Object.getOwnPropertySymbols=="function")for(var v=0,l=Object.getOwnPropertySymbols(E);v<l.length;v++)_.indexOf(l[v])<0&&Object.prototype.propertyIsEnumerable.call(E,l[v])&&(t[l[v]]=E[l[v]]);return t},B=function(_){var t,l=_.prefixCls,v=_.className,G=_.checked,f=_.onChange,L=_.onClick,b=D(_,["prefixCls","className","checked","onChange","onClick"]),T=a.useContext(m.E_),F=T.getPrefixCls,N=function(z){f==null||f(!G),L==null||L(z)},Y=F("tag",l),W=g()(Y,(t={},(0,M.Z)(t,"".concat(Y,"-checkable"),!0),(0,M.Z)(t,"".concat(Y,"-checkable-checked"),G),t),v);return a.createElement("span",(0,p.Z)({},b,{className:W,onClick:N}))},d=B,Z=function(E,_){var t={};for(var l in E)Object.prototype.hasOwnProperty.call(E,l)&&_.indexOf(l)<0&&(t[l]=E[l]);if(E!=null&&typeof Object.getOwnPropertySymbols=="function")for(var v=0,l=Object.getOwnPropertySymbols(E);v<l.length;v++)_.indexOf(l[v])<0&&Object.prototype.propertyIsEnumerable.call(E,l[v])&&(t[l[v]]=E[l[v]]);return t},j=new RegExp("^(".concat(A.Y.join("|"),")(-inverse)?$")),q=new RegExp("^(".concat(A.E.join("|"),")$")),S=function(_,t){var l,v=_.prefixCls,G=_.className,f=_.style,L=_.children,b=_.icon,T=_.color,F=_.onClose,N=_.closeIcon,Y=_.closable,W=Y===void 0?!1:Y,x=Z(_,["prefixCls","className","style","children","icon","color","onClose","closeIcon","closable"]),z=a.useContext(m.E_),o=z.getPrefixCls,s=z.direction,O=a.useState(!0),H=(0,u.Z)(O,2),Q=H[0],ee=H[1];a.useEffect(function(){"visible"in x&&ee(x.visible)},[x.visible]);var C=function(){return T?j.test(T)||q.test(T):!1},ae=(0,p.Z)({backgroundColor:T&&!C()?T:void 0},f),X=C(),k=o("tag",v),ce=g()(k,(l={},(0,M.Z)(l,"".concat(k,"-").concat(T),X),(0,M.Z)(l,"".concat(k,"-has-color"),T&&!X),(0,M.Z)(l,"".concat(k,"-hidden"),!Q),(0,M.Z)(l,"".concat(k,"-rtl"),s==="rtl"),l),G),oe=function(ie){ie.stopPropagation(),F==null||F(ie),!ie.defaultPrevented&&("visible"in x||ee(!1))},ue=function(){return W?N?a.createElement("span",{className:"".concat(k,"-close-icon"),onClick:oe},N):a.createElement(h.Z,{className:"".concat(k,"-close-icon"),onClick:oe}):null},te="onClick"in x||L&&L.type==="a",fe=(0,i.Z)(x,["visible"]),le=b||null,ge=le?a.createElement(a.Fragment,null,le,a.createElement("span",null,L)):L,re=a.createElement("span",(0,p.Z)({},fe,{ref:t,className:ce,style:ae}),ge,ue());return te?a.createElement(J.Z,null,re):re},R=a.forwardRef(S);R.CheckableTag=d;var K=R}}]);

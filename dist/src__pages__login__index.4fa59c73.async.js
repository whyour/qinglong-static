(self.webpackChunk=self.webpackChunk||[]).push([[9939,3830],{71449:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var a=n(57213),o=n.n(a),s=n(54306),r=n.n(s),i=n(88265),c=n(63313),d=n(67393),l=n(89065),u=n(43848),h=n(22159),m=n(24378),f=n(59873),p=n(5558),g=n(98074),v="container___ldtvs",Z="top___D7yFW",x="header___j_Z_f",y="logo___Cf9cM",_="title___zhtS2",j="main___sAFzH",w="extra___e62Gt",b=n(95176),P=n(62753),k=n(14797),S={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M744 62H280c-35.3 0-64 28.7-64 64v768c0 35.3 28.7 64 64 64h464c35.3 0 64-28.7 64-64V126c0-35.3-28.7-64-64-64zm-8 824H288V134h448v752zM472 784a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"mobile",theme:"outlined"},E=n(46420),F=function(e,t){return c.createElement(E.Z,(0,k.Z)((0,k.Z)({},e),{},{ref:t,icon:S}))};F.displayName="MobileOutlined";var C=c.forwardRef(F),N=n(11527),I=d.Z.Item,L=l.Z.Countdown,M="demo"===window.__ENV__DeployEnv,z=function(){var e=(0,g.useOutletContext)().reloadUser,t=(0,c.useState)(!1),n=r()(t,2),a=n[0],s=n[1],l=(0,c.useState)(),k=r()(l,2),S=k[0],E=k[1],F=(0,P.F)().theme,z=(0,c.useState)(!1),D=r()(z,2),T=D[0],A=D[1],H=(0,c.useState)(!1),W=r()(H,2),q=W[0],V=W[1],B=(0,c.useState)(),G=r()(B,2),K=G[0],O=G[1],R=function(e){V(!0),b.W.put("".concat(p.Z.apiPrefix,"user/two-factor/login"),o()(o()({},K),{},{code:e.code})).then((function(e){$(e),V(!1)})).catch((function(e){console.log(e),V(!1)}))},$=function(t,n){var a=t.code,o=t.data;t.message;if(200===a){var s=o.token,r=o.lastip,c=o.lastaddr,d=o.lastlogon,l=o.retries,h=void 0===l?0:l,m=o.platform;localStorage.setItem(p.Z.authKey,s),u.Z.success({message:i.ZP.get("登录成功！"),description:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{children:[i.ZP.get("上次登录时间："),d?new Date(d).toLocaleString():"-"]}),(0,N.jsxs)("div",{children:[i.ZP.get("上次登录地点："),c||"-"]}),(0,N.jsxs)("div",{children:[i.ZP.get("上次登录IP："),r||"-"]}),(0,N.jsxs)("div",{children:[i.ZP.get("上次登录设备："),m||"-"]}),(0,N.jsxs)("div",{children:[i.ZP.get("上次登录状态："),h>0?"失败".concat(h,"次"):i.ZP.get("成功")]})]})}),e(!0),g.history.push("/crontab")}else 410===a?E(o):420===a?(O({username:n.username,password:n.password}),A(!0)):100===a&&setTimeout((function(){location.reload()}),1e3)};return(0,c.useEffect)((function(){localStorage.getItem(p.Z.authKey)&&g.history.push("/crontab")}),[]),(0,N.jsxs)("div",{className:v,children:[(0,N.jsx)("div",{className:Z,children:(0,N.jsxs)("div",{className:x,children:[(0,N.jsx)("img",{alt:"logo",className:y,src:"https://qn.whyour.cn/logo.png"}),(0,N.jsx)("span",{className:_,children:T?i.ZP.get("两步验证"):p.Z.siteName})]})}),(0,N.jsx)("div",{className:j,children:T?(0,N.jsxs)(d.Z,{layout:"vertical",onFinish:R,children:[(0,N.jsx)(I,{name:"code",label:i.ZP.get("验证码"),rules:[{pattern:/^[0-9]{6}$/,message:i.ZP.get("验证码为6位数字")}],validateTrigger:"onBlur",children:(0,N.jsx)(h.Z,{placeholder:i.ZP.get("6位数字"),onChange:function(e){var t=e.target.value;/^[0-9]{6}$/.test(t)&&R({code:t})},autoFocus:!0,autoComplete:"off"})}),(0,N.jsx)(m.Z,{type:"primary",htmlType:"submit",style:{width:"100%"},loading:q,children:i.ZP.get("验证")})]}):(0,N.jsxs)(d.Z,{layout:"vertical",onFinish:function(e){s(!0),A(!1),E(null),b.W.post("".concat(p.Z.apiPrefix,"user/login"),{username:e.username,password:e.password}).then((function(t){$(t,e),s(!1)})).catch((function(e){console.log(e),s(!1)}))},children:[(0,N.jsx)(I,{name:"username",label:i.ZP.get("用户名"),hasFeedback:!0,children:(0,N.jsx)(h.Z,{placeholder:"".concat(i.ZP.get("用户名")).concat(M?": admin":""),autoFocus:!0})}),(0,N.jsx)(I,{name:"password",label:i.ZP.get("密码"),hasFeedback:!0,children:(0,N.jsx)(h.Z,{type:"password",placeholder:"".concat(i.ZP.get("密码")).concat(M?": 123":"")})}),(0,N.jsx)(f.Z,{children:S?(0,N.jsxs)(m.Z,{type:"primary",style:{width:"100%"},disabled:!0,children:[i.ZP.get("请"),(0,N.jsx)(L,{valueStyle:{color:"vs"===F?"rgba(0,0,0,.25)":"rgba(232, 230, 227, 0.25)"},className:"inline-countdown",onFinish:function(){return E(null)},format:"ss",value:Date.now()+1e3*S}),i.ZP.get("秒后重试")]}):(0,N.jsx)(m.Z,{type:"primary",htmlType:"submit",style:{width:"100%"},loading:a,children:i.ZP.get("登录")})})]})}),(0,N.jsx)("div",{className:w,children:T?(0,N.jsxs)("div",{style:{paddingLeft:20,position:"relative"},children:[(0,N.jsx)(C,{style:{position:"absolute",left:0,top:4}}),i.ZP.get("在您的设备上打开两步验证应用程序以查看您的身份验证代码并验证您的身份。")]}):""})]})}},62753:function(e,t,n){"use strict";n.d(t,{F:function(){return c},e:function(){return i}});var a=n(54306),o=n.n(a),s=n(63313),r=n(82428),i=function(){var e=(0,s.useState)("100%"),t=o()(e,2),n=t[0],a=t[1],i=(0,s.useState)(0),c=o()(i,2),d=c[0],l=c[1],u=(0,s.useState)(-48),h=o()(u,2),m=h[0],f=h[1],p=(0,s.useState)(!1),g=o()(p,2),v=g[0],Z=g[1],x=(0,s.useMemo)((function(){return(0,r.ZP)()}),[]).platform;return(0,s.useEffect)((function(){"mobile"===x&&document.body.offsetWidth<768?(a("auto"),l(0),f(0),Z(!0),document.body.setAttribute("data-mode","phone")):(a("100%"),l(0),f(-48),Z(!1),document.body.setAttribute("data-mode","desktop"))}),[]),{headerStyle:{padding:"4px 16px 4px 15px",position:"sticky",top:0,left:0,zIndex:20,marginTop:m,width:n,marginLeft:d},isPhone:v}},c=function(){var e=(0,s.useState)(),t=o()(e,2),n=t[0],a=t[1];return(0,s.useEffect)((function(){var e=window.matchMedia("(prefers-color-scheme: dark)"),t=localStorage.getItem("qinglong_dark_theme"),n=e.matches&&"light"!==t||"dark"===t;a(n?"vs-dark":"vs");var o=function(e){"auto"!==t&&t||(e.matches?a("vs-dark"):a("vs"))};"function"==typeof e.addEventListener?e.addEventListener("change",o):"function"==typeof e.addListener&&e.addListener(o)}),[]),{theme:n,reloadTheme:function(){var e=window.matchMedia("(prefers-color-scheme: dark)"),t=localStorage.getItem("qinglong_dark_theme"),n=e.matches&&"light"!==t||"dark"===t;a(n?"vs-dark":"vs")}}}},92235:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(17079),o=n(63313);function s(){var e=o.useReducer((function(e){return e+1}),0);return(0,a.Z)(e,2)[1]}},68098:function(e,t,n){"use strict";n.d(t,{fk:function(){return r},jD:function(){return s}});var a,o=n(65021),s=function(){return(0,o.Z)()&&window.document.documentElement},r=function(){if(!s())return!1;if(void 0!==a)return a;var e=document.createElement("div");return e.style.display="flex",e.style.flexDirection="column",e.style.rowGap="1px",e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div")),document.body.appendChild(e),a=1===e.scrollHeight,document.body.removeChild(e),a}},59873:function(e,t,n){"use strict";var a=n(19698);t.Z=a.Z},24669:function(e){var t=Array.isArray;e.exports=t}}]);
"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9996],{30419:function(ge,C,e){var F=e(82878),j=(0,F.Z)({scriptUrl:["//at.alicdn.com/t/c/font_3354854_ob5y15ewlyq.js"]});C.Z=j},72144:function(ge,C,e){e.r(C);var F=e(44463),j=e.n(F),X=e(35290),p=e.n(X),q=e(30279),s=e.n(q),ee=e(411),ne=e.n(ee),D=e(46686),$=e.n(D),T=e(63313),he=e.n(T),d=e(71976),g=e(61839),te=e(4352),z=e(30314),_e=e(59225),x=e(65646),S=e(74083),ae=e(27382),G=e(28786),Y=e(3567),re=e(30419),le=e(65439),H=e.n(le),n=e(11527),i=["key","name"],oe=["key","name"],J=[{name:"\u547D\u4EE4",value:"command"},{name:"\u540D\u79F0",value:"name"},{name:"\u5B9A\u65F6\u89C4\u5219",value:"schedule"},{name:"\u72B6\u6001",value:"status"},{name:"\u6807\u7B7E",value:"labels"}],W={Reg:"",NotReg:"",In:"select",Nin:"select"},ie=[{name:"\u5305\u542B",value:"Reg"},{name:"\u4E0D\u5305\u542B",value:"NotReg"},{name:"\u5C5E\u4E8E",value:"In",type:"select"},{name:"\u4E0D\u5C5E\u4E8E",value:"Nin",type:"select"}],se=[{name:"\u987A\u5E8F",value:"ASC"},{name:"\u5012\u5E8F",value:"DESC"}],de={status:[{name:"\u8FD0\u884C\u4E2D",value:0},{name:"\u7A7A\u95F2\u4E2D",value:1},{name:"\u5DF2\u7981\u7528",value:2}]},m;(function(R){R.and="\u4E14",R.or="\u6216"})(m||(m={}));var P=function(B){var c=B.view,L=B.handleCancel,y=B.visible,U=d.Z.useForm(),h=$()(U,1),E=h[0],w=(0,T.useState)(!1),A=$()(w,2),V=A[0],M=A[1],N=(0,T.useState)("and"),I=$()(N,2),f=I[0],O=I[1],k=function(){var a=ne()(p()().mark(function t(_){var r,u,o,v;return p()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return M(!0),_.filterRelation=f,r=c?"put":"post",l.prev=3,l.next=6,S.W[r]("".concat(ae.Z.apiPrefix,"crons/views"),{data:c?s()(s()({},_),{},{id:c.id}):_});case 6:u=l.sent,o=u.code,v=u.data,o===200&&L(v),M(!1),l.next=16;break;case 13:l.prev=13,l.t0=l.catch(3),M(!1);case 16:case"end":return l.stop()}},t,null,[[3,13]])}));return function(_){return a.apply(this,arguments)}}();(0,T.useEffect)(function(){c||E.resetFields(),E.setFieldsValue(c||{filters:[{property:"command",operation:"Reg"}]})},[c,y]);var K=(0,n.jsx)(g.Z,{style:{width:80},children:ie.map(function(a){return(0,n.jsx)(g.Z.Option,{value:a.value,children:a.name},a.name)})}),Q=function(t){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(0,n.jsx)(g.Z,{style:_,children:t.map(function(r){return(0,n.jsx)(g.Z.Option,{value:r.value,children:r.name},r.name)})})},ue=(0,n.jsx)(g.Z,{children:se.map(function(a){return(0,n.jsx)(g.Z.Option,{value:a.value,children:a.name},a.name)})}),me=function(t){var _;return(0,n.jsx)(g.Z,{mode:"tags",allowClear:!0,placeholder:"\u8F93\u5165\u540E\u56DE\u8F66\u589E\u52A0\u81EA\u5B9A\u4E49\u9009\u9879",children:(_=de[t])===null||_===void 0?void 0:_.map(function(r){return(0,n.jsx)(g.Z.Option,{value:r.value,children:r.name},r.name)})})};return(0,n.jsx)(te.Z,{title:c?"\u7F16\u8F91\u89C6\u56FE":"\u65B0\u5EFA\u89C6\u56FE",open:y,forceRender:!0,width:580,centered:!0,maskClosable:!1,onOk:function(){E.validateFields().then(function(t){k(t)}).catch(function(t){console.log("Validate Failed:",t)})},onCancel:function(){return L()},confirmLoading:V,children:(0,n.jsxs)(d.Z,{form:E,layout:"vertical",name:"env_modal",children:[(0,n.jsx)(d.Z.Item,{name:"name",label:"\u89C6\u56FE\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"}],children:(0,n.jsx)(z.Z,{placeholder:"\u8BF7\u8F93\u5165\u89C6\u56FE\u540D\u79F0"})}),(0,n.jsx)(d.Z.List,{name:"filters",children:function(t,_){var r=_.add,u=_.remove;return(0,n.jsxs)("div",{style:{position:"relative"},className:"view-filters-container ".concat(t.length>1?"active":""),children:[t.length>1&&(0,n.jsx)("div",{style:{position:"absolute",width:50,borderRadius:10,border:"1px solid rgb(190, 220, 255)",borderRight:"none",height:56*(t.length-1),top:46,left:15},children:(0,n.jsx)(_e.Z,{type:"primary",size:"small",style:{position:"absolute",top:"50%",translate:"-50% -50%",padding:"0 0 0 3px",cursor:"pointer"},onClick:function(){O(f==="and"?"or":"and")},children:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:m[f]}),(0,n.jsx)(re.Z,{type:"ql-icon-d-caret"})]})})}),(0,n.jsxs)("div",{children:[t.map(function(o,v){var b=o.key,l=o.name,Z=j()(o,i);return(0,n.jsx)(d.Z.Item,{label:v===0?"\u7B5B\u9009\u6761\u4EF6":"",style:{marginBottom:0},required:!0,className:"filter-item",children:(0,n.jsxs)(x.Z,{className:"view-create-modal-filters",align:"baseline",style:t.length>1?{width:"calc(100% - 40px)"}:{},children:[(0,n.jsx)(d.Z.Item,s()(s()({},Z),{},{name:[l,"property"],rules:[{required:!0}],children:Q(J,{width:90})})),(0,n.jsx)(d.Z.Item,s()(s()({},Z),{},{name:[l,"operation"],rules:[{required:!0}],children:K})),(0,n.jsx)(d.Z.Item,{noStyle:!0,shouldUpdate:function(Ee,ve){var De=W[H()(Ee,["filters",l,"operation"])],Oe=W[H()(ve,["filters",l,"operation"])],pe=De!==Oe;return pe&&E.setFieldValue(["filters",l,"value"],Oe==="select"?[]:""),pe},children:function(){var Ee=E.getFieldValue(["filters",v,"property"]),ve=E.getFieldValue(["filters",l,"operation"]);return(0,n.jsx)(d.Z.Item,s()(s()({},Z),{},{name:[l,"value"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5185\u5BB9"}],children:W[ve]==="select"?me(Ee):(0,n.jsx)(z.Z,{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9"})}))}}),v!==0&&(0,n.jsx)(G.Z,{onClick:function(){return u(l)}})]})},b)}),(0,n.jsx)(d.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return r({property:"command",operation:"Reg"})},children:[(0,n.jsx)(Y.Z,{}),"\u65B0\u589E\u7B5B\u9009\u6761\u4EF6"]})})]})]})}}),(0,n.jsx)(d.Z.List,{name:"sorts",children:function(t,_){var r=_.add,u=_.remove;return(0,n.jsxs)(n.Fragment,{children:[t.map(function(o,v){var b=o.key,l=o.name,Z=j()(o,oe);return(0,n.jsx)(d.Z.Item,{label:v===0?"\u6392\u5E8F\u65B9\u5F0F":"",style:{marginBottom:0},children:(0,n.jsxs)(x.Z,{className:"view-create-modal-sorts",align:"baseline",children:[(0,n.jsx)(d.Z.Item,s()(s()({},Z),{},{name:[l,"property"],rules:[{required:!0}],children:Q(J,{width:240})})),(0,n.jsx)(d.Z.Item,s()(s()({},Z),{},{name:[l,"type"],rules:[{required:!0}],children:ue})),(0,n.jsx)(G.Z,{onClick:function(){return u(l)}})]})},b)}),(0,n.jsx)(d.Z.Item,{children:(0,n.jsxs)("a",{onClick:function(){return r({property:"command",type:"ASC"})},children:[(0,n.jsx)(Y.Z,{}),"\u65B0\u589E\u6392\u5E8F\u65B9\u5F0F"]})})]})}})]})})};C.default=P},39996:function(ge,C,e){e.r(C);var F=e(94434),j=e.n(F),X=e(30279),p=e.n(X),q=e(46686),s=e.n(q),ee=e(44463),ne=e.n(ee),D=e(63313),$=e.n(D),T=e(87670),he=e(84442),d=e(65646),g=e(4352),te=e(63533),z=e(59225),_e=e(61685),x=e(74083),S=e(27382),ae=e(97947),G=e(5962),Y=e(83254),re=e(1032),le=e(68882),H=e(66255),n=e(72144),i=e(11527),oe=["index","moveRow","className","style"],J=T.Z.Text,W="DragableBodyRow",ie=function(m){var P=m.index,R=m.moveRow,B=m.className,c=m.style,L=ne()(m,oe),y=(0,D.useRef)(),U=(0,Y.L)({accept:W,collect:function(O){var k=O.getItem()||{},K=k.index;return K===P?{}:{isOver:O.isOver(),dropClassName:K<P?" drop-over-downward":" drop-over-upward"}},drop:function(O){R(O.index,P)}}),h=s()(U,2),E=h[0],w=E.isOver,A=E.dropClassName,V=h[1],M=(0,re.c)({type:W,item:{index:P},collect:function(O){return{isDragging:O.isDragging()}}}),N=s()(M,2),I=N[1];return V(I(y)),(0,i.jsx)("tr",p()({ref:y,className:"".concat(B).concat(w?A:""),style:p()({cursor:"move"},c)},L))},se=function(m){var P=m.cronViews,R=m.handleCancel,B=m.visible,c=m.cronViewChange,L=[{title:"\u540D\u79F0",dataIndex:"name",key:"name",align:"center",render:function(t){return(0,i.jsx)("div",{style:{textAlign:"left",paddingLeft:30},children:t})}},{title:"\u7C7B\u578B",dataIndex:"type",key:"type",align:"center",render:function(t){return t===1?"\u7CFB\u7EDF":"\u4E2A\u4EBA"}},{title:"\u663E\u793A",key:"isDisabled",dataIndex:"isDisabled",align:"center",width:100,render:function(t,_,r){return(0,i.jsx)(he.Z,{checked:!_.isDisabled,onChange:function(o){return Q(o,_,r)}})}},{title:"\u64CD\u4F5C",key:"action",width:100,align:"center",render:function(t,_,r){return _.type!==1?(0,i.jsxs)(d.Z,{size:"middle",children:[(0,i.jsx)("a",{onClick:function(){return k(_,r)},children:(0,i.jsx)(ae.Z,{})}),(0,i.jsx)("a",{onClick:function(){return K(_,r)},children:(0,i.jsx)(G.Z,{})})]}):"-"}}],y=(0,D.useState)([]),U=s()(y,2),h=U[0],E=U[1],w=(0,D.useState)(!1),A=s()(w,2),V=A[0],M=A[1],N=(0,D.useState)(null),I=s()(N,2),f=I[0],O=I[1],k=function(t,_){O(t),M(!0)},K=function(t,_){g.Z.confirm({title:"\u786E\u8BA4\u5220\u9664",content:(0,i.jsxs)(i.Fragment,{children:["\u786E\u8BA4\u5220\u9664\u89C6\u56FE"," ",(0,i.jsx)(J,{style:{wordBreak:"break-all"},type:"warning",children:t.name})," ","\u5417"]}),onOk:function(){x.W.delete("".concat(S.Z.apiPrefix,"crons/views"),{data:[t.id]}).then(function(u){var o=u.code,v=u.data;o===200&&(te.ZP.success("\u5220\u9664\u6210\u529F"),c())})},onCancel:function(){console.log("Cancel")}})},Q=function(t,_,r){console.log(t),x.W.put("".concat(S.Z.apiPrefix,"crons/views/").concat(t?"enable":"disable"),{data:[_.id]}).then(function(u){var o=u.code,v=u.data;if(o===200){var b=j()(h);b.splice(r,1,p()(p()({},h[r]),{},{isDisabled:!t})),E(b),c()}})},ue={body:{row:ie}},me=(0,D.useCallback)(function(a,t){if(a!==t){var _=h[a];x.W.put("".concat(S.Z.apiPrefix,"crons/views/move"),{data:{fromIndex:a,toIndex:t,id:_.id}}).then(function(r){var u=r.code,o=r.data;if(u===200){var v=j()(h);v.splice(a,1),v.splice(t,0,p()(p()({},_),o)),E(v),c()}})}},[h]);return(0,D.useEffect)(function(){E(P)},[P]),(0,i.jsxs)(g.Z,{title:"\u89C6\u56FE\u7BA1\u7406",open:B,centered:!0,width:620,onCancel:function(){return R()},className:"view-manage-modal",forceRender:!0,footer:!1,maskClosable:!1,children:[(0,i.jsx)(d.Z,{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:(0,i.jsx)(z.Z,{type:"primary",onClick:function(){O(null),M(!0)},children:"\u65B0\u5EFA\u89C6\u56FE"},"2")}),(0,i.jsx)(le.W,{backend:H.PD,children:(0,i.jsx)(_e.Z,{bordered:!0,columns:L,pagination:!1,dataSource:h,rowKey:"id",size:"middle",style:{marginBottom:20},components:ue,onRow:function(t,_){return{index:_,moveRow:me}}})}),(0,i.jsx)(n.default,{view:f,visible:V,handleCancel:function(t){M(!1),c(t)}})]})};C.default=se}}]);
